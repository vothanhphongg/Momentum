import{a as Un}from"./chunk-F2V2HLHK.js";import{a as vn}from"./chunk-5IXP4AVF.js";import{a as Mn}from"./chunk-RWQI7GDI.js";import{a as On}from"./chunk-PNUHZ2Q5.js";import{a as Dn}from"./chunk-NQ7TPJEF.js";import{a as En}from"./chunk-BTPOS4L6.js";import{i as kn,j as bn,k as Bn,l as Ln,m as Pn,n as Fn}from"./chunk-APDYOFZ2.js";import"./chunk-MFSCVDJN.js";import"./chunk-TQFMB6UY.js";import{a as Go,b as Ro}from"./chunk-7RP5AG3D.js";import{a as $t}from"./chunk-F6DRZBXE.js";import"./chunk-JAJGR5PD.js";import"./chunk-6LUJJ5L7.js";import"./chunk-CBKILZK2.js";import{a as Yo}from"./chunk-3RHBRLYM.js";import{a as wn,b as An,c as Sn}from"./chunk-4M3K2SWT.js";import{a as Nn}from"./chunk-HVMJHKTE.js";import"./chunk-GR4GFB4P.js";import{a as hn}from"./chunk-2W6CXXNZ.js";import{a as In}from"./chunk-RRTG4E4G.js";import"./chunk-BARA7AIG.js";import{d as Cn}from"./chunk-GPDETZNQ.js";import"./chunk-M2Q6VTQI.js";import{a as yn}from"./chunk-3YGJNBCZ.js";import{a as To}from"./chunk-U7LFLL6J.js";import{a as Wo,b as zo}from"./chunk-ZJVF5RSO.js";import{b as Qt,g as Oo,i as _n,j as fn,k as Do,m as Uo,p as dn,q as xn,r as Tn}from"./chunk-3CVTSTBR.js";import"./chunk-KQDMYE3F.js";import"./chunk-SQ2BNI3O.js";import"./chunk-PWLZXA4M.js";import"./chunk-RYRQK4MH.js";import{a as vo}from"./chunk-TOV4UWR3.js";import"./chunk-BDM6XPIF.js";import"./chunk-N7RVZ3T6.js";import"./chunk-PSDESO5W.js";import{a as G,b as xo,c as me,d as Z}from"./chunk-HOU3VS5H.js";import{a as fo}from"./chunk-SQDIO2NL.js";import"./chunk-TISF4HQJ.js";import{a as rt}from"./chunk-IP7VSGCS.js";import{a as gn,b as to}from"./chunk-XYDICNP3.js";import"./chunk-ALLM2Z34.js";import"./chunk-QXPTHK7Q.js";import{B as un,a as sn,c as an,e as ln,i as mn,l as z,o as pn}from"./chunk-2LCPVMSO.js";import"./chunk-Q57GWOMY.js";import"./chunk-7C3BTQYU.js";import"./chunk-3XTUMVWB.js";import"./chunk-MGYCOFIC.js";import{d as cn}from"./chunk-6THUPAMO.js";import"./chunk-FK5ARFJK.js";import"./chunk-6Y7SZIB7.js";import"./chunk-VVYJA72I.js";import"./chunk-OWWFH26C.js";import{d as kt,g as rn}from"./chunk-MNZIO3NP.js";import"./chunk-HEFTA5OH.js";import"./chunk-S7NLB5XS.js";import"./chunk-UUWJWUOY.js";import"./chunk-2DF43JKM.js";import{a as _o}from"./chunk-7CC6X6YX.js";import"./chunk-JAGKSBYF.js";import"./chunk-CR2CPF4X.js";import"./chunk-HKZGONPS.js";import"./chunk-IIAVVYHZ.js";import{c as Tt}from"./chunk-TSTKPLAO.js";import"./chunk-52XLG23J.js";import"./chunk-EEFD5KZC.js";import"./chunk-73ZHJYCP.js";import"./chunk-3NSLXJYR.js";import"./chunk-ENPNPH37.js";import"./chunk-5QJIR6ZJ.js";import"./chunk-H6SNSZIS.js";import"./chunk-YWECPG37.js";import"./chunk-AXJECT36.js";import"./chunk-5BIOTNBS.js";import"./chunk-R5SMHBLJ.js";import"./chunk-IY4RYRL6.js";import"./chunk-4OAEJJK5.js";import"./chunk-34VLVCKN.js";import"./chunk-J4ZKBKEJ.js";import"./chunk-TFJRUJHH.js";import"./chunk-7NMUCCUG.js";import"./chunk-YF3DWJDS.js";import"./chunk-RH4ISAHA.js";import"./chunk-ECQND2NK.js";import"./chunk-W3L3YTJO.js";import"./chunk-M5NI6HPE.js";import"./chunk-YQHUKBMA.js";import"./chunk-VM2NMLPX.js";import"./chunk-YP7CHBKG.js";import"./chunk-FNXLAYUB.js";import"./chunk-PQK3LXXN.js";import"./chunk-FTRHGHDS.js";import"./chunk-XT3EOPTE.js";import"./chunk-A6Z53EN6.js";import"./chunk-LL63GZNI.js";import"./chunk-M7CL2K7X.js";import"./chunk-W2CTJYFJ.js";import"./chunk-XUKVTAH5.js";import"./chunk-5OJTPISL.js";import"./chunk-7UPVX2FL.js";import"./chunk-BSFXZ46S.js";import"./chunk-ZMCTBWUY.js";import"./chunk-UMGTYP2Z.js";import"./chunk-DTLEDHZZ.js";import{a as Qe}from"./chunk-VEPPH2A2.js";import"./chunk-5F6JALEN.js";import"./chunk-HWGRDY67.js";import"./chunk-KQIRXTC7.js";import{b as on}from"./chunk-O3O4HNQA.js";import{b as ht}from"./chunk-LR7KSTP2.js";import"./chunk-QCP7SXMX.js";import"./chunk-W23ABSXX.js";import"./chunk-FOF22X4F.js";import{a as le}from"./chunk-P4EMG7RN.js";import"./chunk-BVDJNUOM.js";import"./chunk-7B5UI77E.js";import{f as tn}from"./chunk-R6X7EOIE.js";import{h as nt,i as ct}from"./chunk-MKEYCSLA.js";import"./chunk-4EFZXPDV.js";import"./chunk-4KODREVA.js";import"./chunk-6UWGBJGT.js";import"./chunk-G4AVWXHJ.js";import"./chunk-76CRIMII.js";import"./chunk-F7VSWGDW.js";import"./chunk-KLLSVAFY.js";import"./chunk-MBHGLWZJ.js";import"./chunk-QZO7W5WD.js";import{f as en}from"./chunk-AKE54ZCC.js";import"./chunk-27LUWCHG.js";import"./chunk-EHZWM44P.js";import"./chunk-K6STDTUY.js";import"./chunk-A57OTXBP.js";import"./chunk-YJQGXXOQ.js";import"./chunk-HTLOGWI7.js";import"./chunk-6SEP5B7P.js";import"./chunk-FHKOH5E6.js";import"./chunk-NTQ2YVDA.js";import"./chunk-KKG4PJ6O.js";import"./chunk-EPWGNYZZ.js";import"./chunk-7SRLIN7D.js";import"./chunk-AW5NL3JM.js";import"./chunk-RI2WZ5PA.js";import"./chunk-YIAOHVF5.js";import{a as nn}from"./chunk-KBS3PMLQ.js";import"./chunk-7GKX3YKG.js";import"./chunk-7HFBMBFB.js";import"./chunk-TJCPJQIM.js";import"./chunk-ZTAZ2272.js";import{l as po,m as uo}from"./chunk-IRMYAC6R.js";import"./chunk-Q76QXAWY.js";import"./chunk-THSNJ5WU.js";import"./chunk-MRB2XFLQ.js";import"./chunk-65AJJVJY.js";import"./chunk-PDC447BO.js";import"./chunk-JI6FOZGR.js";import"./chunk-JCM7SRK2.js";import{a as Zt}from"./chunk-PTD7UCOR.js";import"./chunk-Q4YTGP2G.js";import{b as at}from"./chunk-ETJEH7T4.js";import"./chunk-LLZAOPDB.js";import{a as Ht}from"./chunk-V3IFYKWM.js";import"./chunk-EWTTD4DL.js";import"./chunk-Y2TPPS4H.js";import"./chunk-ITY22AD4.js";import"./chunk-E2JYOUYE.js";import"./chunk-B3JSNQIV.js";import{a as Ve}from"./chunk-YALUYHLV.js";import{g as Ke,q as C}from"./chunk-I3CPAVOC.js";import{a as zr}from"./chunk-ARWSGU73.js";import"./chunk-CZ2ZBAZV.js";import{o as Et}from"./chunk-5QMHGZLF.js";import{A as Mo,C as Ge,D as Re,Z as Xe,ec as co,gb as qe,hb as He,z as se}from"./chunk-HPWCPLRR.js";import"./chunk-O6ZBO5JF.js";import"./chunk-TSTPZ3JM.js";import{a as Je}from"./chunk-D2LKUI4F.js";import{a as je}from"./chunk-ON6S2DB7.js";import{j as st,p as mo}from"./chunk-SZD6WTBQ.js";import"./chunk-ASR4HLU7.js";import"./chunk-ANIUN6US.js";import"./chunk-3DZ7WRLL.js";import{d as Be,f as Or}from"./chunk-DEOJU4Z3.js";import"./chunk-PLIIQKFY.js";import"./chunk-6BXYJZHH.js";import"./chunk-CCEMKRO6.js";import"./chunk-2HSCH6R3.js";import"./chunk-CWNIM6RS.js";import"./chunk-NNAD25BL.js";import{e as Ze,g as $e}from"./chunk-XV444F26.js";import{L as et,Z as Ye,aa as qt,f as L,g as We,la as Mt,m as ze}from"./chunk-N2BCRNDB.js";import"./chunk-RTFE54S3.js";import"./chunk-GCQ4H2BA.js";import"./chunk-JGEHAFTO.js";import"./chunk-UVFOW4HH.js";import{g as ae}from"./chunk-LNOPECCQ.js";import"./chunk-CB7FOZNP.js";import{c as u}from"./chunk-43VURGIT.js";import{Ea as Pe,I as ee,Na as Ur,Sc as Wr,bd as Jt,ha as vr,hc as Po,lc as Xt,ld as ve,mc as St,nd as Oe,od as De,pc as Fe,pd as Ue,rc as lo,rd as Fo,tc as Me,ya as Le,za as Dr}from"./chunk-TM67VPZU.js";import"./chunk-VW6OQNWT.js";import{G as Se,H as Ee,O as ie,P as ke,X as be,d as Kt,e as he,o as Rt,p as re,r as Ne,y as Ae}from"./chunk-PUSMMCUD.js";import{R as V,o as A,z as i}from"./chunk-UWJLNJLY.js";import"./chunk-VRY2ADKE.js";import"./chunk-VWEB6W6G.js";import"./chunk-5U7FO2PW.js";import"./chunk-PDUOSATP.js";import"./chunk-XDY6V34Y.js";import"./chunk-YJFNO57I.js";import"./chunk-DZ6CTC22.js";import{$ as we,W as Ie,c as ne,ea as D}from"./chunk-JT3LNHPY.js";import"./chunk-47UWF72W.js";import{b as O}from"./chunk-JWYCKY2V.js";import"./chunk-G2266BV2.js";import"./chunk-L4PAIYPH.js";import"./chunk-UT7LJPKF.js";import"./chunk-AFZ6A2B3.js";import"./chunk-VVPY7ZA7.js";import"./chunk-KUW5VATV.js";import"./chunk-BNAVWOJ2.js";import"./chunk-IG2Q5ALZ.js";import"./chunk-WOMUNWBT.js";import"./chunk-QNGB57GN.js";import"./chunk-NM2PDVBD.js";import"./chunk-F6PXOVYL.js";import"./chunk-324EPGNQ.js";import"./chunk-5GFHI4AK.js";import"./chunk-QYVQBXDG.js";import"./chunk-7D4PUIEN.js";import"./chunk-IWVM7XL6.js";import"./chunk-7QO4TZYQ.js";import"./chunk-FF4LY6PE.js";import"./chunk-76KCDJDG.js";import"./chunk-YDUDQP2P.js";import"./chunk-PGPFV4JQ.js";import"./chunk-MIBHDVGP.js";import"./chunk-7VFUX7IX.js";import"./chunk-XLF4LAH2.js";import"./chunk-ONKZ57T6.js";import"./chunk-ZC7Q7LCH.js";import{f as g,o as a,p as y,q as l}from"./chunk-6KXF36WM.js";a();l();var Dt=g(O());a();l();var Xo=g(O());V();a();l();var Wn=({unapproved:t})=>Xo.default.createElement(u.Container,null,Xo.default.createElement(Zt,{title:i("wallet_trade_maintitle_transaction_confirm"),backable:!1,closeable:!1}),Xo.default.createElement(En,{unapproved:t}));a();l();var N=g(O()),zn=g(co()),qo=g(Et());V();Or();mo();Fo();lo();var Yr=({unapproved:t})=>{let o=t?.localType,e=t?.method,r=Tt({localType:o})?.coinId;r===void 0&&(r=St(o));let s=kt(r),m=(0,zn.useDispatch)(),_=t.walletId,x=t.params.transaction.from,E=uo(_),T=t.params.transaction.amount||2,[,w]=vo({coinId:r,address:x,chainId:s?.chainId}),p=w?.transferReminder,c=w?.dummyOutput,[d,M]=(0,N.useState)({level:qt.STANDARD,satBytes:w?.normal}),P=d?.satBytes;(0,N.useEffect)(()=>{if(!P&&w?.normal&&M({level:qt.STANDARD,satBytes:w?.normal}),P&&d?.level!==qt.CUSTOM){let ot=w[Wo[d?.level]?.satBytes];M({...d,satBytes:ot})}},[w]);let[v,{toggle:Y}]=(0,qo.useBoolean)(!1),[k,{set:h}]=(0,qo.useBoolean)(!1),[B,{set:X}]=(0,qo.useBoolean)(!1),[q,ut]=(0,N.useState)(),[j,S]=Do({coinId:r,walletId:_,address:x,batchDummyNum:T,utxoType:Qt.SPLIT_UTXO}),[H,W,Bt]=fn({coinId:r,walletId:_,address:x,networkFee:q,utxoType:Qt.SPLIT_UTXO,batchDummyNum:T,coinAmount:A.mul(c,T)},{ready:!!c}),It=(0,N.useMemo)(()=>W.findIndex(({dummy:ot})=>ot!==!0),[W]),_t=(0,N.useMemo)(()=>It===-1?[]:W.slice(It),[It,W]),lt=(0,N.useMemo)(()=>It===-1?0:Math.max(T-It,0),[T,It]),Ut=A.gt(lt,0),eo=A.mul(c,lt),K=dn({coinId:r,fromAddr:x,satBytes:P}),mt=(0,N.useCallback)(async()=>{try{if(!P)return;h(!0);let ot=await K({inputs:_t,outputs:Array.from({length:lt}).map(()=>({address:x,amount:c}))});X(!1),ut(ot)}catch{X(!0)}finally{h(!1)}},[c,K,x,_t,lt,P,X,h]);(0,N.useEffect)(()=>{mt()},[mt]);let Lt=(0,N.useMemo)(()=>S===void 0||!q?!0:A.gt(S,q),[S,q]),no=po(_),[Nt,At]=(0,N.useState)(!1),Wt=(0,N.useCallback)(async()=>{await m(nt(t.id)),await m(ht()),await st(m),At(!1)},[m,t.id]),{addressCheckError:it,addressCheckLoading:zt}=$t({chainIndex:s?.chainId||Po,method:e,from:x,handleCancel:Wt}),ro=(0,N.useMemo)(()=>E?{type:Z.TIP_TYPE.COMMON_ERROR,message:i("wallet_extension_top_toast_dapp_comingsoon")}:B?{type:Z.TIP_TYPE.FEE_ERROR}:Lt?it?{type:Z.TIP_TYPE.COMMON_ERROR,message:it}:{type:Kt.TYPE.warn,message:p}:{coinId:r,type:Z.TIP_TYPE.FEE_BALANCE_INSUFFICIENT},[r,B,E,Lt,p,it]),io=un({coinId:r,walletId:_,coinAmount:0,fromAddr:x,toAddr:x,localType:s?.localType,networkFee:q,extJson:JSON.stringify({}),txSource:Jt.DAPP,txType:L.BTC_SPLIT_UTXO}),tt=Uo({coinId:r,txType:L.BTC_SPLIT_UTXO,address:x}),Yt=(0,N.useCallback)(async()=>{if(Ut)try{if(!await _o({walletId:_,callback:async()=>{await m(nt(t.id))}}))return;await tt(_t),At(!0);let{signed:Pt,utxos:ko}=await Be().splitUtxo({splitAmount:lt,inputs:Oo(_t),amount:c,feePerB:d.satBytes},x,_),bo=await sn(s?.localType,Pt);await io(Pt,{txHash:bo});let oe=W.filter(ho=>ho.dummy),Bo=[...Oo(oe),...ko.map(ho=>({...ho,rawTransaction:Pt}))];await m(ct(t.id,{utxos:Bo,txHash:bo}))}catch{}finally{At(!1)}else{let ot=W.slice(0,T);await m(ct(t.id,{utxos:Oo(ot)}))}},[T,m,c,W,x,Ut,_t,io,lt,d.satBytes,t.id,tt,_]),{loading:Gt,onClick:Io}=rt(Wt),{loading:Ao,onClick:So}=rt(Yt),Eo=(0,N.useMemo)(()=>{let ot={loading:Gt,actionType:z.ACTION_TYPE.CANCEL,btnText:i("wallet_dapp_connection_btn_reject"),onClick:Io},Pt={actionType:z.ACTION_TYPE.CONFIRM,disabled:j||k||H||B||Bt||!Number(q)||E||it,onClick:So,loading:Ao||zt};return Lt||(Pt={coinId:r,walletId:_,address:x,actionType:z.ACTION_TYPE.FILL_UP}),[ot,Pt]},[r,q,B,k,x,E,Lt,j,Io,So,Bt,H,_,Gt,Ao]);return N.default.createElement(u.Container,null,N.default.createElement(Zt,{backable:!1,closeable:!1,title:i("wallet_extension_send_title_send")}),N.default.createElement(G,null,N.default.createElement(xo,{title:i("wallet_extension_send_colored_send"),summaryList:[{coinId:r,coinAmount:eo}]})),N.default.createElement(G,null,N.default.createElement(to,{walletId:_,address:x,title:i("wallet_extension_network_address_title_walletused")},!!S&&N.default.createElement(Go,{coinBalance:S,tooltip:i("extension_defi_bot_popuptext_avail_amount"),coinId:r}))),N.default.createElement(G,{bordered:!1},N.default.createElement(fo,{coinId:r,loading:k,feeError:B,networkFee:q,onClick:Y})),N.default.createElement(Ht,{placeholder:!0,offsetBottom:0,borderTop:!0},N.default.createElement(Z,{coinId:r,...ro}),N.default.createElement(z,{buttonGroup:Eo})),N.default.createElement(zo,{coinId:r,visible:v,signInfo:w,value:d,estimatedFee:q,onChange:M,onToggleVisible:Y}),N.default.createElement(Ro,{visible:no&&Nt}))},Yn=Yr;a();l();var Gn=g(O());var Rn=({unapproved:t})=>{let o=t.params?.message,e=Un({unapproved:t});return Gn.default.createElement(Dn,{needCheckMpc:!0,message:o,unapproved:t,tipMessage:e})};a();l();var wt=g(O()),Xn=g(co()),qn=g(je()),Hn=g(Et());mo();Fo();Wr();lo();a();l();var oo={AMOUNT:1,CONFIRM:2};var ce=oo.AMOUNT;function Gr({unapproved:t}){let{from:o,type:e=L.BRC20_INSCRIBE,tick:n="",tid:r,amount:s,txSource:m=Jt.DAPP}=t?.params?.transaction||{},_=t?.localType||Me,[x,E]=(0,wt.useState)(ce),T=(0,Xn.useDispatch)(),w=(0,qn.useHistory)(),c=Tt({localType:_})?.netWorkId;c===void 0?c=Xt(_):c=+c;let d=(0,Hn.useCreation)(()=>e===L.BRC20_INSCRIBE?{chainId:c,coinType:Mo(c),symbol:n}:null,[e,r,n,c]),P=kt(void 0,{},d)?.coinId,v=(0,wt.useCallback)(async()=>{await T(nt(t.id)),await T(ht()),await st(T)},[T,t.id]),Y=$t({from:o,chainIndex:Xt(_),handleCancel:v,method:t?.method}),k=(0,wt.useCallback)(()=>{E(oo.CONFIRM),ce=oo.CONFIRM},[]),h=(0,wt.useCallback)(async({txIds:X,commitTx:q,revealTxs:ut})=>{await T(ct(t.id,{txIds:X,commitTx:q,revealTxs:ut})),await T(ht()),w.push(Ve)},[T,w,t.id]),B=(0,wt.useCallback)(()=>{E(oo.AMOUNT),ce=oo.AMOUNT},[]);return wt.default.createElement(Fn,{fromAddress:o,coinId:P},x===oo.AMOUNT?wt.default.createElement(Ln,{amount:s,walletId:t.walletId,onCancel:v,onConfirm:k,headerProps:{closeable:!1,backable:!1}}):wt.default.createElement(Pn,{addressCheckRet:Y,txSource:m,onCancel:v,onConfirm:h,walletId:t.walletId,headerProps:{onBack:B,closeable:!1,backable:!0}}))}var Zn=Gr;a();l();var f=g(O()),yr=g(co()),Cr=g(je());V();a();l();var pe=g(O()),Vn=g(Et());a();l();function $n(t=[]){if(!Array.isArray(t))throw new Error("assetChange should be an array");return t.map(o=>{let{direction:e,amount:n,usdAmount:r,symbol:s,logo:m}=o;return{operator:e===1?"+":"-",usdValue:r,rawValue:n,asset:{assetType:pn.NATIVE,amount:n,symbol:s,imageUrl:m}}})}var Rr=({address:t,hexStringList:o=[],chainIndex:e=0},n={})=>{let r=o?.toString(),s={ready:e!==void 0&&!!o?.length,refreshDeps:[t,r,e],...n},{loading:m,data:_,error:x}=(0,Vn.useRequest)(async()=>(await Xe({address:t,hexStringList:o,chainIndex:e})).data,s);return{loading:m,data:_,error:x}},Xr=t=>(0,pe.useMemo)(()=>!t||!t.length?[]:t.map(o=>{let{assetChange:e=[],assetInversion:n}=o;return{status:o.analysisStatus,gasFee:o?.gasFee||0,isShowFee:o?.isShowFee,exploreUrl:o?.exploreUrl,inputInfo:o?.inputInfo||[],outputInfo:o?.outputInfo||[],assetChange:$n(e),assetInversion:n||!1}}),[t]),qr=(t=[])=>(0,pe.useMemo)(()=>!t||!t.length?null:t.some(e=>e.status>0)?Mt.EXECUTE_ERROR:null,[t]);function jn(t={},o={}){let{loading:e,data:n,error:r}=Rr(t,o),{utxoAllInfos:s}=n||{},m=Xr(s),_=qr(m);return{loading:e,error:r||_,data:m}}a();l();var gt=g(O()),Zo=g(Et());V();a();l();var Q=g(O()),ue=g(Et());V();a();l();V();var Kn=t=>{typeof t!="string"&&(t=t.toString());let o=t?.length;return o<=9?36:o>=10&&o<12?32:o===12?30:o>=13&&o<=15?24:o>=16&&o<=18?20:o>=19&&o<=24?16:12},Jn=(t,o)=>t?!1:o===""?!0:!A.gte(`${o||0}`,0);a();l();var bt={AuthorizationToken:"_AuthorizationToken_g68hx_1",authorizationToken:"_AuthorizationToken_g68hx_1",title:"_title_g68hx_1",content:"_content_g68hx_4",unlimited_text:"_unlimited_text_g68hx_13",unlimitedText:"_unlimited_text_g68hx_13",balance:"_balance_g68hx_17",amount:"_amount_g68hx_22",checkAll:"_checkAll_g68hx_26",checkAll__text:"_checkAll__text_g68hx_30",checkAllText:"_checkAll__text_g68hx_30",footerActions:"_footerActions_g68hx_33"};a();l();var Hr=({chainId:t,address:o,walletId:e})=>{let n=kt(void 0,void 0,{chainId:t,address:o}),{coinId:r}=n||{};return yn(r,e)},Qn=Hr;var Zr=({txType:t,chainId:o,address:e,walletId:n,authAmount:r,onConfirm:s})=>{let m=Qn({chainId:o,address:e,walletId:n}),{symbol:_,decimals:x}=m||{},E=Cn(_,10),T=t===L.INCREASE_ALLOWANCE?"extension_approve_text_increase_approvals":"wallet_contract_interaction_approval_permission_authorized_amount",w=He(r),[p,c]=(0,Q.useState)(!1),[d,M]=(0,Q.useState)(w?"0":r),P=(0,Q.useMemo)(()=>Jn(p,d),[p,d]),v=(0,ue.useMemoizedFn)(async()=>{s?.(p?qe:d)}),Y=(0,ue.useMemoizedFn)(()=>{M(m?.coinAmount)}),k=A.thousandFormat(m?.coinAmount);return Q.default.createElement(u.FlexBox,{className:bt.AuthorizationToken,direction:u.DIRECTION.vertical,align:u.ALIGN.center},Q.default.createElement(C.Text,{strong:700,className:bt.title},i(T)),Q.default.createElement(u.Box,{className:bt.content},p?Q.default.createElement(C.Text,{strong:500,size:C.SIZE.xl,className:bt.unlimited_text},i("wallet_extension_transfer_title_unlimited_amount",{token:E})):Q.default.createElement(cn,{symbol:E,autoSize:Kn,placeholder:"0",decimals:x||0,value:d,onChange:M,style:{fontWeight:500,height:"48px"}}),!!Number(m?.coinAmount)&&Q.default.createElement(C.Text,{nowrap:!0,type:C.TYPE.secondary,size:C.SIZE.xs,onClick:Y,className:bt.balance},i("wallet_extension_transfer_dialog_text_balance_amount",{amount:Q.default.createElement(C.Text,{inherit:!0,component:"span",className:bt.amount,ellipsis:{tooltip:k}},k),token:E}))),Q.default.createElement(Ne,{className:bt.checkAll,checked:p,textClass:bt.checkAll__text,onChange:({target:{checked:h}})=>{c(h)}},i("wallet_extension_transfer_dialog_checkbox_set_to_unlimited")),Q.default.createElement(Ht.FooterActions,{affixStyle:{position:"none"},placeholder:!1,className:bt.footerActions},Q.default.createElement(D,{disabled:P,category:D.CATEGORY.fill,type:D.TYPE.primary,size:D.SIZE.lg,onClick:v},i("commonall_filter_btn_save"))))},tr=Zr;a();l();var Ho={edit_btn:"_edit_btn_rw6lw_1",editBtn:"_edit_btn_rw6lw_1",authorization_token_dialog:"_authorization_token_dialog_rw6lw_5",authorizationTokenDialog:"_authorization_token_dialog_rw6lw_5",authorization_token_dialog__content:"_authorization_token_dialog__content_rw6lw_5",authorizationTokenDialogContent:"_authorization_token_dialog__content_rw6lw_5"};var $r=t=>{let[o,{toggle:e}]=(0,Zo.useBoolean)(!1),{txType:n,loading:r,dappInfo:s,walletId:m,analyzeRet:_,approveToken:x,onAuthTokenAmountChange:E,showDappInfo:T=!0,noFold:w=!1}=t,{approveList:p,assetChange:c=[]}=_,d=p?.[0]||{},M=(0,Zo.useMemoizedFn)(P=>{e(),E?.(P)});return r?gt.default.createElement(Nn,null):ln(n)?gt.default.createElement(An,{approveInfo:d}):an(n)?gt.default.createElement(gt.default.Fragment,null,gt.default.createElement(Sn,{approveInfo:d,authAmount:x?.authAmount,editBtnSlot:[L.AUTHORIZATION,L.INCREASE_ALLOWANCE].includes(d?.approvalType)?gt.default.createElement(D,{size:D.SIZE.xs,type:D.TYPE.primary,category:D.CATEGORY.outline,className:Ho.edit_btn,onClick:e},i("wallet_extension_transfer_text_edit")):null}),gt.default.createElement(Rt,{alignBottom:!0,noContentPadding:!0,visible:o,onClose:e,className:Ho.authorization_token_dialog,windowClass:Ho.authorization_token_dialog__content},gt.default.createElement(tr,{txType:n,walletId:m,...x,onConfirm:M}))):mn(n)?gt.default.createElement(wn,{assetChange:c,dappInfo:s,showDappInfo:T,noFold:w}):T?gt.default.createElement(G,null,gt.default.createElement(hn,{...s})):null},$o=$r;a();l();var I=g(O()),yo=g(ne());V();a();l();var go=g(O());var er=g(zr());V();var _e=g(Et());a();l();var or={address:"_address_11ipy_1"};function fe({children:t,addresses:o=[],exploreUrl:e=""}){let n=o[0],r=(0,_e.useMemoizedFn)(()=>{(0,er.default)(n),Se.success({title:i("wallet_receive_toast_address_copied"),desc:""})},[n]),s=(0,_e.useMemoizedFn)(()=>{e&&globalThis.platform.openTab({url:`${e}${n}`})},[n,e]);return o.length>1?t:go.default.createElement(re.WhiteBoard,{rebirthPopper:!0,popupStyle:{marginLeft:16,marginRight:16,padding:12,borderRadius:8},content:go.default.createElement(u.FlexBox,{align:u.ALIGN.center,justify:"center"},go.default.createElement(C.Text,{forceWrap:!0,size:C.SIZE.sm,className:or.address},n),go.default.createElement(at,{size:at.SIZE.xs,icon:"okds-copy",onClick:r,style:{marginLeft:8}}),go.default.createElement(at,{size:at.SIZE.sm,icon:"okx-wallet-plugin-open-link",onClick:s,style:{marginLeft:8}})),trigger:re.TRIGGER.hover},t)}a();l();Fo();function de(t){return t===ve.XRC_NFT}a();l();var F={content:"_content_1i550_1",none:"_none_1i550_4",title:"_title_1i550_10",input:"_input_1i550_15",utxoContainer:"_utxoContainer_1i550_18",isCurrentAddr:"_isCurrentAddr_1i550_18",signTag:"_signTag_1i550_18",addrContainer:"_addrContainer_1i550_24",address:"_address_1i550_29",amount:"_amount_1i550_38",xrcAssetsContainer:"_xrcAssetsContainer_1i550_50",xrcAssetsTitle:"_xrcAssetsTitle_1i550_56",xrcAssetContainer:"_xrcAssetContainer_1i550_62",logo:"_logo_1i550_65",isNFT:"_isNFT_1i550_72",isNft:"_isNFT_1i550_72",amountText:"_amountText_1i550_75",protocol:"_protocol_1i550_78",moreXRCContainer:"_moreXRCContainer_1i550_85",moreXrcContainer:"_moreXRCContainer_1i550_85",showMoreTitle:"_showMoreTitle_1i550_89",moreAssetsLogos:"_moreAssetsLogos_1i550_95",moreAssetsLogo:"_moreAssetsLogo_1i550_95",expandContainer:"_expandContainer_1i550_106",expandContainer_title:"_expandContainer_title_1i550_110",expandContainerTitle:"_expandContainer_title_1i550_110",expandContainer_leftTotal:"_expandContainer_leftTotal_1i550_116",expandContainerLeftTotal:"_expandContainer_leftTotal_1i550_116",expandContainer_icon:"_expandContainer_icon_1i550_123",expandContainerIcon:"_expandContainer_icon_1i550_123"};var xe="inputInfo",nr="outputInfo",Vo={xrcAsset:10,utxo:50},Vr=({coinId:t,data:o={},currentAddr:e})=>{let[n,r]=(0,I.useState)({}),[,s]=rn(t,{withPrice:!0}),m=(0,I.useMemo)(()=>[xe,nr].map(c=>{let d=o[c]||[],M=n[c]||!1;return d.map((P,v)=>{let Y=n[`${c}-${v}`]||!1,k=P.xrcAssets||[];return P.xrcToShow=Y?k:k.slice(0,Vo.xrcAsset),P.moreXRC=k.slice(Vo.xrcAsset),P}),{key:c,exploreUrl:o.exploreUrl,allData:d,dataToShow:M?d:d.slice(0,Vo.utxo),moreData:d.slice(Vo.utxo)}}),[o,n]),_=(0,I.useCallback)((p=[])=>p.reduce((c,{amount:d})=>A.add(c,d),0),[]),x=(0,I.useCallback)(p=>{switch(p){case xe:return i("wallet_extension_asset_input_inputs_num",{amount:m[0].allData.length});case nr:return i("wallet_extension_asset_outputs",{amount:m[1].allData.length});default:return""}},[m]),E=(0,I.useCallback)(p=>{r(c=>({...c,[p]:!0}))},[]),T=p=>{let{protocolType:c}=p||{};return de(c)?p.logo||$e:p.logo||Ze},w=I.default.memo(({xrcAssets:p=[]})=>I.default.createElement(u.FlexBox,{align:u.ALIGN.center,className:F.moreAssetsLogos},p.slice(0,3).map(c=>I.default.createElement("img",{className:F.moreAssetsLogo,src:c.logo||"",alt:c.symbol}))));return I.default.createElement(Yo,{copyable:!1,title:i("wallet_extension_asset_btn_transaction_details")},m.map(p=>I.default.createElement("div",{className:(0,yo.default)(F.content,p.key===xe?F.input:"",p.dataToShow.length===0?F.none:"")},I.default.createElement("div",{className:(0,yo.default)(F.title)},x(p.key)),p.dataToShow.map((c,d)=>I.default.createElement(I.default.Fragment,null,I.default.createElement(u.FlexBox,{align:u.ALIGN.center,justify:"space-between",className:(0,yo.default)(F.utxoContainer,e===c.address[0]?F.isCurrentAddr:"")},I.default.createElement("div",{className:(0,yo.default)(F.addrContainer)},I.default.createElement(fe,{addresses:c.address,exploreUrl:p.exploreUrl},I.default.createElement("div",{className:F.address},c.address.length>1?i("wallet_extension_asset_title_multisig"):Ge(c.address[0]))),I.default.createElement(be,{className:F.signTag,size:ie.SIZE.sm},i("wallet_extension_asset_tag_sign"))),I.default.createElement("div",{className:F.amount},I.default.createElement(C.DisplayAmount,{noStyle:!0,amount:c.amount,mode:C.CRYPTO,symbol:s?.symbol,decimals:s?.decimals}))),c.xrcToShow.length>0&&I.default.createElement("div",{className:F.xrcAssetsContainer},I.default.createElement(C.Text,{size:C.SIZE.xs,className:F.xrcAssetsTitle},i("wallet_extension_asset_include_asset")),c.xrcToShow.map(M=>I.default.createElement(u.FlexBox,{align:u.ALIGN.center,className:F.xrcAssetContainer},I.default.createElement("img",{className:(0,yo.default)(F.logo,de(M.protocolType)?F.isNFT:""),src:T(M),alt:M.symbol}),I.default.createElement(C.Text,{nowrap:!0,size:C.SIZE.xs,ellipsis:{tooltip:!0},className:F.amountText},`${M.amount} ${M.symbol}`),I.default.createElement(ke,{className:F.protocol,size:ie.SIZE.sm},M.protocolName))),c.moreXRC.length>0&&!n[`${p.key}-${d}`]?I.default.createElement(u.FlexBox,{align:u.ALIGN.center,onClick:()=>{E(`${p.key}-${d}`)},className:F.moreXRCContainer},I.default.createElement(w,{xrcAssets:c.moreXRC}),I.default.createElement("div",{className:F.showMoreTitle},i("wallet_extension_asset_btn_show_num_asset",{amount:A.thousandFormat(c.moreXRC.length)})),I.default.createElement(at,{icon:"okds-arrow-chevron-down-md",size:at.SIZE.xs})):null))),p.moreData.length>0&&!n[p.key]?I.default.createElement("div",{className:F.expandContainer,onClick:()=>{E(p.key)}},I.default.createElement(u.FlexBox,{align:u.ALIGN.center,justify:"space-between"},I.default.createElement("div",{className:F.expandContainer_title},i("wallet_extension_asset_more_amount_inputs",{amount:A.thousandFormat(p.moreData.length)})),I.default.createElement(u.FlexBox,null,I.default.createElement("div",{className:F.expandContainer_leftTotal},I.default.createElement(C.DisplayAmount,{noStyle:!0,amount:_(p.moreData),mode:C.CRYPTO,symbol:s?.symbol,decimals:s?.decimals})),I.default.createElement(at,{icon:"okds-arrow-chevron-down-md",size:Ke.xs,className:F.expandContainer_icon})))):null)))},rr=Vr;a();l();var $=g(O()),ir=g(ne());V();a();l();var pt={main:"_main_asg9r_1",title:"_title_asg9r_8",scrollArea:"_scrollArea_asg9r_17",item:"_item_asg9r_22",subTitle:"_subTitle_asg9r_25",content:"_content_asg9r_32",loading:"_loading_asg9r_38",arrow:"_arrow_asg9r_43",icon:"_icon_asg9r_48"};function jr({psbts:t=[],loading:o,onClick:e}){let n=(0,$.useCallback)(s=>{e(s)},[e]),r=()=>o?$.default.createElement("div",{className:pt.scrollArea},$.default.createElement("div",{className:pt.loading},$.default.createElement(we.Circle,null))):t.length===0?$.default.createElement(Ae.State,{className:pt.empty}):$.default.createElement("div",{className:pt.scrollArea},(t||[]).map((s,m)=>$.default.createElement(u.FlexBox,{className:pt.item,align:u.ALIGN.center,key:s,onClick:()=>{n(m)}},$.default.createElement(u.FlexBox,{className:pt.content,direction:u.DIRECTION.vertical},$.default.createElement("div",{className:pt.subTitle},i("wallet_extension_asset_transaction_confirmation",{amount:le(m+1)})),$.default.createElement("div",{className:pt.content},Re(s))),$.default.createElement("div",{className:pt.arrow},$.default.createElement(at,{className:(0,ir.default)("okx-wallet-plugin-arrow-small-right",pt.icon)})))));return $.default.createElement(u.FlexBox,{className:pt.main},$.default.createElement("div",{className:pt.title},i("",{number:le(t.length)})),r())}var sr=(0,$.memo)(jr);mo();lo();a();l();var yt=g(O());V();a();l();var Vt={main:"_main_1h9ym_1",box:"_box_1h9ym_6",tipImg:"_tipImg_1h9ym_12",tipImgIcon:"_tipImgIcon_1h9ym_21",tipImgPic:"_tipImgPic_1h9ym_25",title:"_title_1h9ym_29",decs:"_decs_1h9ym_37",w100:"_w100_1h9ym_43",footerWrap:"_footerWrap_1h9ym_46"};var Kr=({visible:t,onCancel:o,onConfirm:e,headerProps:n,psbtHasMultiXRCAsset:r,paymentUseXRCAsset:s,assetInversion:m})=>{let _=(0,yt.useMemo)(()=>r?i("wallet_extension_tip_multiple_inscription_use"):s?i("wallet_extension_desc_inscription_asset"):m?i("wallet_extension_bot_desc_nft_high_pay"):"",[m,s,r]),x=ae({light:"/cdn/assets/imgs/254/1A753CC7A4597254.png",dark:"/cdn/assets/imgs/254/5A6525A2E28CDA88.png"}),E=ae({light:"/cdn/assets/imgs/2411/435A510ADAEB8439.png",dark:"/cdn/assets/imgs/2411/FF2841348F871214.png"});return yt.default.createElement(Rt,{visible:t,alignBottom:!0,noMargin:!0,maskClosable:!0,noContentPadding:!0,transitionProps:{type:"slide",placement:"bottom",timeout:300},confirmBtnProps:{size:D.SIZE.lg},cancelBtnProps:{size:D.SIZE.lg},cancelText:i("wallet_extension_function_btn_continue_transaction"),confirmText:i("wallet_extension_mid_dialog_btn_cancel"),onCancel:o,onConfirm:e,onClose:o},yt.default.createElement(u.FlexBox,{className:Vt.main,direction:u.DIRECTION.vertical},yt.default.createElement(u.Box,{className:Vt.box},yt.default.createElement(u.Box,{className:Vt.tipImg},yt.default.createElement(he,{src:m?x:E,className:Vt.tipImgPic})),yt.default.createElement(C.Text,{className:Vt.title,align:C.ALIGN.center},m?i("wallet_extension_bot_title_high_valuediff"):i("wallet_extension_title_transaction_risk")),yt.default.createElement(C.Text,{className:Vt.decs,size:C.SIZE.sm,align:C.ALIGN.center},_)),yt.default.createElement(u.Box,{className:Vt.w100},yt.default.createElement($o,{...n,showDappInfo:!1,loading:!1,noFold:!0}))))},ar=Kr;a();l();Dr();Ur();var jo=g(O()),Jr=()=>{let[t,o]=(0,jo.useState)(""),e=async()=>{let{data:n}=await Pe(Le.getSignPrompt);n.assetReminder?o(n.assetReminder):o(null)};return(0,jo.useEffect)(()=>{e()},[]),{assetReminder:t}},lr=Jr;a();l();var mr=g(O());V();var Qr=({onConfirm:t})=>(0,mr.useCallback)(()=>{Rt.warn({title:i("wallet_extension_asset_alertbanner_title_alert"),alignBottom:!1,maskClosable:!1,hideCloseBtn:!0,text:i("wallet_extension_asset_alertbanner_desc_utxo_lost"),confirmBtnProps:{type:D.TYPE.outline,size:D.SIZE.lg},cancelBtnProps:{type:D.TYPE.highlight,size:D.SIZE.lg},onConfirm(o){o.destroy(),t()},async onCancel(o){o.destroy()},cancelText:i("commonall_text_btn_cancel"),confirmText:i("wallet_extension_asset_btn_continue")})},[t]),cr=Qr;a();l();var Co=g(O());a();l();var R=g(O()),Te=g(ne());a();l();var Ct={main:"_main_1fewt_1",box:"_box_1fewt_6",isPureScreen:"_isPureScreen_1fewt_12",tipImg:"_tipImg_1fewt_15",tipImgIcon:"_tipImgIcon_1fewt_24",title:"_title_1fewt_28",decs:"_decs_1fewt_36",extLink:"_extLink_1fewt_42",footerWrap:"_footerWrap_1fewt_46",screenOneButtons:"_screenOneButtons_1fewt_49",extButton:"_extButton_1fewt_53"};var pr=t=>{let{children:o,desc:e,title:n,isPureScreen:r}=t;return R.default.createElement(u.FlexBox,{className:Ct.main,direction:u.DIRECTION.vertical},R.default.createElement(u.Box,{className:(0,Te.default)(Ct.box,{[Ct.isPureScreen]:r})},R.default.createElement(u.Box,{className:Ct.tipImg},R.default.createElement(Ie,{className:(0,Te.default)("okx-wallet-plugin-risk-trading",Ct.tipImgIcon)})),R.default.createElement(C.Text,{className:Ct.title,align:C.ALIGN.center},n),R.default.createElement(C.Text,{className:Ct.decs,size:C.SIZE.sm,align:C.ALIGN.center},e)),R.default.createElement(u.Box,{className:Ct.footerWrap},o))},ti=({modalParams:t,handleCancel:o,handleNext:e})=>{let{screenOne:n,screenTwo:r}=t,[s,m]=(0,R.useState)(!1),_=async()=>{m(!0),await o(),m(!1)};return R.default.createElement(pr,{desc:n.desc,title:n.title},R.default.createElement(u.Box,{className:Ct.screenOneButtons},R.default.createElement(D,{block:!0,loading:s,size:D.SIZE.lg,onClick:_,type:D.TYPE.highlight,category:D.CATEGORY.fill},n.mainBtnText),r?R.default.createElement(u.Box,{className:Ct.extButton,onClick:e},n.subBtnText):null))},oi=({handleCancel:t,handleNext:o,modalParams:e})=>{let{screenTwo:n={}}=e,{loading:r,onClick:s}=rt(o),{loading:m,onClick:_}=rt(t),x=[{loading:r,actionType:z.ACTION_TYPE.CANCEL,btnText:n.subBtnText,onClick:s},{loading:m,actionType:z.ACTION_TYPE.CONFIRM,btnText:n.mainBtnText,onClick:_}];return R.default.createElement(pr,{isPureScreen:!0,desc:n.desc,title:n.title},R.default.createElement(u.Box,{className:Ct.screenTwoButtons},R.default.createElement(z,{buttonGroup:x})))},ei=({handleCancel:t,closeModal:o,modalParams:e})=>{let[n,r]=(0,R.useState)(1);return n===2?R.default.createElement(oi,{modalParams:e,handleCancel:t,handleNext:o}):R.default.createElement(ti,{modalParams:e,handleCancel:t,handleNext:()=>{r(2)}})},ur=ei;a();l();var fr=g(O());V();a();l();var _r={extLink:"_extLink_1eb1z_1"};var ni=()=>{let t=nn(),o=r=>({title:i("wallet_extension_fractal_title_transaction_risky"),desc:i(r,{case:fr.default.createElement(Je,{className:_r.extLink,href:t?.scamsUrl},i("wallet_extension_function_link_case"))}),mainBtnText:i("wallet_extension_function_btn_cancel"),subBtnText:i("wallet_extension_function_btn_advanced")}),e={title:i("wallet_extension_fractal_title_transaction_risky"),desc:i("wallet_extension_function_desc_developer_continue"),mainBtnText:i("wallet_extension_mid_dialog_btn_cancel"),subBtnText:i("wallet_extension_function_btn_continue_transaction")};return{getUTXONotFoundModalParams:()=>({screenOne:o("wallet_extension_fractal_desc_transaction_risky"),screenTwo:e})}},dr=ni;var ri=({psbtsInfoErr:t,handleCancel:o})=>{let{getUTXONotFoundModalParams:e}=dr(),n=(0,Co.useRef)(),r=s=>{n.current||(n.current=Rt.action({hideCloseBtn:!0,maskClosable:!1,noContentPadding:!0,children:Co.default.createElement(ur,{modalParams:s,handleCancel:async()=>{await o(),n.current.destroy(),n.current=null},closeModal:()=>{n.current.destroy(),n.current=null}})}))};(0,Co.useEffect)(()=>{t?.code==Mt.UTXO_NOT_FOUND&&r(e())},[t])},xr=ri;a();l();V();a();l();var ge=g(Qe());var Tr=t=>{try{return ge.Psbt.fromHex(t).toBase64()}catch{return ge.Psbt.fromBase64(t),t}};var Ko=g(Qe()),vt={LIST:"list",UNLIST:"unlist",TRADE:"trade",RUNES:"runes"},gr=t=>{try{let o=Ko.Psbt.fromBase64(Tr(t)),e=o?.data?.inputs||[],n=o?.data?.globalMap?.unsignedTx?.tx?.outs||[],r=[];return e.forEach((s,m)=>{if(s.witnessUtxo)r.push({...s,value:s.witnessUtxo.value});else if(s.nonWitnessUtxo){let _=Ko.Transaction.fromBuffer(s.nonWitnessUtxo),x=o?.data?.globalMap?.unsignedTx?.tx?.ins||[],T=_.outs[x[m]?.index]?.value;r.push({...s,value:T})}}),{inputs:r,outputs:n}}catch{return{inputs:[],outputs:[]}}},jt=(t,o=0,e)=>!Array.isArray(t)||e===0?0:t.slice(o,e?o+e:void 0).reduce((n,{value:r})=>A.add(n,r),0);var Ir=({unapproved:t})=>{let{psbt:o,psbts:e,type:n,from:r,amount:s=1,psbtOpts:m,broadcast:_=!1}=t.params.transaction,{origin:x,method:E}=t,T=t.method===et.SIGNPSBTS,w=t?.walletId,p=t?.localType,d=Tt({localType:p})?.coinId;d===void 0&&(d=St(p));let M=po(w),P=uo(w),v=To(w),{loading:Y,data:k,error:h}=jn({address:r,hexStringList:T?e:[o],chainIndex:Xt(p)}),[B,X]=(0,f.useState)(!1),[q,ut]=(0,f.useState)(0),j=(0,f.useMemo)(()=>T&&!B,[T,B]),S=(0,f.useMemo)(()=>k[q]||{},[k,q]),{assetReminder:H}=lr(),W=(0,yr.useDispatch)(),Bt=(0,Cr.useHistory)(),It=In(t),{name:_t,icon:lt,host:Ut}=It,{inputs:eo,outputs:K}=gr(T?e[q]:o),mt=(0,f.useMemo)(()=>A.sub(jt(eo),jt(K)),[eo,K]),Lt=Mn(),no=(0,f.useMemo)(()=>{if(n!==vt.TRADE&&n!==vt.RUNES)return null;let J=Number(s);if(n===vt.RUNES){let so=jt(K,1,J),ao=A.add(jt(K,0,1),jt(K,K.length-J+1,J-1));return`${A.sub(ao,A.add(so,mt))}`}let Ft=jt(K,J+1,J),ft=jt(K,1,J);return`${A.sub(ft,A.add(Ft,mt))}`},[s,mt,K,n]),Nt=(0,f.useCallback)(async()=>{await W(nt(t.id)),await st(W)},[W,t.id]),{addressCheckError:At,addressCheckLoading:Wt}=$t({handleCancel:Nt,from:r,method:E,chainIndex:Xt(p)}),it=(0,f.useMemo)(()=>M&&T?{type:Z.TIP_TYPE.COMMON_ERROR,message:i("extension_wallet_contractual_interaction_wallet_unavailable")}:P?{type:Z.TIP_TYPE.COMMON_ERROR,message:i("wallet_extension_top_toast_dapp_comingsoon")}:At?{type:Z.TIP_TYPE.COMMON_ERROR,message:At}:h?{type:Kt.TYPE.warn,message:i("wallet_extension_asset_alert_trust_network")}:H&&!x?.includes("okx.com")?{type:Kt.TYPE.warn,message:H}:{},[M,T,P,h,H,x,At]),zt=(0,f.useCallback)(async()=>{if(!await _o({walletId:w,callback:async()=>{await W(nt(t.id))}}))return;let Ft=Fe(p);try{let ft=await tn(T?e:o,r,w,{localType:Ft,isPsbts:T},m);await W(ct(t.id,{signedTx:ft,broadcast:_}))}catch(ft){await Lt({id:t.id,error:ft?.message||"Error"})}await st(W)},[Bt,r,Lt,W,T,p,o,m,e,t.id,w]);xr({psbtsInfoErr:h,handleCancel:Nt});let ro=cr({onConfirm:zt}),[io,tt]=(0,f.useState)(!1),Yt=(0,f.useMemo)(()=>{let J=S?.inputInfo||[],Ft=S?.outputInfo||[],ft=J.filter(dt=>dt.address?.includes(r)),so=Ft.filter(dt=>dt.address?.includes(r)),ao=[],Lo=[];return ft.forEach(dt=>{dt.xrcAssets&&dt.xrcAssets.forEach(xt=>{ao.some(wo=>wo.symbol===xt.symbol&&wo.protocolId===xt.protocolId)||ao.push({symbol:xt.symbol,protocolId:xt.protocolId})})}),so.forEach(dt=>{dt.xrcAssets&&dt.xrcAssets.forEach(xt=>{Lo.some(wo=>wo.symbol===xt.symbol&&wo.protocolId===xt.protocolId)||Lo.push({symbol:xt.symbol,protocolId:xt.protocolId})})}),ao.length>0&&Lo.length>0?!ao.every(dt=>Lo.some(xt=>dt.symbol===xt.symbol&&dt.protocolId===xt.protocolId)):!1},[S,r]),Gt=(0,f.useMemo)(()=>{let J=S.inputInfo||[],Ft=S.outputInfo||[];return[...J,...Ft].some(ft=>!!(ft.xrcAssets&&ft.xrcAssets.length>1))},[S]),Io=(0,f.useMemo)(()=>k.some(J=>{let Ft=J.inputInfo||[],ft=J.outputInfo||[];return[...Ft,...ft].some(so=>!!(so.xrcAssets&&so.xrcAssets.length>1))}),[k]);(0,f.useEffect)(()=>{j||(Gt||Yt||S.assetInversion)&&tt(!0)},[k,j,Gt,Yt,S.assetInversion]);let Ao=(0,f.useCallback)(()=>{if(!Io||!j){zt();return}ro()},[Io,zt,ro,j]),So=(0,f.useCallback)(J=>{X(!0),ut(J)},[X]),{loading:Eo,onClick:ot}=rt(Nt),{loading:Pt,onClick:ko}=rt(Ao),bo=(0,f.useMemo)(()=>[{loading:Eo,actionType:z.ACTION_TYPE.CANCEL,btnText:j?i("wallet_extension_asset_btn_cancel_all"):i("wallet_dapp_connection_btn_reject"),onClick:ot},{disabled:P||Y||it.type===Z.TIP_TYPE.COMMON_ERROR,actionType:z.ACTION_TYPE.CONFIRM,btnText:j?i("wallet_extension_asset_btn_confirm_all"):i("extension_transactions_btn_confirm"),onClick:ko,loading:Pt||Wt}],[P,Eo,Pt,ot,it,ko,j,Y,Wt]),oe=(0,f.useMemo)(()=>{switch(n){case vt.LIST:return i("extension_wallet_transfer_maintitle_list");case vt.UNLIST:return i("extension_wallet_transfer_maintitle_cancel_listing");case vt.TRADE:return i("extension_wallet_transfer_maintitle_transaction");default:return i("extension_wallet_transfer_maintitle_transaction")}},[n]),Bo=(0,f.useMemo)(()=>n==="list"||S&&!S.isShowFee?!1:A.gt(S.gasFee,0)||A.gt(mt,0),[mt,S,n]),ho=(0,f.useMemo)(()=>!h||h===Mt.EXECUTE_ERROR&&S.status!==Mt.PSBT_ANALYSIS_FAILED,[h,S]),Mr=(0,f.useMemo)(()=>h&&h!==Mt.EXECUTE_ERROR||S?.status===Mt.PSBT_ANALYSIS_FAILED,[h,S]);return f.default.createElement(u.Container,null,f.default.createElement(Zt,{title:oe,backable:T&&B,closeable:!1,onBack:()=>{X(!1)}}),j?f.default.createElement("div",null,f.default.createElement(G,null,f.default.createElement(me,{summaryList:[{title:_t,desc:Ut,icon:{src:lt}}],title:i("extension_contract_interaction_maintitle_request_from")})),f.default.createElement(sr,{psbts:e,loading:Y,onClick:So})):null,j?null:f.default.createElement(f.default.Fragment,null,ho&&f.default.createElement($o,{coinId:d,txType:L.TRANS_OUT,loading:Y,dappInfo:{name:_t,host:Ut,icon:lt},analyzeRet:S}),Mr&&f.default.createElement(G,null,(n===vt.TRADE||n===vt.RUNES)&&f.default.createElement(xo,{summaryList:[{coinId:d,coinAmount:no}],tooltip:i("extension_infor_tooltip_asset_changestips"),title:i("extension_contract_interaction_maintitle_asset_changes")}),f.default.createElement(me,{summaryList:[{title:_t,desc:Ut,icon:{src:lt}}],title:i("extension_contract_interaction_maintitle_request_from")})),Bo&&f.default.createElement(G,null,f.default.createElement(fo,{coinId:d,networkFee:S.gasFee||mt})),f.default.createElement(G,null,f.default.createElement(to,{title:i("wallet_extension_network_address_title_walletused"),address:r,walletId:w,onCopyCallback:()=>{v({trade:"approve",all_confirmation:"wallet_used_address"})}})),!Bo&&f.default.createElement(G,null,f.default.createElement(On,{coinId:d})),f.default.createElement(G,null,f.default.createElement(rr,{coinId:d,data:S,currentAddr:r})),f.default.createElement(G,null,f.default.createElement(Yo,{data:T?e[q]:o,copyable:{hideDesc:!0}}))),B?null:f.default.createElement(Ht,{placeholder:!0,offsetBottom:0,borderTop:!0},f.default.createElement(Z,{coinId:d,...it}),f.default.createElement(z,{buttonGroup:bo})),f.default.createElement(ar,{visible:io,onCancel:()=>{tt(!1)},onConfirm:()=>{tt(!1),Nt()},headerProps:{coinId:d,txType:L.TRANS_OUT,analyzeRet:S},psbtHasMultiXRCAsset:Gt,paymentUseXRCAsset:Yt,assetInversion:S.assetInversion}))};a();l();var b=g(O()),hr=g(co()),wr=g(Et());V();mo();lo();var Nr=({unapproved:t})=>{let o=t.walletId,{localType:e,method:n}=t,r=Tt({localType:e}),s=r?.coinId;s===void 0&&(s=St(e));let m=uo(o),{memo:_,value:x,memoPos:E,to:T,satBytes:w,from:p,extraParams:c}=t.params.transaction,d=kt(s),[M,{toggle:P}]=(0,wr.useBoolean)(!1),[v,Y]=(0,b.useState)(w?{level:qt.CUSTOM,satBytes:w}:{}),k=v?.satBytes,h=(0,hr.useDispatch)(),[,B]=vo({coinId:s,address:p,chainId:d?.chainId}),X=B?.transferReminder;(0,b.useEffect)(()=>{if(!k&&B?.normal&&Y({level:qt.STANDARD,satBytes:B?.normal}),k&&v?.level!==qt.CUSTOM){let tt=B[Wo[v?.level]?.satBytes];Y({...v,satBytes:tt})}},[B]);let[q,ut]=Do({coinId:s,walletId:o,address:p,satBytes:k},{}),j=To(o),[S,H,W]=xn({coinId:s,toAddr:T,walletId:o,fromAddr:p,satBytes:k,coinAmount:x,canTransferAmount:ut},{}),Bt=(0,b.useMemo)(()=>ut===void 0||H===void 0?!0:A.gte(ut,A.add(H,x)),[ut,x,H]),It=Uo({coinId:s,txType:L.TRANS_OUT,address:p}),_t=Tn({memo:_,memoPos:E,coinId:s,toAddr:T,walletId:o,coinAmount:x,fromAddr:p,localType:d?.localType,dustSize:B?.minOutput,networkFee:H,satBytes:v.satBytes}),lt=_n({coinId:s,walletId:o,satBytes:k,address:p,utxoType:Qt.TRANSFER}),Ut=po(o),[eo,K]=(0,b.useState)(!1),mt=(0,b.useCallback)(async()=>{await h(nt(t.id)),await h(ht()),await st(h),K(!1)},[h,t.id]),Lt=(0,b.useCallback)(async()=>{if(!await _o({walletId:o,callback:async()=>{await h(nt(t.id))}}))return;let Yt=await lt(x,H);await It(Yt,()=>{mt()}),K(!0);let Gt=await _t({utxoList:Yt});t.id&&(await h(ct(t.id,{signedTx:Gt,coinAmount:x,serviceCharge:H,satPerByte:k,coinId:s,...c})),await h(ht())),K(!1)},[It,x,h,H,c,lt,mt,k,_t,t.id]),{loading:no,onClick:Nt}=rt(mt),{loading:At,onClick:Wt}=rt(Lt),{addressCheckError:it,addressCheckLoading:zt}=$t({method:n,from:p,handleCancel:Nt,chainIndex:r?.chainId||Po}),ro=(0,b.useMemo)(()=>m?{type:Z.TIP_TYPE.COMMON_ERROR,message:i("wallet_extension_top_toast_dapp_comingsoon")}:Bt?W?{type:Z.TIP_TYPE.FEE_ERROR}:it?{type:Z.TIP_TYPE.COMMON_ERROR,message:it}:{type:Kt.TYPE.warn,message:X}:{type:Z.TIP_TYPE.FEE_BALANCE_INSUFFICIENT},[W,m,Bt,X,it]),io=(0,b.useMemo)(()=>{let tt=[{actionType:z.ACTION_TYPE.CANCEL,btnText:i("wallet_dapp_connection_btn_reject"),onClick:Nt,loading:no}];return Bt?tt=[...tt,{disabled:q||S||W||m||!Number(H)||!!it,actionType:z.ACTION_TYPE.CONFIRM,onClick:Wt,loading:At||zt}]:tt=[...tt,{coinId:s,address:p,walletId:o,actionType:z.ACTION_TYPE.FILL_UP}],tt},[no,s,At,H,W,S,p,m,Bt,q,Nt,Wt,o,zt,it]);return b.default.createElement(u.Container,null,b.default.createElement(Zt,{title:i("wallet_trade_maintitle_transaction_confirm"),backable:!1,closeable:!1}),b.default.createElement(G,null,b.default.createElement(xo,{title:i("wallet_extension_send_colored_send"),summaryList:[{coinId:s,coinAmount:x}]})),b.default.createElement(G,null,b.default.createElement(to,{walletId:o,address:p,title:i("extension_send_mid_text_from"),onCopyCallback:()=>{j({trade:"send",all_confirmation:"wallet_used_address"})}},!!ut&&b.default.createElement(Go,{coinBalance:ut,coinId:s})),b.default.createElement(to,{address:T,title:i("extension_send_mid_text_to"),onCopyCallback:()=>{j({trade:"send",all_confirmation:"to_address"})}})),b.default.createElement(G,{bordered:!1},b.default.createElement(fo,{coinId:s,loading:S,estimateFailed:W,networkFee:H,level:v?.level,onClick:()=>{P(),j({trade:"send",all_confirmation:"network_fee"})}})),b.default.createElement(Ht,{placeholder:!0,offsetBottom:0,borderTop:!0},b.default.createElement(Z,{coinId:s,...ro}),b.default.createElement(z,{buttonGroup:io})),b.default.createElement(zo,{coinId:s,visible:M,signInfo:B,value:v,estimatedFee:H,onChange:Y,onToggleVisible:P}),b.default.createElement(Ro,{visible:Ut&&eo}))};a();l();var No=g(O()),br=g(Et());Fo();lo();a();l();function Ar(t){try{return[JSON.parse(t),null]}catch{return[null,new Error("Illegal JSON string")]}}vr();a();l();var te=g(O()),Er=g(co());V();mo();lo();a();l();var U=g(O());V();var Qo=g(Et());a();l();var Ot={"inscription-preview":"_inscription-preview_yy6vc_1",inscriptionPreview:"_inscription-preview_yy6vc_1","inscription-preview__inner":"_inscription-preview__inner_yy6vc_13",inscriptionPreviewInner:"_inscription-preview__inner_yy6vc_13","inscription-preview-text":"_inscription-preview-text_yy6vc_21",inscriptionPreviewText:"_inscription-preview-text_yy6vc_21","inscription-preview-image":"_inscription-preview-image_yy6vc_26",inscriptionPreviewImage:"_inscription-preview-image_yy6vc_26","inscription-item__content":"_inscription-item__content_yy6vc_30",inscriptionItemContent:"_inscription-item__content_yy6vc_30","inscription-exceedTip":"_inscription-exceedTip_yy6vc_34",inscriptionExceedTip:"_inscription-exceedTip_yy6vc_34","inscription-extend":"_inscription-extend_yy6vc_39",inscriptionExtend:"_inscription-extend_yy6vc_39","inscription-extend__icon":"_inscription-extend__icon_yy6vc_43",inscriptionExtendIcon:"_inscription-extend__icon_yy6vc_43"};var ye=24,Jo={TEXT:"text",IMAGE:"image"},ii=U.default.memo(({type:t,contentType:o,body:e})=>{let[{inscriptionType:n,inscriptionContent:r},s]=(0,Qo.useSetState)({inscriptionType:Jo.TEXT,inscriptionContent:e});return(0,U.useEffect)(()=>{if(t===L.ORDINAL_NFT||o?.startsWith("image/"))try{let m=URL.createObjectURL(new Blob([e]));s({inscriptionType:Jo.IMAGE,inscriptionContent:m})}catch{s({inscriptionType:Jo.TEXT,inscriptionContent:e})}finally{s({initing:!1})}},[e,o,s,t]),U.default.createElement(u.Box,{className:Ot["inscription-preview"]},n===Jo.IMAGE?U.default.createElement("img",{alt:"",src:r,className:Ot["inscription-preview-image"]}):U.default.createElement(u.Box,{className:Ot["inscription-preview__inner"]},U.default.createElement(C.Text,{forceWrap:!0,className:Ot["inscription-preview-text"]},r)))}),si=({type:t,contentType:o,body:e,rawBody:n})=>{let r=(0,U.useMemo)(()=>{let _=e?.length;return A.lt(_,1024)?`${_} B`:`${A.floorTruncate(A.div(_,1024),3)} KB`},[e?.length]),s=t===L.ORDINAL_NFT||o?.startsWith("image/"),m=s?n?.slice(0,200):n;return U.default.createElement(u.FlexBox,null,U.default.createElement(ii,{type:t,body:e,contentType:o}),U.default.createElement(u.FlexBox,{direction:u.DIRECTION.vertical,className:Ot["inscription-item__content"]},U.default.createElement(C.Text,{strong:!0,ellipsis:{tooltip:!s},size:C.SIZE.xs},m),U.default.createElement(C.Text,{size:C.SIZE.xs,type:C.TYPE.secondary},r)))},ai=({type:t,dataSource:o=[]})=>{let e=o?.length||0,[n,{toggle:r}]=(0,Qo.useBoolean)(!1),s=(0,U.useMemo)(()=>n?o?.slice(0,ye):o?.slice(0,3),[o,n]),m=(0,U.useMemo)(()=>ze(t),[t]);return U.default.createElement(gn,{space:16,title:i(m,{num:e})},U.default.createElement(en,{space:24,renderEmpty:!1,dataSource:s,renderItem:_=>U.default.createElement(si,{..._,type:t})}),n&&e>ye&&U.default.createElement(C.Text,{size:C.SIZE.xs,type:C.TYPE.secondary,className:Ot["inscription-exceedTip"]},i("wallet_info_dialog_desc_replicate_hide",{num:A.sub(e,ye)})),e>3&&U.default.createElement(u.FlexBox,{justify:"center",className:Ot["inscription-extend"],onClick:r},U.default.createElement(at,{size:at.SIZE.xs,className:Ot["inscription-extend__icon"],icon:n?"okds-arrow-chevron-up-md":"okx-wallet-plugin-add-arrow-chevrons"})))},Sr=ai;function li({unapproved:t}){let o=(0,Er.useDispatch)(),{id:e}=t,{type:n}=t.params?.transaction||{},r=We[n],{localType:s}=t,_=Tt({localType:s})?.coinId;_===void 0&&(_=St(s));let x=async()=>{await o(ht()),await o(nt(t.id)),await st(o)},E=async w=>{await o(ct(t.id,w)),await o(ht())},{inscriptions:T}=kn();return te.default.createElement(bn,{txId:e,headerProps:{title:r?i(r):null,closeable:!1,backable:!1},confirmButtonProps:{onCancel:x,onConfirm:E},slot:{top:te.default.createElement(G,null,te.default.createElement(Sr,{type:n,dataSource:T}))},netWorkCoinId:_})}var kr=li;var mi=[L.BRC20_MINT,L.BRC20_INSCRIBE,L.BRC20_DEPLOY],ci=[L.RUNES_ETCH];function pi(t,o){let e=De(o);return mi.includes(t)?e=Oe(o):ci.includes(t)&&(e=Ue(o)),e}function ui(t,o){return o.map(({contentType:e,body:n})=>{let r=n;try{(t===L.ORDINAL_NFT||typeof t!="number"&&e?.startsWith("image/"))&&(r=y.Buffer.from(n,"hex"))}catch{}return{contentType:e,body:r,rawBody:n}})}function _i({unapproved:t}){let{tick:o,type:e,from:n,to:r,txSource:s,inscriptions:m=[],amount:_,mintType:x=Ye.parallel,noBroadCast:E=!1}=t.params?.transaction||{},{localType:T}=t,w=(0,No.useMemo)(()=>ui(e,m),[e,m]),p=Tt({localType:T}),c=p?.netWorkId;c===void 0?c=Xt(T):c=+c;let d=p?.coinId;d===void 0&&(d=St(T));let M=(0,br.useCreation)(()=>{if(e===L.RUNES_ETCH){let[h,B]=Ar(m[0]?.body);if(B)return{chainId:c,coinType:se(c),symbol:o,address:"btc-runesMain-invalid-inscriptions"};let X=h?.id||"";return{chainId:c,coinType:se(c),symbol:o,address:`btc-runesMain-${X}`}}return o?{chainId:c,coinType:Mo(c),symbol:o}:null},[o,e,c]),P=pi(e,c),v=kt(void 0,{},M),Y=(h,B)=>{let X=0;if(e===L.RUNES_ETCH){h.coinAmount=ee(_,10**v?.decimals),h.coinId=v?.coinId||d,h.txSource=s||Jt.DAPP;return}_&&v?.decimals&&(X=ee(_,10**v?.decimals)),h.coinAmount=X,h.coinId=B?d:v?.coinId||d,h.txSource=s||Jt.DAPP},k=(h,B)=>(h&&Y(h,!0),Array.isArray(B)&&B.forEach(X=>{Y(X,!1)}),E);return No.default.createElement(Bn,{params:{walletId:t.walletId,utxoType:Qt.INSCRIPTION_USE_NFT_UTXO,from:n,to:r,inscriptions:w,txType:e,protocolId:P,mintType:x,netWorkCoinId:d},lifecycle:{beforePostTx:k}},No.default.createElement(kr,{unapproved:t}))}var Br=_i;a();l();var Lr=g(O()),Pr=g(co()),Ce=g(Et());V();mo();var fi=({unapproved:t})=>{let o=(0,Pr.useDispatch)(),{targetCoin:e}=t.params||{},n={image:e.logo,decimals:e.decimals,name:e.name,address:e.contractAddress,symbol:e.symbol},r=To(),s=(0,Ce.useMemoizedFn)(async()=>{r({all_confirmation:"cancel",trade:"add_token"}),await o(nt(t.id)),await st(o)}),{loading:m,onClick:_}=rt(s),x={actionType:z.ACTION_TYPE.CANCEL,btnText:i("wallet_dapp_connection_btn_reject"),onClick:_,loading:m},E=(0,Ce.useMemoizedFn)(async()=>{try{r({all_confirmation:"confirm",trade:"add_token"}),await on(e),await o(ct(t.id)),await st(o)}catch(d){Ee.error(d?.data?.originalError?.msg||i("wallet_extenshion_toast_add_failed"))}}),{loading:T,onClick:w}=rt(E),p={actionType:z.ACTION_TYPE.CONFIRM,onClick:w,loading:T},c=[x,p];return Lr.default.createElement(vn,{token:n,networkName:e.blockChain||e.localType,buttonGroup:c})},Fr=fi;var Uu=({unapproved:t})=>{switch(t.method){case et.TRANSFER_NFT:case et.SEND_INSCRIPTION:return Dt.default.createElement(Wn,{unapproved:t});case et.SPLITUTXO:return Dt.default.createElement(Yn,{unapproved:t});case et.INSCRIBE:case et.INSCRIBE_TRANSFER:return Dt.default.createElement(Zn,{unapproved:t});case et.SIGNPSBT:case et.SIGNPSBTS:return Dt.default.createElement(Ir,{unapproved:t});case et.SIGN_MESSAGE:return Dt.default.createElement(Rn,{unapproved:t});case et.MINT:return Dt.default.createElement(Br,{unapproved:t});case et.WATCHASSET:return Dt.default.createElement(Fr,{unapproved:t});case et.SEND:case et.SEND_BTC:return Dt.default.createElement(Nr,{unapproved:t});default:return""}};export{Uu as default};

window.inOKXExtension = true;
window.inMiniApp = false;
window.ASSETS_BUILD_TYPE = "publish";

//# sourceMappingURL=Bitcoin-JO3CTZAU.js.map
