import{a as ge,b as we,c as xe}from"./chunk-QXPTHK7Q.js";import{c as M}from"./chunk-YAQ2CLWQ.js";import{a as z}from"./chunk-TSTKPLAO.js";import{a as pe}from"./chunk-K6STDTUY.js";import{a as fe}from"./chunk-V3IFYKWM.js";import{o as K}from"./chunk-5QMHGZLF.js";import{o as ue,r as ze}from"./chunk-3DZ7WRLL.js";import{a as _e}from"./chunk-JGEHAFTO.js";import{Dc as me,Ea as le,Na as Ve,Sc as Oe,ac as ce,rc as Ye,ya as de,za as Le}from"./chunk-TM67VPZU.js";import{G as V,o as O,q as N}from"./chunk-PUSMMCUD.js";import{R as L,z as o}from"./chunk-UWJLNJLY.js";import{a as Pe}from"./chunk-VRY2ADKE.js";import{ba as ne,f as q,j as re,la as ie,o as ae,ra as Y}from"./chunk-XDY6V34Y.js";import{$ as H,c as Se,ea as k}from"./chunk-JT3LNHPY.js";import{b as A}from"./chunk-JWYCKY2V.js";import{f as x,o as m,q as u}from"./chunk-6KXF36WM.js";m();u();var g=x(A());Y();L();m();u();var E=x(A());var be=x(K());L();function W({type:s,addressData:r,addressInputValue:e,addressInputError:n,setAddressInputValue:d,setAddressInputError:p,onChangeToEdit:w,validNetworks:f,isLoading:t,isBetterLoading:i}){let{id:l,address:a}=r,c=s===C.TYPE.EDIT,_=M(e),b=!!_?.id&&(!c||_?.id!==l),I=(0,E.useRef)(!1),D=n&&I.current?n:"",{run:G}=(0,be.useDebounceFn)(async()=>{let T="";e&&f&&!f.length&&(T=o("wallet_extension_addaddress_errortip_wrong_address")),b&&(T=o("wallet_extension_addaddress_errortip_address_exists")),I.current=!0,p(T)},{wait:50}),P=T=>{d(T.target.value)},S=()=>{w(_)};return(0,E.useEffect)(()=>{G()},[f]),E.default.createElement(E.default.Fragment,null,E.default.createElement(N.TextArea,{className:"address-edit-dialog__address-input",placeholder:o("wallet_extension_addaddress_input_enter_address"),disabled:!c&&a,label:o("wallet_extension_addaddress_subtitle_address"),value:e,error:!t&&!!D,errorType:N.TIP_TYPE.always,size:N.SIZE.xl,suffix:i&&E.default.createElement(H.Circle,{size:H.SIZE.sm}),onChange:P,autoResize:!0}),D&&E.default.createElement("div",{className:"address-edit-dialog__address-input__error"},D,b&&E.default.createElement("span",{className:"address-edit-dialog__address-input__error-action",onClick:S},o("wallet_extension_addaddress_anchor_go_to_edit"))))}m();u();var Ee=x(A());L();ze();function X({type:s,addressId:r,nameInputValue:e,addressInputValue:n,networkSelectList:d,addressInputError:p,nameInputError:w,hasSelect:f,onClose:t}){let i=s===C.TYPE.EDIT,l=e===""||n===""||p!==""||w!==""||!f||d.length===0,a=async c=>{c.stopPropagation();let _={address:n,name:e,networks:d};if(i)await we(r,_),V.success({title:o("wallet_extension_editaddress_toast_edit_saved")}),t(_);else try{await ge(_),V.success({title:o("wallet_extension_addressbook_toast_address_added")}),t(_)}catch(b){b?.message===ue&&V.error({title:o("wallet_extension_addressbook_toast_address_limit_reached")})}};return Ee.default.createElement(k,{className:"address-edit-dialog__save",disabled:l,category:k.CATEGORY.fill,type:k.TYPE.highlight,size:k.SIZE.lg,onClick:a,block:!0},o("wallet_set_password_btn_confirm"))}m();u();var ke=x(A());L();function U({addressId:s,onClose:r,onDelete:e}){let n=()=>{let p=O.warn({title:o("wallet_extension_editaddress_modal_detele_address"),alignBottom:!1,cancelText:o("wallet_extension_editaddress_btn_cancel"),confirmText:o("wallet_extension_editaddress_btn_detele"),onCancel:()=>{p.destroy()},onConfirm:async()=>{await xe(s),V.success({title:o("wallet_extension_addressbook_toast_address_deleted")}),e&&e(),r()}})},d=()=>{n()};return ke.default.createElement(k,{className:"address-edit-dialog__delete-button",contentClassName:"address-edit-dialog__delete-button-content",category:k.CATEGORY.outline,type:k.TYPE.primary,size:k.SIZE.lg,onClick:d},o("commonall_resultpage_btn_delete"))}m();u();var B=x(A());L();var he=x(K());Y();function J({nameInputValue:s,nameInputError:r,setNameInputValue:e,setNameInputError:n}){let d=(0,B.useRef)(),p=(0,B.useRef)(!1),w=r&&p.current?r:"",{run:f}=(0,he.useDebounceFn)(()=>{p.current=!0;let i="";ne(s)>20&&(i=o("wallet_extension_addaddress_errortip_maximum_20")),n(i)},{wait:50}),t=i=>{f(),e(i.target.value)};return(0,B.useEffect)(()=>{d.current.focus()},[]),B.default.createElement(N,{className:"address-edit-dialog__name-input",placeholder:o("wallet_extension_addaddress_input_enter_name_limit"),label:o("wallet_extension_addaddress_subtitle_name"),value:s,error:w,errorType:N.TIP_TYPE.always,size:N.SIZE.xl,onChange:t,maxLength:30,onRef:i=>{d.current=i}})}m();u();var y=x(A());Y();L();m();u();var v=x(A()),Q=x(Se());Y();m();u();var Me=({className:s="",options:r=[],onChange:e=()=>{}})=>{let[n,d]=(0,v.useState)({}),[p,w]=(0,v.useState)({});(0,v.useEffect)(()=>{let t={},i={};for(let l=0;l<r.length;l++){let a=r[l];a.active&&(t[a.value]=a),a.disabled&&(i[a.value]=a)}d(t),w(i)},[r]);let f=t=>{if(t.disabled)return;let i=t.value,l=ae(n);n[i]?(delete l[i],d(l)):(l[i]=t,d(l));let a=Object.values(l);e&&e(a)};return v.default.createElement("div",{className:(0,Q.default)("ok-button-checkbox",s)},r.map((t,i)=>v.default.createElement("div",{className:(0,Q.default)("ok-button-checkbox__item",{"ok-button-checkbox__item--active":!!n[t.value],"ok-button-checkbox__item--disabled":!!p[t.value]}),onClick:()=>{f(t)},key:i},t.image&&v.default.createElement("img",{className:"ok-button-checkbox__item-icon",src:t.image,alt:t.label}),v.default.createElement("span",{className:"ok-button-checkbox__item-text"},t.label))))},ve=Me;Oe();var Fe=[me];function $({network:s,networkSelectList:r,setNetworkSelectList:e,setHasSelect:n,disabled:d,validNetworks:p}){let w=pe(),[f,t]=(0,y.useState)([]),i=a=>{if(!a.length){e([]);return}let c=a.map(_=>_.value);e(c)},l=z();return(0,y.useLayoutEffect)(()=>{let a=l.filter(({coinType:c,localType:_})=>!Fe.includes(_)&&p?.includes(c)).map(({chainName:c,localType:_})=>{let b=re(w.find(I=>I.localType===_),"image");return{disabled:s===_,active:r.includes(_),label:c,value:_,image:b}});t(a),n(a.some(c=>c.active))},[p,r,l]),d||!f.length?null:y.default.createElement("div",{className:"address-edit-dialog__network-select"},y.default.createElement("div",{className:"address-edit-dialog__network-select__title"},o("wallet_extension_addressbook_title_select_networks")),y.default.createElement(ve,{options:f,onChange:i}))}m();u();var Z=x(A());m();u();Pe();var F=x(A()),Ae=x(K());Y();Ve();Le();Ye();var Ie={[14001]:async s=>{if(!s)return!1;let r={account:s,coinId:ce},e;try{e=await le(de.queryAccountExist,r)}catch{q()}return!!e?.data?.account},default:async(s,r,e)=>{let{validAddress:n}=await _e(),{isValid:d}=await n(r.valueOf(),{address:s,hrp:e});return d}};function Ze(){let[s,r]=(0,F.useState)(0),e=(0,F.useRef)(0),n=z(),d=s>0,p=(0,Ae.useDebounce)(d,{wait:200});return{isLoading:d,isBetterLoading:p,validAddress:(f,t)=>{(async()=>{let l=++e.current,a=[];r(c=>c+1);try{await Promise.all(n.map(async({coinType:c,cosmosPrefix:_})=>{try{await(Ie[c]||Ie.default)(f,c,_)&&a.push(Number(c))}catch{q()}}))}finally{l===e.current&&(r(0),t(a))}})()}}}var Ce=Ze;function Ge(s){let[r,e]=(0,Z.useState)(null),{isLoading:n,isBetterLoading:d,validAddress:p}=Ce();return(0,Z.useEffect)(()=>{if(!s){e(null);return}p(s,w=>{e(w)})},[s]),{validNetworks:r,isBetterLoading:d,isLoading:n}}var Ne=Ge;m();u();function C({type:s,data:r,onClose:e,visible:n,onDelete:d,onChangeToEdit:p}){let{id:w,address:f,network:t}=r,i=M(f),[l,a]=(0,g.useState)(""),[c,_]=(0,g.useState)(""),[b,I]=(0,g.useState)(""),[D,G]=(0,g.useState)(""),[P,S]=(0,g.useState)([]),[T,ye]=(0,g.useState)(!0),{isLoading:Te,isBetterLoading:R,validNetworks:ee}=Ne(l);(0,g.useEffect)(()=>{if(s===C.TYPE.EDIT&&i){let{name:j,networks:se}=i,oe=se;t&&(oe=ie([...se,t])),I(j),a(f),S(oe)}else a(f||""),S(t?[t]:[]),I("")},[s,f,t,n]);let te=s===C.TYPE.EDIT,Be=l||b||P.length,De=te?o("wallet_extension_editaddress_title_edit_address"):o("wallet_extension_addaddress_title_add_address");return g.default.createElement(O.Action,{isFull:!0,visible:n,title:De,containerClassName:"edit-address-container",scrollBoxClassName:"edit-address-scroll-box",onClose:()=>{if(!te&&Be){let j=O.warn({maskClassName:"edit-address-confirm-dialog",title:o("wallet_extension_addaddress_modal_cancel_adding"),alignBottom:!1,cancelText:o("wallet_extension_addaddress_btn_no"),confirmText:o("wallet_extension_addaddress_btn_yes"),onCancel:()=>{j.destroy()},onConfirm:async()=>{e()}})}else e()}},g.default.createElement("div",{className:"address-edit-dialog"},g.default.createElement("div",{className:"address-edit-dialog__body"},g.default.createElement(J,{nameInputValue:b,nameInputError:D,setNameInputValue:I,setNameInputError:G}),g.default.createElement(W,{type:s,addressData:r,addressInputValue:l,addressInputError:c,setAddressInputError:_,setAddressInputValue:a,onChangeToEdit:p,validNetworks:ee,isLoading:Te,isBetterLoading:R}),g.default.createElement($,{network:t,networkSelectList:P,setNetworkSelectList:S,setHasSelect:ye,validNetworks:ee,disabled:!l||c||R})),g.default.createElement(fe.FooterActions,{placeholder:!1,affixStyle:{position:"static",width:"100%"}},s===C.TYPE.EDIT&&g.default.createElement(U,{addressId:w,onClose:e,onDelete:d}),g.default.createElement(X,{type:s,addressId:w,nameInputValue:b,addressInputValue:l,networkSelectList:P,addressInputError:c,nameInputError:D,hasSelect:T,onClose:e}))))}C.TYPE={EDIT:"edit",ADD:"add"};export{C as a};

window.inOKXExtension = true;
window.inMiniApp = false;
window.ASSETS_BUILD_TYPE = "publish";

//# sourceMappingURL=chunk-LUD6HZM6.js.map
