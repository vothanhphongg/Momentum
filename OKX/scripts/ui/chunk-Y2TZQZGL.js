import{b as le,e as pe,f as ce}from"./chunk-4FBPDXIS.js";import{b as _e}from"./chunk-ZV5BZTW2.js";import{a as ie,b as ne,h as A}from"./chunk-YDPPVPLV.js";import{a as fe}from"./chunk-GCXGJXXN.js";import{a as Z,e as H,f as $,n as K}from"./chunk-XKL64FTO.js";import{a as me}from"./chunk-PTD7UCOR.js";import{a as de}from"./chunk-LLZAOPDB.js";import{a as oe}from"./chunk-V3IFYKWM.js";import{b as te,c as ae}from"./chunk-Y2TPPS4H.js";import{h as re,i as se}from"./chunk-ITY22AD4.js";import{a as q,ma as X,x as J,z as Q}from"./chunk-YALUYHLV.js";import{q as i}from"./chunk-I3CPAVOC.js";import{o as j}from"./chunk-5QMHGZLF.js";import{ec as Ve}from"./chunk-HPWCPLRR.js";import{a as ee}from"./chunk-D2LKUI4F.js";import{a as We}from"./chunk-ON6S2DB7.js";import{c as b}from"./chunk-43VURGIT.js";import{B as R,H as Fe,ia as G,ja as Be}from"./chunk-TM67VPZU.js";import{H as N,o as y,q as C}from"./chunk-PUSMMCUD.js";import{R as h,z as o}from"./chunk-UWJLNJLY.js";import{c as Ue,ea as f}from"./chunk-JT3LNHPY.js";import{b as k}from"./chunk-JWYCKY2V.js";import{f as _,o as r,q as s}from"./chunk-6KXF36WM.js";r();s();var e=_(k()),Ce=_(Ve()),xe=_(We()),S=_(j()),F=_(Ue());h();r();s();var x=_(k()),M=_(j());r();s();r();s();var Ye=()=>{};function De(){return[!1,Ye]}var ue=De;var we=ue;r();s();h();var ze=()=>{try{ie({tg_platform:A()})}catch{}},ge=(a=!1)=>{try{ne({tg_platform:A(),button:a?"password":"cancel"})}catch{}},Re=(a,t)=>{ze();let n=y.tip({infoType:y.Tip.INFO_TYPE.default,title:o("wallet_extension_tgsync_dialog_title_verification_fail"),children:o("wallet_extension_tgsync_dialog_desc_verification_fail"),confirmText:o("wallet_extension_tgsync_dialog_btn_use_password"),btnFull:!1,zIndex:40003,cancelText:o("commonall_text_btn_cancel"),onConfirm:async()=>{ge(!0),await Promise.resolve(a()),n.destroy()},onCancel:async()=>{ge(!1),await Promise.resolve(t?.()),n.destroy()}});return n},ye=Re;var Ze=a=>{let[t]=ae(te.passwordType),[n]=we(),[l,m]=(0,x.useState)(t),u=()=>{m(1)},P=(0,M.useMemoizedFn)(async(v=!0)=>{if(!n){await Promise.resolve(a?.());return}if(!v){await Promise.resolve(a?.());return}ye(u,a)}),T=(0,M.useMemoizedFn)(()=>{m(t)});return(0,x.useEffect)(()=>{m(t)},[t]),{currentPasswordType:l,isPasskeyNewUser:n,onVerifyPasskeyFailed:P,onResetPasswordType:T}},Te=Ze;r();s();var O=_(k());h();r();s();var Pe={forgetPasswordLink:"_forgetPasswordLink_l8eva_1"};var He=({className:a="",strong:t=!1,from:n="",replace:l,path:m})=>{let u=m??J;return O.default.createElement(ee,{to:n?`${u}?from=${n}`:u,className:`${a} ${Pe.forgetPasswordLink}`,replace:l},O.default.createElement(i.Text,{size:i.SIZE.xs,type:i.TYPE.secondary,align:i.ALIGN.left,strong:t},o("wallet_footer_subtitle_forgot_password")))},Ee=He;Be();Fe();r();s();var ke=_(k());h();var he=({confirm:a,visible:t})=>ke.default.createElement(y.Prompt,{visible:t,infoType:y.Prompt.INFO_TYPE.warn,title:o("wallet_extension_security_dialog_protect_seed_phrase"),confirmText:o("commonall_text_btn_ok_passive"),text:o("wallet_extension_security_dialog_no_leak"),onConfirm:a,hideCloseBtn:!0,alignBottom:!1,maskClosable:!1,confirmBtnProps:{type:f.TYPE.highlight,size:f.SIZE.lg}});r();s();r();s();var p={guard:"_guard_k59wc_1",title:"_title_k59wc_1",subTitle:"_subTitle_k59wc_6",inputPassword:"_inputPassword_k59wc_11",inputClass:"_inputClass_k59wc_15",guardInputClass:"_guardInputClass_k59wc_19",guardHeaderClass:"_guardHeaderClass_k59wc_22",forgot:"_forgot_k59wc_25",forgotInput:"_forgotInput_k59wc_29",unlockTrigger:"_unlockTrigger_k59wc_33"};var $e=13,Tr=a=>{let t=(0,xe.useHistory)(),{current:{walletId:n,actionType:l,nextPath:m=q,groupId:u}}=e.default.useRef(de(t&&t.location.search.slice(1))),{callback:P,guard:T,onBack:v,path:B}=a,U=(0,e.useRef)(),w=(0,Ce.useDispatch)(),[g,ve]=e.default.useState(),[V,W]=e.default.useState(),[Le,L]=(0,e.useState)(!1),[Ie,Ne]=(0,e.useState)(!1),{currentPasswordType:be,onVerifyPasskeyFailed:Ae}=Te(),{handleCloudResetError:Me}=fe(),E=be===2,Oe=(0,S.useMemoizedFn)(({target:{value:c}})=>{ve(c),W(void 0)},[]),Y=c=>{if(L(!1),P){P(c);return}m&&t.replace(m)},I=(0,S.useMemoizedFn)(async()=>{let c=U.current||g;if(!!c)try{if(L(!0),await K(c)===!0){if(T){Ne(!0);return}if(["removeLastWallet","removeWallet"].includes(l)?await w($(u)):l==="removeAccount"&&await w(H(n)),l==="removeLastWallet"){await w(Z()),await w(_e()),await w(re(1)),await w(se(void 0)),t.push(Q);return}l==="removeAccount"?N.success(o("wallet_extension_delete_notification_account_deleted")):l==="removeWallet"&&N.success(o("wallet_editwallet_toast_delete_wallet_success")),Y(g)}}catch(z){if(L(!1),Me(z))return;W(o("wallet_set_password_errortip_password_wrong"))}},[m,n,g,l]),{open:Se}=ce(),D=(0,e.useMemo)(()=>{switch(B){case X:return!0;default:return!1}},[B]);return e.default.createElement("div",{className:"verify_password_page__wrapper main-container",onKeyDown:c=>{c.keyCode===$e&&I()}},e.default.createElement(me,{bordered:!1,closeable:["removeWallet"].includes(l),onBack:v}),e.default.createElement("div",{className:"verify-password-page"},D?e.default.createElement(e.default.Fragment,null,e.default.createElement(b.FlexBox,{className:p.guard,direction:b.DIRECTION.vertical},e.default.createElement(i.Text,{strong:700,className:p.title},o("wallet_extension_security_header_backup_seed_phrase")),e.default.createElement(i.Text,{type:i.TYPE.secondary,className:p.subTitle},o("wallet_extension_security_desc_seed_phrase_leak")))):e.default.createElement("h2",{className:(0,F.default)("verify-password-page__header",{[p.guardHeaderClass]:T})},o("wallet_extension_tgsync_current_password_verify")),e.default.createElement("div",{className:`verify-password-page__input ${(0,F.default)(p.inputClass,{[p.guardInputClass]:T})}`},E?e.default.createElement(le,{className:p.unlockTrigger,onPass:async c=>{U.current=c,await I()},onCancel:Ae}):e.default.createElement(pe,{elementName:"v"},e.default.createElement(C.Password,{autoFocus:!0,value:g,autoComplete:"off",onChange:Oe,placeholder:o("wallet_extension_tg_enter_password",{},{useBr:!1}),size:C.SIZE.xl,error:V,errorType:C.TIP_TYPE.always,inputClassName:"verify-password-page__input__core",label:D?o("wallet_set_password_maintitle_enter_password"):""}))),E&&G()!==R?e.default.createElement(i.Text,{className:p.forgot,align:i.ALIGN.center,size:i.SIZE.xs,type:i.TYPE.secondary,onClick:()=>{Se()}},o("wallet_extension_biometrics_dialog_title_cant_unlock")):e.default.createElement(Ee,{className:E?p.forgot:p.forgotInput}),e.default.createElement(oe.FooterActions,{usePortal:!0,renderNative:!0,buttonGroup:[{loading:Le,onClick:I,size:f.SIZE.lg,visible:!E,type:f.TYPE.highlight,category:f.CATEGORY.fill,disabled:!g||g?.length<6||!!V,btnText:o("wallet_set_password_btn_confirm")}]}),e.default.createElement(he,{visible:Ie,confirm:Y})))};export{we as a,Te as b,Ee as c,Tr as d};

window.inOKXExtension = true;
window.inMiniApp = false;
window.ASSETS_BUILD_TYPE = "publish";

//# sourceMappingURL=chunk-Y2TZQZGL.js.map
