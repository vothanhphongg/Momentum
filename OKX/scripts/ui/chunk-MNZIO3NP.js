import{a as q}from"./chunk-52XLG23J.js";import{a as me,b as fe,d as Ce,g as E}from"./chunk-G4AVWXHJ.js";import{a as Y,b as v,c as le}from"./chunk-NTQ2YVDA.js";import{c as Z,d as $}from"./chunk-7SRLIN7D.js";import{g as X}from"./chunk-IRMYAC6R.js";import{a as J}from"./chunk-Y2TPPS4H.js";import{d as _}from"./chunk-I3CPAVOC.js";import{o as H}from"./chunk-5QMHGZLF.js";import{Aa as ie,Ea as ae,Fa as k,Ga as z,Gb as ue,ec as G,k as se}from"./chunk-HPWCPLRR.js";import{I as S,J as Q,Wc as ce,_c as Ne,ha as V,jc as te,pc as oe,rc as Be}from"./chunk-TM67VPZU.js";import{R as re,o as M,t as j}from"./chunk-UWJLNJLY.js";import{H as U,L as ne,ra as Ae,y as O}from"./chunk-XDY6V34Y.js";import{b as K}from"./chunk-JWYCKY2V.js";import{f as T,o as P,q as b}from"./chunk-6KXF36WM.js";P();b();var R=T(K()),C=T(H());Ae();re();P();b();var pe=T(K()),ye=T(G());V();function de(){let e=v(),n=(0,ye.useDispatch)();return(0,pe.useCallback)(async t=>{let r=await n(me(t)),o={};return r&&Object.entries(r).forEach(([s,c])=>{let a=[];c.forEach(i=>{let l;"childrenCoin"in i&&i.childrenCoin?.length&&(l=i.childrenCoin?.map(f=>({...f,currencyAmount:S(f.currencyAmountUSD,e.usdToThisRate)}))),a.push({...i,childrenCoin:l,currencyAmount:S(i.currencyAmountUSD,e.usdToThisRate)})}),o[s]=a}),o},[e.usdToThisRate,n])}P();b();var he=T(K()),ge=T(G()),F=T(H());V();var I=()=>{let e=(0,ge.useSelector)(ue),n=E();return(0,F.useCreation)(()=>{let t={},{symbol:r}=e;return Object.keys(n).forEach(o=>{t[o]={currencySymbol:r,usdPrice:n?.[o]?.coinToUSDRate,currencyPrice:S(n?.[o]?.coinToUSDRate,e?.usdToThisRate),priceChangePercent24h:n?.[o]?.coinPriceChangePercent24h}}),t},[n,e])},Pe=e=>{let n=I(),t=v(),{data:r,run:o}=(0,F.useRequest)(k,{manual:!0,ready:!0,retryCount:3,staleTime:36e5,cacheTime:864e5});return(0,he.useEffect)(()=>{!n[e]&&ie(e)&&o(+e)},[n,e]),(0,F.useCreation)(()=>{let s=n[e];if(s)return s;if(r&&t){let{currencyAmount:c,priceChangePercent24h:a}=r;return{currencySymbol:t.symbol,usdPrice:c,currencyPrice:S(c,t.usdToThisRate),priceChangePercent24h:a}}return null},[n,e,t,r])};P();b();var be=T(G());function ee(){return(0,be.useSelector)(se)}Be();Ne();V();var Me=e=>!!e&&!Number.isNaN(e),W=(e={})=>{let n=q(),t=Y(),r=ee(),o=I(),s=E(),c=(0,C.useLatest)(n),a=(0,C.useLatest)(o),i=(0,C.useLatest)(s),{withPrice:l=!1,withPriceChangePercent24h:f=!1}=e||{},[p,d]=(0,R.useState)(void 0),{runAsync:g}=(0,C.useRequest)(z,{manual:!0,cacheKey:p,retryCount:3,staleTime:36e5,cacheTime:864e5});return(0,R.useCallback)(async(h,u)=>{if(h===0||!r||Number.isNaN(h))return null;let y;if(typeof h<"u")y=c?.current?.[h];else if(u){let m=Object.values(n);if(u.aggregation&&u.symbol)return t[u.symbol]?{...t[u.symbol][0],childrenCoin:t[u.symbol]}:null;if($(u)){let N=j(m,u);N.length>0&&(y=N[0])}}if(!y&&h!==0){let m;typeof h<"u"&&!Number.isNaN(h)?m={coinId:h}:u&&(m=!U(u)&&ae(u)?u:null),m&&(d(Z(m)),y=await g(m))}if(!y)return null;let A;if((l||f)&&!c?.current?.[h]&&(A=await k(y.coinId)),l){let{currencySymbol:m,usdPrice:B,currencyPrice:N}=a?.current?.[h]??A??{};y={...y,currencySymbol:m,usdPrice:B,currencyPrice:N}}if(f){let m=i?.current?.[h]?.coinPriceChangePercent24h??A?.priceChangePercent24h;y={...y,priceChangePercent24h:m}}return y},[l,f,n,t,g,r])},Re=(e,n,t)=>(0,C.useCreation)(()=>{let r;if(!(t||e===0)&&(typeof e<"u"&&!Number.isNaN(e)?r={coinId:e}:r=U(n)?null:n,r))return Z(r)},[e,n,t]),w=(e,n={},t)=>{let r=Y(),o=q(),s=ee(),{withPrice:c,withPriceChangePercent24h:a}=n,i=le(t),l=[e,o,r,i,s],f=[],p=(0,C.useCreation)(()=>{let m;if(e===0||!s||Number.isNaN(e))return null;if(typeof e<"u")m=o?.[e];else if(i){let B=Object.values(o);if(i.aggregation&&i.symbol)return r[i.symbol]?{...r[i.symbol][0],childrenCoin:r[i.symbol]}:null;if($(i)){let D=j(B,i);D.length>0&&(m=D[0])}}return m||null},l),d=!!p,g=Re(e,i,d),{data:h,run:u}=(0,C.useRequest)(z,{manual:!0,ready:!0,cacheKey:g,retryCount:3,staleTime:36e5,cacheTime:864e5});(0,R.useEffect)(()=>{if(!d&&s&&!!g){let m=Me(e)?{coinId:e}:i;u(m)}},[d,s,g,e,i]);let y=p||h,A=Pe(c||a?y?.coinId:null);return f.push(y,A),(0,C.useCreation)(()=>{if(!y)return null;let m=y;if(c&&A){let{currencySymbol:B,usdPrice:N,currencyPrice:D}=A;m={...m,currencySymbol:B,usdPrice:N,currencyPrice:D}}if(a){let{priceChangePercent24h:B}=A;m={...m,priceChangePercent24h:B}}return m},f)},Se=e=>{let n=W(e),t=X(),r=Ce(),o=de();return(0,C.useMemoizedFn)(async(s,c)=>{let a=await n(s);if(!a)return null;let i;c&&c!==t?i=(await o({walletIds:[c],coinId:s,chainId:a.chainId,flatten:!0}))[c]??[]:i=r;let{coinAmountInt:l="0",currencyAmount:f="0",currencyAmountUSD:p="0"}=O(i,d=>d?.coinId===s)||{};return{...a,coinAmountInt:l,currencyAmount:f,currencyAmountUSD:p,coinAmount:Q(l,10**a?.decimals)}},[r,t,n])};function we(e,{key:n,coinId:t,addressType:r,localType:o}){return O(e,s=>{let c;if(n?c=s.key===n:c=s.coinId===t,r){let a=ce[oe(o)]?.[r];c=c&&a===s?.addressType}return c})}var xe=(e,n,t)=>{let{addressType:r,key:o,withBalanceStatus:s}=t||{},c=w(e,t,o?{key:o}:void 0),a=X(),i=n||a,l=fe(i,{withBalanceStatus:s}),f=!1,p;s?(p=l?.balance?.coins,f=!l?.loading):(p=l?.coins,f=!!l),p=p||[];let d=(0,C.useCreation)(()=>we(p,{key:o,coinId:e,addressType:r,localType:c?.localType}),[p,i,e,r,o,c?.localType]),{coinAmountInt:g,currencyAmount:h}=d||{};return(0,C.useCreation)(()=>{if(!c)return null;let u={...c,coinAmountInt:g,currencyAmount:h};return s&&(u.requestBalance=l?.request,u.isBalanceLoading=!f,u.isBalanceLoadError=!!l?.error),ne(g)?f?(u.coinAmountInt="0",u.coinAmount="0",u.currencyAmount="0",u.currencyAmountUSD="0",u):(u.coinAmount=void 0,u):(u.coinAmount=Q(g,10**c.decimals),u)},[c,g,f,l,s])},Fe=(e,n)=>{let t=w(e,n),r=w(t?.baseCoinId,n);return[t,r||t]},Te=e=>{let n=W(e);return(0,C.useMemoizedFn)(async t=>{let r=await n(t),o=await n(r?.baseCoinId);return[r,o||r]},[n])};var We=(e={})=>{let n=Te(e);return(0,C.useMemoizedFn)(async t=>{let[,r]=await n(t),o=r?.coinId;return te.indexOf(o)!==-1},[n])},dn=(e,n={})=>{let t=We(n),[r,o]=(0,R.useState)(!1);return(0,C.useAsyncEffect)(async()=>{let s=await t(e);o(s)},[t]),r};P();b();P();b();re();var L=T(H());var De=(e={})=>{let{currencyId:n,formatted:t=!0,useApproximate:r}=e||{},o=J(n),{symbol:s,usdToThisRate:c}=o,a=W({withPrice:!0});return(0,L.useMemoizedFn)(async(i,l)=>{let f=await a(i),p=M.div(l,10**f?.decimals),d=M.mul(f?.usdPrice,c),g=M.mul(p,d);return t?_(g,{useApproximate:r,symbol:s}):g},[s,t,a,c,r])},ke=(e,n,t={})=>{let{currencyId:r,formatted:o=!0,useApproximate:s,useMinPrecision:c=!0}=t||{},a=w(e,{withPrice:!0}),{usdToThisRate:i,symbol:l}=J(r);return(0,L.useCreation)(()=>{if(!a||!a?.usdPrice)return null;let f=c?M.div(n,10**a?.decimals):n,p=M.mul(a?.usdPrice,i),d=M.mul(f,p);return o?_(d,{useApproximate:s,symbol:l}):d},[l,o,i,n,s,a?.usdPrice,a?.decimals])};export{de as a,ee as b,W as c,w as d,Se as e,xe as f,Fe as g,dn as h,De as i,ke as j};

window.inOKXExtension = true;
window.inMiniApp = false;
window.ASSETS_BUILD_TYPE = "publish";

//# sourceMappingURL=chunk-MNZIO3NP.js.map
