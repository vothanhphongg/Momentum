import{c as Y,i as ee}from"./chunk-G4AVWXHJ.js";import{a as Q}from"./chunk-MBHGLWZJ.js";import{a as Z}from"./chunk-K6STDTUY.js";import{a as J}from"./chunk-A57OTXBP.js";import{a as z}from"./chunk-7SRLIN7D.js";import{a as x,b as V}from"./chunk-MRB2XFLQ.js";import{b as E}from"./chunk-65AJJVJY.js";import{a as X}from"./chunk-Q4YTGP2G.js";import{o as Ce}from"./chunk-5QMHGZLF.js";import{ec as Ie}from"./chunk-HPWCPLRR.js";import{a as fe}from"./chunk-ON6S2DB7.js";import{k as q,l as me}from"./chunk-3DZ7WRLL.js";import{Ia as K,Na as he,ya as $,za as ge}from"./chunk-TM67VPZU.js";import{f as j,m as y,ma as G,ra as le}from"./chunk-XDY6V34Y.js";import{b as H}from"./chunk-JWYCKY2V.js";import{f as T,o as l,q as g}from"./chunk-6KXF36WM.js";l();g();l();g();var Re="content_script_message",Te={goToDexSwapMemeMode:"goToDexSwapMemeMode",notifyRedirect:"notifyRedirect"},v="redirect_param_",te="redirect_pathname",re="redirect_search_params";var Ee=c=>Object.entries(c).map(([n,u])=>`${n}=${encodeURIComponent(u)}`).join("&"),ke=c=>{let n=new URLSearchParams(c),u=n.get(te),p=n.get(re),i={};return p&&p.split("&").filter(o=>o.includes(v)).forEach(o=>{let[d,m]=o.split("="),b=d.replace(v,"");i[b]=decodeURIComponent(m)}),{redirectPathname:u,redirectSearchParams:i}};l();g();var ne=T(H()),D=T(fe()),Se=()=>{let c=(0,D.useHistory)(),n=(0,D.useLocation)();return(0,ne.useCallback)((p,i={})=>{let{overrideCurrentPath:o=!1,clearSearchParams:d=!1,preserveState:m=!0,replaceInsteadOfPush:b=!1,removeExistingSearchKeys:R=[],newSearchParams:M=""}=i,{search:P}=n,A=new URLSearchParams(P);R&&R.forEach(_=>{A.delete(_)}),c.replace({pathname:o||n.pathname,search:d?"":A.toString(),state:m?n.state:null}),c[b?"replace":"push"]({pathname:p,search:M||""})},[c,n])},xe=Se;l();g();me();var be={light:"light",dark:"dark"},U=q({name:"activityBanners",initialState:{bannerList:[]},reducers:{setBannerList:(c,n)=>{let{allData:u,closedBanners:p,theme:i}=n.payload,o=u;p?.length>0&&(o=u.filter(d=>!p.find(m=>m===d.id))),c.bannerList=o.map(d=>({...d,img:i===be.dark?d.nightLogo:d.dayLogo}))}}}),{setBannerList:Le}=U.actions,Be=U.reducer,Ne=c=>c[U.name].bannerList;l();g();var S=T(H()),oe=T(Ie()),s=T(Ce());le();ge();he();var F=300,nt=()=>{let c=J(),n=(0,oe.useDispatch)(),u=Y(c),p=Z(),i=(0,S.useRef)({}),o=(0,S.useRef)({}),d=(0,S.useRef)({}),{data:m,set:b}=Q(X.coinTickers),R=ee();(0,S.useEffect)(()=>{n(z(R))},[n,R]);let M=a=>{b({...m,...a})},P=(0,s.useMemoizedFn)(async a=>{let C=y(a,F),r=[];try{(await Promise.all(C.map(t=>{let L=t.filter(f=>d.current[f]),h={coinIds:t,aggregationCoinIdList:L},I={headers:{currency:"usd"}};return K($.postMarketUrl,h,I)})))?.forEach(t=>{Array.isArray(t?.data)&&(r=r.concat(t.data))})}catch{j()}r.forEach(e=>{e?.coinId&&(o.current[e.coinId]={coinToUSDRate:e?.currencyAmount,coinPriceChangePercent24h:e?.priceChangePercent24h,priceCoinId:e?.priceCoinId,anchorStatus:e?.anchorStatus??null})}),M(o.current)}),{needFetchCoinIds:A,needFetchData:O}=(0,s.useCreation)(()=>{if(u.length||p.length){let a=u.concat(p).filter(e=>Boolean(e?.coinId));return G(a,"coinId").reduce((e,t)=>(e.needFetchCoinIds.push(t.coinId),e.needFetchData.push({coinId:t.coinId,baseCoinId:t?.baseCoinId,chainIndex:t?.chainId,tokenAddress:t?.address,aggregation:t?.aggregation}),e),{needFetchCoinIds:[],needFetchData:[]})}return{needFetchCoinIds:[],needFetchData:[]}},[u,p]),_=(0,s.useMemoizedFn)(a=>{if(!a?.length)return;let{coinIdToInstIdMap:C,coinIdAggregationMap:r}=a.reduce((h,I)=>{let{coinIdToInstIdMap:f,coinIdAggregationMap:B}=h,{coinId:N,baseCoinId:de,chainIndex:W,tokenAddress:ue,aggregation:pe}=I,w="";return de===0?w=`${W}`:w=`${W}-${ue}`,f[N]=w,B[N]=pe,{coinIdToInstIdMap:f,coinIdAggregationMap:B}},{coinIdToInstIdMap:{},coinIdAggregationMap:{}});d.current=r;let e=[],t=Object.entries(C).reduce((h,[I,f])=>(i.current[I]||(i.current[I]=f,e.push(I),h.push({channel:E,instId:f})),h),[]);y(t,F).forEach(h=>{x.sendChannel({op:"subscribe",args:h})}),e.length&&P(e)}),{run:ae}=(0,s.useDebounceFn)(_,{wait:200}),{run:se}=(0,s.useDebounceFn)(()=>{M(o.current)},{wait:1e3}),ce=(0,s.useMemoizedFn)(()=>{P(Object.keys(i.current))}),ie=(0,s.useMemoizedFn)(a=>{if(!a||!Array.isArray(a?.data))return;let{data:C}=a,r=C[0];if(r?.coinId){let e=r.coinId,t=o.current[e];o.current[e]={...t,coinToUSDRate:r.price,coinPriceChangePercent24h:r.priceChangePercent24h},se()}});V(E,{onError:ce,onSuccess:ie,pollingInterval:30*1e3}),(0,s.useDeepCompareEffect)(()=>{ae(O)},[A]),(0,s.useUnmount)(()=>{let a=Object.values(i.current).map(r=>({channel:E,instId:r}));y(a,F).forEach(r=>{x.sendChannel({op:"unsubscribe",args:r})}),i.current={}})};export{Le as a,Be as b,Ne as c,Re as d,Te as e,Ee as f,ke as g,xe as h,nt as i};

window.inOKXExtension = true;
window.inMiniApp = false;
window.ASSETS_BUILD_TYPE = "publish";

//# sourceMappingURL=chunk-UGT3PL2G.js.map
