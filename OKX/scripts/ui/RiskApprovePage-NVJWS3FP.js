import{a as V}from"./chunk-TWODQDWW.js";import{a as G,b as H}from"./chunk-4GZAV2XC.js";import{a as S}from"./chunk-L5DNXFMU.js";import"./chunk-RL43YSUD.js";import{a as K,b as O}from"./chunk-DSWVONUM.js";import"./chunk-H5H4QFZG.js";import"./chunk-3USSVI5T.js";import{c as N}from"./chunk-T2F6X5K7.js";import{c as j}from"./chunk-X3FPMAMT.js";import"./chunk-MRB2XFLQ.js";import"./chunk-65AJJVJY.js";import"./chunk-PDC447BO.js";import{a as F}from"./chunk-PTD7UCOR.js";import"./chunk-ETJEH7T4.js";import{a as C}from"./chunk-V3IFYKWM.js";import"./chunk-EWTTD4DL.js";import{ub as I}from"./chunk-YALUYHLV.js";import"./chunk-I3CPAVOC.js";import"./chunk-ARWSGU73.js";import"./chunk-CZ2ZBAZV.js";import{o as se}from"./chunk-5QMHGZLF.js";import{ec as ie}from"./chunk-HPWCPLRR.js";import"./chunk-TSTPZ3JM.js";import"./chunk-D2LKUI4F.js";import{a as le}from"./chunk-ON6S2DB7.js";import"./chunk-ANIUN6US.js";import"./chunk-3DZ7WRLL.js";import"./chunk-DEOJU4Z3.js";import"./chunk-XV444F26.js";import"./chunk-N2BCRNDB.js";import"./chunk-JGEHAFTO.js";import{g as R}from"./chunk-LNOPECCQ.js";import"./chunk-CB7FOZNP.js";import{c as m}from"./chunk-43VURGIT.js";import"./chunk-TM67VPZU.js";import"./chunk-VW6OQNWT.js";import{G as h,e as E}from"./chunk-PUSMMCUD.js";import{E as a,R as ne,m as w}from"./chunk-UWJLNJLY.js";import"./chunk-VRY2ADKE.js";import"./chunk-5U7FO2PW.js";import"./chunk-PDUOSATP.js";import"./chunk-XDY6V34Y.js";import"./chunk-YJFNO57I.js";import"./chunk-DZ6CTC22.js";import{ea as u}from"./chunk-JT3LNHPY.js";import"./chunk-47UWF72W.js";import{b as re}from"./chunk-JWYCKY2V.js";import"./chunk-G2266BV2.js";import"./chunk-L4PAIYPH.js";import"./chunk-UT7LJPKF.js";import"./chunk-AFZ6A2B3.js";import"./chunk-VVPY7ZA7.js";import"./chunk-KUW5VATV.js";import"./chunk-BNAVWOJ2.js";import"./chunk-IG2Q5ALZ.js";import"./chunk-WOMUNWBT.js";import{a as ae}from"./chunk-7U3DN5ZD.js";import"./chunk-QYVQBXDG.js";import"./chunk-7D4PUIEN.js";import"./chunk-7QO4TZYQ.js";import"./chunk-FF4LY6PE.js";import"./chunk-76KCDJDG.js";import"./chunk-YDUDQP2P.js";import"./chunk-PGPFV4JQ.js";import"./chunk-MIBHDVGP.js";import"./chunk-7VFUX7IX.js";import"./chunk-XLF4LAH2.js";import"./chunk-ONKZ57T6.js";import"./chunk-ZC7Q7LCH.js";import{f as k,o as _,q as v}from"./chunk-6KXF36WM.js";_();v();var e=k(re()),T=k(ie()),z=k(le()),M=k(se()),b=k(ae());ne();_();v();var l={"retina-border-basic":"_retina-border-basic_11rve_1",retinaBorderBasic:"_retina-border-basic_11rve_1",container:"_container_11rve_29","img-wrapper":"_img-wrapper_11rve_32",imgWrapper:"_img-wrapper_11rve_32",pic:"_pic_11rve_38",img:"_img_11rve_32",text:"_text_11rve_46","risk-addr":"_risk-addr_11rve_57",riskAddr:"_risk-addr_11rve_57"};var W=(s,p)=>s.every(d=>d.status===p),$=s=>{let p=W(s,2),d=W(s,3);return{loading:p||d,loadingTextKey:p?"wallet_extension_approval_btn_revoking":"wallet_extension_approval_btn_approving"}},ce=()=>{let s=(0,z.useHistory)(),p=R({light:"/cdn/assets/imgs/253/4AD3248AD93516C7.png",dark:"/cdn/assets/imgs/253/4E618AEF79838D4F.png"}),d=(0,T.useDispatch)(),L=K(),{loading:P,run:x,error:Y}=(0,M.useRequest)(async()=>await L(),{manual:!0}),i=S(),g=(0,T.useSelector)(j);(0,e.useEffect)(()=>{!g&&x()},[g,x]),(0,e.useEffect)(()=>{g&&!i.length&&s.goBack()},[g,i.length]);let Z=i?.length||0;O();let B=(0,e.useCallback)(async({tokens:t,chainId:r})=>{if((0,b.isEmpty)(t))return[];let o=t.filter(c=>c.status===1).map(async({coinId:c,tokenAddress:A,approvalAddress:y,permit2Address:ee,address:te,approvalNum:oe})=>await V({address:te,chainId:r,tokenAddress:A,approvalAddress:y,permit2Address:ee,coinId:c,approvalNum:oe}));return await Promise.all(o)},[]),q=async()=>{let t=i.map(async o=>await B({tokens:o.tokens,chainId:o.chainId}));return(await Promise.all(t))?.flat()||[]},D=(0,e.useCallback)(t=>{if(t.some(o=>(0,b.isEmpty)(o))){h.error({title:a("wallet_extension_approval_toast_initiate_fail"),duration:3,showClose:!0,placement:h.DIRECTION.top});return}d(N({type:"approve",data:t})),s.push(`${I}?type=approve`)},[]),J=async({tokens:t,chainId:r})=>{let n=await B({tokens:t,chainId:r});D(n)},{revokeAllBtnLoading:U,revokeAllBtnLoadingTextKey:X}=(0,e.useMemo)(()=>{let t=i.map(o=>o?.tokens||[]).flat(),{loading:r,loadingTextKey:n}=$(t);return{revokeAllBtnLoading:r,revokeAllBtnLoadingTextKey:n}},[i]),Q=async()=>{let t=await q();D(t)};return e.default.createElement(m.Container,{loading:!1,className:l.container},e.default.createElement(F,{bordered:!1,closeable:!1}),e.default.createElement(H,{isError:!!Y,isLoading:P,reload:x},e.default.createElement(e.default.Fragment,null,e.default.createElement(m.Box,{className:l.imgWrapper},e.default.createElement(E,{src:p,pictureClassName:l.pic,className:l.img})),e.default.createElement(m.Box,{className:l.text},a("wallet_extension_approval_header_num_risky",{num:w(Z,{needZero:!1})})),e.default.createElement(m.Box,{className:l.riskAddr},a("wallet_extension_approval_label_malicious")),e.default.createElement(m.Box,null,i.map(t=>{let{projectIcon:r,projectName:n,network:o,approvalAddress:f,chainId:c}=t;if(!t?.tokens?.length)return null;let{loading:A,loadingTextKey:y}=$(t.tokens);return e.default.createElement(G,{title:n,desc:o,icon:r,btnText:a("wallet_extension_approval_btn_revoke"),btnLoading:A,key:`${f}-${c}`,btnLoadingText:a(y),btnClick:async()=>{await J({tokens:t.tokens,chainId:c})}})})),e.default.createElement(C.FooterActions,{zIndex:"100000"},e.default.createElement(u,{loading:U,loadingText:a(X),category:u.CATEGORY.fill,type:u.TYPE.highlight,size:u.SIZE.lg,onClick:Q},a("wallet_extension_approval_btn_revoke_all"))))))},Fe=ce;export{Fe as default};

window.inOKXExtension = true;
window.inMiniApp = false;
window.ASSETS_BUILD_TYPE = "publish";

//# sourceMappingURL=RiskApprovePage-NVJWS3FP.js.map
