import{A as d,H as f,ia as c,ja as y,z as p}from"./chunk-TM67VPZU.js";import{o as a,p as t,q as o}from"./chunk-6KXF36WM.js";a();o();y();f();function l(e=64){return globalThis.crypto.getRandomValues(new Uint8Array(e))}async function h(){return!!(navigator.credentials&&!!navigator.credentials.create&&c()!==d&&c()!==p)}async function m(){if(PublicKeyCredential&&!!PublicKeyCredential.isUserVerifyingPlatformAuthenticatorAvailable)try{if(await PublicKeyCredential.isUserVerifyingPlatformAuthenticatorAvailable())return!0}catch{return!1}return!1}async function b(){let e=l(),s={publicKey:{challenge:l(),rp:{name:"OKX-Wallet-Extension",id:window.location.hostname},user:{id:e,name:"OKX-Wallet-Extension",displayName:"OKX-Wallet-Extension"},pubKeyCredParams:[{type:"public-key",alg:-7},{type:"public-key",alg:-257},{type:"public-key",alg:-8}],authenticatorSelection:{requireResidentKey:!0,userVerification:"preferred"},timeout:2*60*1e3}},r=await navigator.credentials.create(s);if(!r)throw new Error("Missing credential");let n=t.Buffer.from(e).toString("hex"),i=t.Buffer.from(r.rawId).toString("hex");return{password:n,credentialId:i,credential:r}}async function x({credential:e,password:s}){let r=e.response&&e.response.getTransports&&e.response.getTransports(),n={publicKey:{challenge:l(),allowCredentials:[{id:e.rawId,type:"public-key",transports:r}],userVerification:"required"}},i=await navigator.credentials.get(n);if(!i)throw new Error("Missing credential");let u=i.response;if(!u.userHandle)throw new Error("Missing userHandle");if(!t.Buffer.from(s,"hex").equals(t.Buffer.from(u.userHandle)))throw new Error("Missing password");return!0}async function A(e){let s={publicKey:{challenge:l(),allowCredentials:[{id:t.Buffer.from(e,"hex"),type:"public-key"}],userVerification:"required"}},r=await navigator.credentials.get(s);if(!r)throw new Error("Auth error.");let n=r.response;if(!n.userHandle)throw new Error("Lost password.");return{password:t.Buffer.from(n.userHandle).toString("hex")}}a();o();export{h as a,m as b,b as c,x as d,A as e};

window.inOKXExtension = true;
window.inMiniApp = false;
window.ASSETS_BUILD_TYPE = "publish";

//# sourceMappingURL=chunk-3NWEQ7OH.js.map
