import{a as $,b as G}from"./chunk-HTLOGWI7.js";import{a as x}from"./chunk-6SEP5B7P.js";import{c as L,d as v}from"./chunk-FHKOH5E6.js";import{b as F,c as D}from"./chunk-NTQ2YVDA.js";import{b as M}from"./chunk-KKG4PJ6O.js";import{e as b,h as Y}from"./chunk-IRMYAC6R.js";import{d as ae}from"./chunk-PDC447BO.js";import{b as R,c as _}from"./chunk-Y2TPPS4H.js";import{o as Be}from"./chunk-5QMHGZLF.js";import{Gb as se,ec as ce}from"./chunk-HPWCPLRR.js";import{a as Ne}from"./chunk-TSTPZ3JM.js";import{k as oe,l as be}from"./chunk-3DZ7WRLL.js";import{d as P,f as ke}from"./chunk-DEOJU4Z3.js";import{$ as ne,I as U,J as te,K as w,Na as xe,Sc as Me,ad as re,ha as q,rd as ge,sc as I,za as we}from"./chunk-TM67VPZU.js";import{C as S,I as V,q as ee,ra as K}from"./chunk-XDY6V34Y.js";import{b as k}from"./chunk-JWYCKY2V.js";import{f as C,o as l,q as m}from"./chunk-6KXF36WM.js";l();m();l();m();var ie=C(k());var Se=e=>{let[o]=_(R.showNftAmount),t=Y(e),n=L(),s=F(),r=D(s);return(0,ie.useMemo)(()=>{let{walletAccountsWidthBalance:a}=v({walletAccounts:[t],showNftAmount:o,rpcData:null,selectedCurrency:r,assetsMap:n});return a[0]},[t,o,r,n])},Pe=Se;l();m();var X=C(k()),ye=C(ce());K();l();m();var B=C(k()),h=C(ce()),E=C(Be()),Q=C(Ne());K();l();m();var le=C(k());l();m();var z={},Ie=async e=>{let o=(await import("./web3.min-GSCZZNBL.js")).default,t=new o(new o.providers.HttpProvider(e));return z[e]=t,t},ue=async e=>z[e]?z[e]:Ie(e);var g=(e="",o=null)=>{let{extensionConfig:t}=x("rpc_info"),n=o||t;return(0,le.useCallback)(async()=>{let s=e||n?.rpcUrl;return s?await ue(s):{}},[e,n])};l();m();var me=C(k());function O(e,o,t){let n=me.default.useRef({});return(!("value"in n.current)||t(n.current.condition,o))&&(n.current.value=e(),n.current.condition=o),n.current.value}ge();Me();we();xe();q();l();m();q();var _e=6,pe=(e,o=_e)=>{if(!Number(e))return"0";let t=e?.toString();return(e.split(".")[1]||"")?.length>o?ne(t,o&&Number(o)):t},fe=(e,o)=>{let{rpcUrl:t,chainId:n,account:s,existAccounts:r,isDeleted:a}=o;return Array.isArray(e)?e.filter(i=>{let c=!0;return n&&(c=c&&i.chainId===n),s&&(c=c&&i.account===s),Array.isArray(r)&&!!r?.length&&(c=c&&r?.includes(i.account)),a!==void 0&&(c=c&&(i.isDeleted||!1)===a),i.address||(c=c&&i.rpcUrl===t),c}):[]},de=(e,o={})=>{let{symbol:t,usdToThisRate:n,chainTokenPrice:s,chainTokenBalance:r}=o;return Array.isArray(e)?e.map(a=>{let i,c,{chainId:u,decimals:d}=a,f=t;a.address?(i=s?.[u]?.[a.address]||0,c=r?.[a.account]?.[u]?.[a.address]||0):(i=s?.[u]?.price||0,c=r?.[a.account]?.[u]?.balance||0);let p=pe(c&&te(c,10**d)),T=pe(U(p,U(i,n)));return{price:i,balance:p,balanceInt:c,...a,moneySymbol:f,marketValue:T}}):[]};l();m();be();ke();l();m();K();l();m();var Ae="rpc",N={MANAGE_NET:"manageNet",EVM:"evm"},he={[N.MANAGE_NET]:"ManageNet",[N.EVM]:"Evm"};var Ce=ee((e,o)=>{let t=he[e];if(!t)throw new Error("rpc type must in maps");if(!(typeof o=="string"&&/^[0-9a-zA-Z]+$/g.test(o)))throw new Error("scope name is invalid");return`${Ae}${t}${o}`}),bt=Ce(N.MANAGE_NET),Te=Ce(N.EVM),Mt={"MNEMONIC WALLET":"seed_phrase","PRIVATE KEY WALLET":"private_key","MPC WALLET":"mpc","HARDWARE WALLET":"hardware"};var Fe="Token",De=Te(Fe),Le={chainTokens:[],chainTokenPrice:{},chainTokenBalance:{}},H=e=>e.metamask.rpcEvmChainTokens||[],Ee=e=>e.metamask.rpcEvmChainTokenBalance||{},ve=oe({name:De,initialState:Le,reducers:{}}),{reducer:Oe}=ve,We=e=>async()=>{await P().addChainToken(e)},Z=e=>async()=>{await P().updateChainToken(e)},J=e=>async()=>{await P().updateChainTokenBalance(e)},Rt=Oe;var W=(e,o,t=!0,n=null)=>{let{extensionConfig:s}=x("rpc_info"),r=n||s,{chainId:a,rpcUrl:i}=r,c=(0,h.useSelector)(H),u=(0,h.useSelector)(Ee),{symbol:d,usdToThisRate:f}=(0,h.useSelector)(se),p=$(),T=G(void 0,I),y=(0,B.useMemo)(()=>fe(c,{chainId:a,rpcUrl:i,existAccounts:T,account:t?p:void 0,isDeleted:o?void 0:!1}),[a,p,T,c]);return(0,B.useMemo)(()=>e?y:de(y,{symbol:d,usdToThisRate:f,chainTokenBalance:u}),[d,y,f,u,e])},tn=(e,o,t)=>{let n=W(o,void 0,void 0,t);return(0,B.useMemo)(()=>n.find(s=>s.address===(e||void 0))||{},[e,n])};var Ve=(e,o)=>{let t=g(e,o);return(0,E.useMemoizedFn)(async n=>{let s=await t(),r=new s.eth.Contract(Q.default,n),a=await r.methods.symbol().call(),i=await r.methods.decimals().call();return{name:await r.methods.name().call(),symbol:a,decimals:i}},[t])},Ke=e=>{let o=g(void 0,e),t=M();return(0,E.useMemoizedFn)(async(n,s,r)=>{let a,i=r||await o(),c=s||t;return n?a=await new i.eth.Contract(Q.default,n).methods.balanceOf(c).call():a=await i.eth.getBalance(c,"latest"),a},[o,t])};var nn=()=>{let e=g(),o=(0,h.useDispatch)();return(0,E.useMemoizedFn)(async({chainId:t,injectWeb3:n,wallets:s=[]})=>{let r=n||await e(),a=new r.BatchRequest;s.forEach(i=>{a.add(r.eth.getBalance.request(i,"latest",(c,u)=>{c||o(J({chainId:t,balance:u,account:i}))}))}),a.execute()})},Ue=()=>{let e=(0,h.useDispatch)(),o=M(),t=Ke();return(0,E.useMemoizedFn)(async({chainId:n,address:s,injectAccount:r,injectWeb3:a})=>{let i=await t(s,r,a);return e(J({chainId:n,balance:i,address:s,account:r||o})),!0},[t,o])},on=e=>{let o=M(),{extensionConfig:t}=x("rpc_info"),n=e||t,{chainId:s}=n,r=W(!0,!1,!1,e);return O(()=>({chainId:s,chainTokens:r}),{chainId:s,account:o,needPollChainTokens:r},(a,i)=>!V(a,i))},qe=18,Ye=()=>{let e=(0,h.useDispatch)(),o=(0,h.useSelector)(H),t=M();return(0,E.useMemoizedFn)((n,s,r)=>{if(!n&&!t&&!r?.account)return!1;let{rpcUrl:a}=r,i=o.find(u=>{let d=u.chainId===n&&u.address===s&&u.account===(r?.account||t);return s||(d=d&&u.rpcUrl===a),d});if(i){if(i.isDeleted===!0){let u={...i,...r,chainId:n,address:s,isDeleted:!1};return e(Z(u)),!0}return!1}let c={chainId:n,address:s,isDeleted:!1,account:t,decimals:qe};return r&&typeof r=="object"&&Object.assign(c,r),e(We(c)),!0},[o,t])},rn=e=>{let o=g(e),t=Ye(),n=Ve(e),s=Ue();return async(r,a)=>{let i=await n(a);if(t(r,a,i)){let u=await o();await s(r,a,u)}}},$e=(e={})=>{let o=b(e);return O(()=>o.reduce((t,n)=>{if(n.keyringIdentityType===re.MNEMONIC)t.push(n);else{let s=n.walletIdentities.filter(r=>Boolean(r.account[I]));s.length&&t.push({...n,walletIdentities:s})}return t},[]),o,(t,n)=>!V(t,n))},sn=(e={})=>{let o=$e(e),t=W(!1,!1,!1);return(0,B.useMemo)(()=>{let n=S(t||[],"account");return o?.map(s=>{let r="",a=s.walletIdentities?.map(c=>{let u=c?.account?.[I],{balance:d,symbol:f}=n[u]?.filter(({address:p})=>!p)[0]||{};return r=f,{...c,balance:d,symbol:f}}),i=a.reduce((c,u)=>w(c,u.balance),0);return{...s,marketValue:i,marketValueSymbol:r,walletIdentities:a}})||[]},[t,o])},an=()=>{let e=(0,h.useDispatch)(),o=W(!0,!1,!1);return t=>{o?.filter(({chainId:n,rpcUrl:s,address:r})=>!r&&n===t.chainId&&s===t.rpcUrl)?.forEach(({chainId:n,account:s})=>{e(Z({chainId:n,account:s,...t}))})}};q();var Ge=e=>{let o=b(e),[t]=_(R.showNftAmount),n=F(),s=D(n),{isRpcMode:r}=(0,ye.useSelector)(ae),a=W(!1,!1,!1),i=S(a||[],"account"),c=L(),u=(0,X.useMemo)(()=>o.map(f=>{let{walletIdentities:p}=f,{walletAccountsWidthBalance:T,walletAsset:y,platformAsset:j}=v({walletAccounts:p,showNftAmount:t,rpcData:r?{chainTokensAccountMap:i}:null,selectedCurrency:s,assetsMap:c});return{...f,walletAsset:y,platformAsset:j,walletIdentities:T}}),[o,t,i,r,s,c]);return[(0,X.useMemo)(()=>u?.reduce((f,p)=>({walletAsset:w(f.walletAsset,p.walletAsset==="--"?"0":p.walletAsset),platformAsset:w(f.platformAsset,p.platformAsset==="--"?"0":p.platformAsset),rpcModeCoinSymbol:f.rpcModeCoinSymbol||p?.rpcModeCoinSymbol}),{walletAsset:"0",platformAsset:"0",rpcModeCoinSymbol:""}),[u]),u]},ze=Ge;export{Ie as a,ue as b,bt as c,Te as d,Mt as e,De as f,H as g,Z as h,J as i,Rt as j,Pe as k,g as l,O as m,W as n,tn as o,Ve as p,Ke as q,nn as r,Ue as s,on as t,Ye as u,rn as v,$e as w,sn as x,an as y,ze as z};

window.inOKXExtension = true;
window.inMiniApp = false;
window.ASSETS_BUILD_TYPE = "publish";

//# sourceMappingURL=chunk-YJQGXXOQ.js.map
