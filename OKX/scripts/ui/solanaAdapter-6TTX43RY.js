import{a as ee}from"./chunk-PQX3DFZY.js";import{c as M,d as S,g as B}from"./chunk-RTFE54S3.js";import"./chunk-GCQ4H2BA.js";import{a as F}from"./chunk-JGEHAFTO.js";import{l as P}from"./chunk-UVFOW4HH.js";import"./chunk-LNOPECCQ.js";import"./chunk-CB7FOZNP.js";import"./chunk-43VURGIT.js";import{Ia as w,Na as X,qb as N,rc as J,ya as R,za as Q}from"./chunk-TM67VPZU.js";import"./chunk-VW6OQNWT.js";import"./chunk-PUSMMCUD.js";import"./chunk-UWJLNJLY.js";import{a as $}from"./chunk-VRY2ADKE.js";import{ra as Y,y as C}from"./chunk-XDY6V34Y.js";import"./chunk-JT3LNHPY.js";import"./chunk-47UWF72W.js";import"./chunk-JWYCKY2V.js";import"./chunk-G2266BV2.js";import{f as U,t as L}from"./chunk-AFZ6A2B3.js";import"./chunk-VVPY7ZA7.js";import"./chunk-KUW5VATV.js";import"./chunk-BNAVWOJ2.js";import"./chunk-IG2Q5ALZ.js";import{a as Z}from"./chunk-WOMUNWBT.js";import"./chunk-7VFUX7IX.js";import"./chunk-XLF4LAH2.js";import"./chunk-ONKZ57T6.js";import"./chunk-ZC7Q7LCH.js";import{f as m,o as f,p as l,q as x}from"./chunk-6KXF36WM.js";f();x();var I=m(Z());Y();f();x();f();x();f();x();var re=function(){var a=function(o,r){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,t){i.__proto__=t}||function(i,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(i[n]=t[n])},a(o,r)};return function(o,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");a(o,r);function i(){this.constructor=o}o.prototype=r===null?Object.create(r):(i.prototype=r.prototype,new i)}}();var te={},ne={},O=function(a,o){ne[a]=o},e=function(a){var o=function(r){re(i,r);function i(t,n,s){var u=r.call(this,t||a,s)||this;if(Object.setPrototypeOf(u,i.prototype),u.name=a,n)for(var d in n)u[d]=n[d];if(s&&ae(s)&&"cause"in s&&!("cause"in u)){var c=s.cause;u.cause=c,"stack"in c&&(u.stack=u.stack+`
CAUSE: `+c.stack)}return u}return i}(Error);return te[a]=o,o};function ae(a){return typeof a=="object"}var k=function(){var a=function(o,r){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,t){i.__proto__=t}||function(i,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(i[n]=t[n])},a(o,r)};return function(o,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");a(o,r);function i(){this.constructor=o}o.prototype=r===null?Object.create(r):(i.prototype=r.prototype,new i)}}();var ge=e("AccountNameRequired"),Te=e("AccountNotSupported"),Ae=e("AmountRequired"),De=e("BluetoothRequired"),Ne=e("BtcUnmatchedApp"),Se=e("CantOpenDevice"),Oe=e("CashAddrNotSupported"),_e=e("CurrencyNotSupported"),Ie=e("DeviceAppVerifyNotSupported"),ye=e("DeviceGenuineSocketEarlyClose"),me=e("DeviceNotGenuine"),Ce=e("DeviceOnDashboardExpected"),Re=e("DeviceOnDashboardUnexpected"),we=e("DeviceInOSUExpected"),Ue=e("DeviceHalted"),Le=e("DeviceNameInvalid"),Fe=e("DeviceSocketFail"),Pe=e("DeviceSocketNoBulkStatus"),oe=e("LockedDeviceError"),Me=e("DisconnectedDevice"),Be=e("DisconnectedDeviceDuringOperation"),be=e("DeviceExtractOnboardingStateError"),ke=e("DeviceOnboardingStatePollingError"),Ge=e("EnpointConfig"),He=e("EthAppPleaseEnableContractData"),ze=e("FeeEstimationFailed"),We=e("FirmwareNotRecognized"),qe=e("HardResetFail"),Ve=e("InvalidXRPTag"),je=e("InvalidAddress"),Ke=e("InvalidAddressBecauseDestinationIsAlsoSource"),Ye=e("LatestMCUInstalledError"),Qe=e("UnknownMCU"),Xe=e("LedgerAPIError"),$e=e("LedgerAPIErrorWithMessage"),Je=e("LedgerAPINotAvailable"),Ze=e("ManagerAppAlreadyInstalled"),er=e("ManagerAppRelyOnBTC"),rr=e("ManagerAppDepInstallRequired"),tr=e("ManagerAppDepUninstallRequired"),nr=e("ManagerDeviceLocked"),ar=e("ManagerFirmwareNotEnoughSpace"),or=e("ManagerNotEnoughSpace"),ir=e("ManagerUninstallBTCDep"),sr=e("NetworkDown"),cr=e("NoAddressesFound"),ur=e("NotEnoughBalance"),pr=e("NotEnoughBalanceToDelegate"),dr=e("NotEnoughBalanceInParentAccount"),lr=e("NotEnoughSpendableBalance"),vr=e("NotEnoughBalanceBecauseDestinationNotCreated"),fr=e("NoAccessToCamera"),xr=e("NotEnoughGas"),hr=e("NotSupportedLegacyAddress"),Er=e("GasLessThanEstimate"),gr=e("PriorityFeeTooLow"),Tr=e("PriorityFeeTooHigh"),Ar=e("PriorityFeeHigherThanMaxFee"),Dr=e("MaxFeeTooLow"),Nr=e("PasswordsDontMatch"),Sr=e("PasswordIncorrect"),Or=e("RecommendSubAccountsToEmpty"),_r=e("RecommendUndelegation"),Ir=e("TimeoutTagged"),yr=e("UnexpectedBootloader"),mr=e("MCUNotGenuineToDashboard"),Cr=e("RecipientRequired"),Rr=e("UnavailableTezosOriginatedAccountReceive"),wr=e("UnavailableTezosOriginatedAccountSend"),Ur=e("UpdateFetchFileFail"),Lr=e("UpdateIncorrectHash"),Fr=e("UpdateIncorrectSig"),Pr=e("UpdateYourApp"),Mr=e("UserRefusedDeviceNameChange"),Br=e("UserRefusedAddress"),br=e("UserRefusedFirmwareUpdate"),kr=e("UserRefusedAllowManager"),Gr=e("UserRefusedOnDevice"),Hr=e("TransportOpenUserCancelled"),zr=e("TransportInterfaceNotAvailable"),Wr=e("TransportRaceCondition"),qr=e("TransportWebUSBGestureRequired"),Vr=e("DeviceShouldStayInApp"),jr=e("WebsocketConnectionError"),Kr=e("WebsocketConnectionFailed"),Yr=e("WrongDeviceForAccount"),Qr=e("WrongAppForCurrency"),Xr=e("ETHAddressNonEIP"),$r=e("CantScanQRCode"),Jr=e("FeeNotLoaded"),Zr=e("FeeRequired"),et=e("FeeTooHigh"),rt=e("PendingOperation"),tt=e("SyncError"),nt=e("PairingFailed"),at=e("GenuineCheckFailed"),ot=e("LedgerAPI4xx"),it=e("LedgerAPI5xx"),st=e("FirmwareOrAppUpdateRequired"),ct=e("OpReturnSizeLimit"),ut=e("DustLimit"),pt=e("LanguageNotFound"),dt=e("NoDBPathGiven"),lt=e("DBWrongPassword"),vt=e("DBNotReset"),b;(function(a){a.Unknown="Unknown",a.LocationServicesDisabled="LocationServicesDisabled",a.LocationServicesUnauthorized="LocationServicesUnauthorized",a.BluetoothScanStartFailed="BluetoothScanStartFailed"})(b||(b={}));var ft=function(a){k(o,a);function o(r,i){var t=a.call(this,i)||this;return t.name="HwTransportError",t.type=r,Object.setPrototypeOf(t,o.prototype),t}return o}(Error);var ie=function(a){k(o,a);function o(r,i){var t=this,n="TransportError";return t=a.call(this,r||n)||this,t.name=n,t.message=r,t.stack=new Error().stack,t.id=i,t}return o}(Error);O("TransportError",function(a){return new ie(a.message,a.id)});var h={ACCESS_CONDITION_NOT_FULFILLED:38916,ALGORITHM_NOT_SUPPORTED:38020,CLA_NOT_SUPPORTED:28160,CODE_BLOCKED:38976,CODE_NOT_INITIALIZED:38914,COMMAND_INCOMPATIBLE_FILE_STRUCTURE:27009,CONDITIONS_OF_USE_NOT_SATISFIED:27013,CONTRADICTION_INVALIDATION:38928,CONTRADICTION_SECRET_CODE_STATUS:38920,CUSTOM_IMAGE_BOOTLOADER:26159,CUSTOM_IMAGE_EMPTY:26158,FILE_ALREADY_EXISTS:27273,FILE_NOT_FOUND:37892,GP_AUTH_FAILED:25344,HALTED:28586,INCONSISTENT_FILE:37896,INCORRECT_DATA:27264,INCORRECT_LENGTH:26368,INCORRECT_P1_P2:27392,INS_NOT_SUPPORTED:27904,DEVICE_NOT_ONBOARDED:27911,DEVICE_NOT_ONBOARDED_2:26129,INVALID_KCV:38021,INVALID_OFFSET:37890,LICENSING:28482,LOCKED_DEVICE:21781,MAX_VALUE_REACHED:38992,MEMORY_PROBLEM:37440,MISSING_CRITICAL_PARAMETER:26624,NO_EF_SELECTED:37888,NOT_ENOUGH_MEMORY_SPACE:27268,OK:36864,PIN_REMAINING_ATTEMPTS:25536,REFERENCED_DATA_NOT_FOUND:27272,SECURITY_STATUS_NOT_SATISFIED:27010,TECHNICAL_PROBLEM:28416,UNKNOWN_APDU:27906,USER_REFUSED_ON_DEVICE:21761,NOT_ENOUGH_SPACE:20738};function se(a){switch(a){case 26368:return"Incorrect length";case 26624:return"Missing critical parameter";case 27010:return"Security not satisfied (dongle locked or have invalid access rights)";case 27013:return"Condition of use not satisfied (denied by the user?)";case 27264:return"Invalid data received";case 27392:return"Invalid parameter received";case 21781:return"Locked device"}if(28416<=a&&a<=28671)return"Internal error, please report"}function G(a){var o=Object.keys(h).find(function(n){return h[n]===a})||"UNKNOWN_ERROR",r=se(a)||o,i=a.toString(16),t="Ledger device: ".concat(r," (0x").concat(i,")");if(a===h.LOCKED_DEVICE)throw new oe(t);this.name="TransportStatusError",this.message=t,this.stack=new Error().stack,this.statusCode=a,this.statusText=o}G.prototype=new Error;O("TransportStatusError",function(a){return new G(a.statusCode)});var V=m(ee()),E=function(a,o,r,i){function t(n){return n instanceof r?n:new r(function(s){s(n)})}return new(r||(r=Promise))(function(n,s){function u(p){try{c(i.next(p))}catch(v){s(v)}}function d(p){try{c(i.throw(p))}catch(v){s(v)}}function c(p){p.done?n(p.value):t(p.value).then(u,d)}c((i=i.apply(a,o||[])).next())})},g=function(a,o){var r={label:0,sent:function(){if(n[0]&1)throw n[1];return n[1]},trys:[],ops:[]},i,t,n,s;return s={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function u(c){return function(p){return d([c,p])}}function d(c){if(i)throw new TypeError("Generator is already executing.");for(;r;)try{if(i=1,t&&(n=c[0]&2?t.return:c[0]?t.throw||((n=t.return)&&n.call(t),0):t.next)&&!(n=n.call(t,c[1])).done)return n;switch(t=0,n&&(c=[c[0]&2,n.value]),c[0]){case 0:case 1:n=c;break;case 4:return r.label++,{value:c[1],done:!1};case 5:r.label++,t=c[1],c=[0];continue;case 7:c=r.ops.pop(),r.trys.pop();continue;default:if(n=r.trys,!(n=n.length>0&&n[n.length-1])&&(c[0]===6||c[0]===2)){r=0;continue}if(c[0]===3&&(!n||c[1]>n[0]&&c[1]<n[3])){r.label=c[1];break}if(c[0]===6&&r.label<n[1]){r.label=n[1],n=c;break}if(n&&r.label<n[2]){r.label=n[2],r.ops.push(c);break}n[2]&&r.ops.pop(),r.trys.pop();continue}c=o.call(a,r)}catch(p){c=[6,p],t=0}finally{i=n=0}if(c[0]&5)throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}},H=function(a,o){var r=typeof Symbol=="function"&&a[Symbol.iterator];if(!r)return a;var i=r.call(a),t,n=[],s;try{for(;(o===void 0||o-- >0)&&!(t=i.next()).done;)n.push(t.value)}catch(u){s={error:u}}finally{try{t&&!t.done&&(r=i.return)&&r.call(i)}finally{if(s)throw s.error}}return n},ce=function(a){var o=typeof Symbol=="function"&&Symbol.iterator,r=o&&a[o],i=0;if(r)return r.call(a);if(a&&typeof a.length=="number")return{next:function(){return a&&i>=a.length&&(a=void 0),{value:a&&a[i++],done:!a}}};throw new TypeError(o?"Object is not iterable.":"Symbol.iterator is not defined.")},z=0,_=1,ue=1,pe=2,T=255,W=224,A={GET_VERSION:4,GET_ADDR:5,SIGN:6,SIGN_OFFCHAIN:7},D;(function(a){a[a.BLIND_SIGNATURE_REQUIRED=26632]="BLIND_SIGNATURE_REQUIRED"})(D||(D={}));var de=function(){function a(o,r){r===void 0&&(r="solana_default_scramble_key"),this.transport=o,this.transport.decorateAppAPIMethods(this,["getAddress","signTransaction","getAppConfiguration"],r)}return a.prototype.getAddress=function(o,r){return r===void 0&&(r=!1),E(this,void 0,void 0,function(){var i,t;return g(this,function(n){switch(n.label){case 0:return i=this.pathToBuffer(o),[4,this.sendToDevice(A.GET_ADDR,r?_:z,i)];case 1:return t=n.sent(),[2,{address:t}]}})})},a.prototype.signTransaction=function(o,r){return E(this,void 0,void 0,function(){var i,t,n,s;return g(this,function(u){switch(u.label){case 0:return i=this.pathToBuffer(o),t=l.Buffer.alloc(1),t.writeUInt8(1,0),n=l.Buffer.concat([t,i,r]),[4,this.sendToDevice(A.SIGN,_,n)];case 1:return s=u.sent(),[2,{signature:s}]}})})},a.prototype.signOffchainMessage=function(o,r){return E(this,void 0,void 0,function(){var i,t,n,s;return g(this,function(u){switch(u.label){case 0:return i=this.pathToBuffer(o),t=l.Buffer.alloc(1),t.writeUInt8(1,0),n=l.Buffer.concat([t,i,r]),[4,this.sendToDevice(A.SIGN_OFFCHAIN,_,n)];case 1:return s=u.sent(),[2,{signature:s}]}})})},a.prototype.getAppConfiguration=function(){return E(this,void 0,void 0,function(){var o,r,i,t,n,s;return g(this,function(u){switch(u.label){case 0:return[4,this.sendToDevice(A.GET_VERSION,z,l.Buffer.alloc(0))];case 1:return o=H.apply(void 0,[u.sent(),5]),r=o[0],i=o[1],t=o[2],n=o[3],s=o[4],[2,{blindSigningEnabled:Boolean(r),pubKeyDisplayMode:i,version:"".concat(t,".").concat(n,".").concat(s)}]}})})},a.prototype.pathToBuffer=function(o){var r=o.split("/").map(function(t){return t.endsWith("'")||t.endsWith("h")?t:t+"'"}).join("/"),i=V.default.fromString(r).toPathArray();return this.serializePath(i)},a.prototype.serializePath=function(o){var r,i,t=l.Buffer.alloc(1+o.length*4);t.writeUInt8(o.length,0);try{for(var n=ce(o.entries()),s=n.next();!s.done;s=n.next()){var u=H(s.value,2),d=u[0],c=u[1];t.writeUInt32BE(c,1+d*4)}}catch(p){r={error:p}}finally{try{s&&!s.done&&(i=n.return)&&i.call(n)}finally{if(r)throw r.error}}return t},a.prototype.sendToDevice=function(o,r,i){return E(this,void 0,void 0,function(){var t,n,s,u,d,c,p;return g(this,function(v){switch(v.label){case 0:if(t=[h.OK,D.BLIND_SIGNATURE_REQUIRED],n=0,s=0,!(i.length>T))return[3,3];v.label=1;case 1:return i.length-s>T?(u=i.slice(s,s+T),s+=T,[4,this.transport.send(W,o,r,n|pe,u,t)]):[3,3];case 2:return d=v.sent(),this.throwOnFailure(d),n|=ue,[3,1];case 3:return c=i.slice(s),[4,this.transport.send(W,o,r,n,c,t)];case 4:return p=v.sent(),this.throwOnFailure(p),[2,p.slice(0,p.length-2)]}})})},a.prototype.throwOnFailure=function(o){var r=o.readUInt16BE(o.length-2);switch(r){case D.BLIND_SIGNATURE_REQUIRED:throw new Error("Missing a parameter. Try enabling blind signature in the app");default:return}},a}(),j=de,q;(function(a){a[a.LONG=0]="LONG",a[a.SHORT=1]="SHORT"})(q||(q={}));Q();X();$();J();var y=class extends B{async makeApp(){await this.initLedgerTransPorter(),this.app||(this.app=new j(this.ledgerTransPorter))}async getAddressPromise(o,r){await this.makeApp();let i=[];for(let t=o*5;t<(o+1)*5;t++){let n=`44'/501'/${t}'/0'`;r===P&&(n=`44'/501'/${t}'`);let{address:s}=await this.app.getAddress(n,!1);i.push({address:I.default.encode(s),index:t,path:n})}return i}async getAddress(o=0,r){return await Promise.race([this.getAddressPromise(o,r),this.throwTimeoutError()])}async getTokens(o,r){let i=o.map(({address:t})=>t);try{let t=await w(R.getChainToken,{addressList:i,coinId:r});if(t?.code===0){let{data:n}=t;n.forEach(({address:s,coinAmount:u})=>{let d=C(o,{address:s});d.coinAmount=u})}}catch(t){console.log(t)}return o}async signTransaction(o,r){try{S.openModal(M.confirm);let i=o.hdPathMap[N];await this.checkLedgerConnection();let{payer:t}=r,{getHardWareRawTransaction:n}=await F(),s=await n(501,{data:r}),u=l.Buffer.from(s,"hex"),d=L.from(u),c=d.serializeMessage(),{signature:p}=await this.app.signTransaction(i,c),v=new U(t);d.signatures&&(d.signatures=[]),d.addSignature(v,p);let K=d.serialize();return S.closeModal(),I.default.encode(K)}catch(i){return this.handleErrors(i,N)}}},Ft=new y;export{Ft as default};

window.inOKXExtension = true;
window.inMiniApp = false;
window.ASSETS_BUILD_TYPE = "publish";

//# sourceMappingURL=solanaAdapter-6TTX43RY.js.map
