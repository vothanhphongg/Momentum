import{b as d}from"./chunk-JJ3YEFIG.js";import{sa as G,ua as N}from"./chunk-HPWCPLRR.js";import{k as E,l as at}from"./chunk-3DZ7WRLL.js";import{d as j,f as st}from"./chunk-DEOJU4Z3.js";import{R as ot,p as H}from"./chunk-UWJLNJLY.js";import{H as P,R as h,ra as rt}from"./chunk-XDY6V34Y.js";import{a as it}from"./chunk-7U3DN5ZD.js";import{f as et,o as i,q as n}from"./chunk-6KXF36WM.js";i();n();rt();st();var O="txHistoryRejectValues",nt={hideValuelessNft:"hideValuelessNft"},Lt={NORMAL:0,RISKY:1,VALUELESS:2},C={[nt.hideValuelessNft]:!0},A=async()=>{try{return await j().getSelectedWallet()}catch{return null}},W=()=>{try{let t=localStorage.getItem(O);return t?JSON.parse(t)??{}??{}:{}}catch{return{}}},v=(t={})=>{try{let e=JSON.stringify(t);return localStorage.setItem(O,e),!0}catch{return!1}},mt=async(t,e)=>{try{let r=await A();if(!r)return!1;let o=W(),s={[r]:{[t]:e}};return v(h({},o,s))}catch{return!1}},k=async()=>{let t=await A();if(!t)return{};let e=W(),r=e?.[t]??{};if(P(r)){let o={[t]:C};return v(h({},e,o)),C}return r};i();n();var U=et(it());i();n();ot();i();n();at();i();n();function lt(t){return async(e,r)=>{await e(p({...t,dates:d().stringDates,needMore:!0})),await e(y(!0));let o=r();e(S(q(o)))}}var l=E({name:"txHistory",initialState:{filters:{dates:d().stringDates,chainId:"",init:!0,needMore:!0,groupType:0,coinId:void 0},txList:[],txGroupList:[],initLoading:!0,scrollLoading:!1,filterLoading:!1,lastRowId:"",historyPageSearchValue:""},reducers:{setHistoryPageSearchValue:(t,e)=>{t.historyPageSearchValue=e.payload},setInitLoading:(t,e)=>{t.initLoading=e.payload},setScrollLoading:(t,e)=>{t.scrollLoading=e.payload},setFilterLoading:(t,e)=>{t.filterLoading=e.payload},setFilters:(t,e)=>{t.filters={...t.filters,...e.payload,init:!1}},setLastRowId:(t,e)=>{t.lastRowId=e.payload},setTxList:(t,e)=>{t.txList=e.payload},setTxGroupList:(t,e)=>{t.txGroupList=e.payload},mergeTxList:(t,e)=>{t.txList=[...t.txList,...e.payload]},resetFilters(t){t.filters={dates:d().stringDates,chainId:"",init:!0,needMore:!0,groupType:0,coinId:void 0}},resetTxHistory:t=>{t.txList=[],t.initLoading=!1,t.scrollLoading=!1,t.filterLoading=!1,t.lastRowId="",t.historyPageSearchValue=""}}}),{actions:ct,reducer:ut}=l,Ft=ut,Mt=t=>t[l.name].txList,T=t=>t[l.name].filters,Pt=t=>t[l.name].txGroupList,q=t=>{let e=T(t),{dates:[r,o],chainId:s,groupType:a,coinId:c}=e;return{startTime:new Date(`${r} 00:00:00`).getTime(),endTime:new Date(`${o} 23:59:59`).getTime(),chainId:s,groupType:a,coinId:c}},J=t=>t[l.name].initLoading,K=t=>t[l.name].scrollLoading,Y=t=>t[l.name].lastRowId,Ht=t=>t[l.name].filterLoading,jt=t=>t[l.name].historyPageSearchValue,{setFilters:p,setTxList:V,mergeTxList:R,setInitLoading:D,setScrollLoading:w,setFilterLoading:y,resetTxHistory:Et,setLastRowId:g,resetFilters:Gt,setTxGroupList:Nt,setHistoryPageSearchValue:Ct}=ct;var $=({scrollLoad:t,lastRowId:e,scrollLoading:r,initLoading:o,needMore:s,fromCoinDetail:a})=>!(t&&((a?!e:!e&&!s)||r||o)),b=(t,{needMore:e,fromCoinDetail:r,hasViewMore:o,rowId:s})=>{e&&!r&&!o&&(t(p({dates:d(H.subtract(180,"d"))?.stringDates,needMore:!1})),t(g(s)))},B=async(t,{reqParams:e,lastRowId:r,scrollLoad:o,fromCoinDetail:s})=>{if(o&&(t(w(!0)),e.lastRowId=r),!s)try{let a=await k();e.hideRisk=a?.hideValuelessNft??!0}catch(a){console.error(a)}return e};var S=(t,e={initLoad:!1,scrollLoad:!1,autoRefresh:!1,fromCoinDetail:!1,hasMoreData:!0,hasInitData:!0})=>async(r,o)=>{let s={...t},{initLoad:a,scrollLoad:c,fromCoinDetail:f,hasMoreData:_,hasInitData:z}=e,Q=f?N:G,L=o(),F=Y(L),{needMore:I}=T(L),X=J(L),Z=K(L);if(!(!_&&(z||!I)||!$({scrollLoad:c,lastRowId:F,scrollLoading:Z,initLoading:X,needMore:I,fromCoinDetail:f}))){a&&(r(D(!0)),r(g(""))),await B(r,{reqParams:s,lastRowId:F,scrollLoad:c,fromCoinDetail:f});try{let m=await Q(s),u=m?.content;(0,U.isEmpty)(u)&&(u=[]),r(c?R(u):V(u));let M=u.length,tt=m.hasViewMore?u[M-1]?.rowId:"";r(g(tt)),b(r,{needMore:I,fromCoinDetail:f,hasViewMore:m.hasViewMore,rowId:u[M-1]?.rowId})}catch{r(c?R([]):V([]))}a&&r(D(!1)),c&&r(w(!1)),r(y(!1))}};export{nt as a,Lt as b,mt as c,k as d,S as e,lt as f,Ft as g,Mt as h,T as i,Pt as j,q as k,J as l,K as m,Y as n,Ht as o,jt as p,p as q,V as r,D as s,Et as t,g as u,Gt as v,Nt as w,Ct as x};

window.inOKXExtension = true;
window.inMiniApp = false;
window.ASSETS_BUILD_TYPE = "publish";

//# sourceMappingURL=chunk-DJZDGYQA.js.map
