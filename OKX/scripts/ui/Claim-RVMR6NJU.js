import{d as dt,e as ut,i as ft,j as pt,k as Ct,l as gt,n as v}from"./chunk-AK5XDPVX.js";import"./chunk-HBNKRX4V.js";import{a as lt}from"./chunk-TFJRUJHH.js";import{b as ct}from"./chunk-7NMUCCUG.js";import{i as nt}from"./chunk-YF3DWJDS.js";import{g as st,h as it}from"./chunk-RH4ISAHA.js";import"./chunk-ECQND2NK.js";import"./chunk-W3L3YTJO.js";import"./chunk-M5NI6HPE.js";import"./chunk-YQHUKBMA.js";import"./chunk-VM2NMLPX.js";import"./chunk-YP7CHBKG.js";import{f as at}from"./chunk-FNXLAYUB.js";import{a as tt,k as rt}from"./chunk-PQK3LXXN.js";import{$c as mt,Db as et,Zc as h,vb as ot}from"./chunk-FTRHGHDS.js";import{c}from"./chunk-XT3EOPTE.js";import{B as b,l as R,m as L}from"./chunk-A6Z53EN6.js";import"./chunk-LL63GZNI.js";import"./chunk-M7CL2K7X.js";import"./chunk-W2CTJYFJ.js";import"./chunk-XUKVTAH5.js";import"./chunk-5OJTPISL.js";import"./chunk-7UPVX2FL.js";import"./chunk-BSFXZ46S.js";import"./chunk-ZMCTBWUY.js";import"./chunk-TSTPZ3JM.js";import{a as Nt}from"./chunk-ON6S2DB7.js";import"./chunk-VW6OQNWT.js";import{d as q}from"./chunk-PUSMMCUD.js";import{G as O,R as X}from"./chunk-UWJLNJLY.js";import"./chunk-XDY6V34Y.js";import{$ as z,ea as y}from"./chunk-JT3LNHPY.js";import"./chunk-47UWF72W.js";import{b as S}from"./chunk-JWYCKY2V.js";import"./chunk-G2266BV2.js";import"./chunk-NM2PDVBD.js";import"./chunk-7VFUX7IX.js";import{f,o as i,q as n}from"./chunk-6KXF36WM.js";i();n();var o=f(S()),B=f(Nt()),j=f(mt());i();n();var V={list:"list",coin:"coin",orderDetail:"orderDetail"};i();n();var x=f(S());i();n();var yt=f(S());var N=()=>{let{walletContractStore:e}=c(),{gasFee:t,nativeCoin:r}=e,{coinAmountInt:s,decimals:a}=r??{};return(0,yt.useMemo)(()=>{let l=rt(s,a);return tt.gte(l,t||"0")},[t,s,a])};var Mt=()=>{let{HeaderTip:e}=b.components,{walletContractStore:t}=c(),{gasInfo:r,gasLimitError:s,nativeCoin:a,compuletedGetNativeCoinError:l,compuletedGetNativeCoinLoading:d,computedTipsBtnProps:g}=t,{symbol:p}=a??{},u={type:q.TYPE.error,renderGasStation:!1},w=N(),E=()=>x.default.createElement(e,{type:q.TYPE.warn,message:h("swaptrade_extension_cinteraction_insufficient_networkfee",{symbol:p}),actions:[g],renderGasStation:!1}),P=()=>x.default.createElement(e,{...u,message:h("swaptrade_extension_cinteraction_might_error")}),I=()=>x.default.createElement(e,{...u,message:s});return d?null:l?x.default.createElement(e,{...u,message:h("swaptrade_history_error_retrieve_balance_error")}):s?I():w&&r?.gasLimitInfo?.queryGasLimitErrorUseDefault?P():w?null:E()},ht=L(Mt);i();n();var St=f(S());var Bt=({chainId:e,tokenContractAddress:t,amount:r,isNativeToken:s})=>{let a=gt({chainId:e,tokenContractAddress:t,isNativeToken:s}),{coinId:l,decimals:d}=a||{};return(0,St.useMemo)(()=>[{coinId:l,assetChange:Ct("+",r,d),useMinPrecision:!1}],[r,l,d])},Tt=Bt;i();n();var T=f(S()),Lt=f(mt());i();n();var _t=f(S());var Wt=()=>{let{walletContractStore:e}=c(),t=N(),{gasInfo:r,gasLimitError:s,compuletedGetNativeCoinError:a,compuletedGetNativeCoinLoading:l,gasFeeLoading:d}=e;return(0,_t.useMemo)(()=>d||s||a||l||r?.isGasLimitLoading||r?.gasLimitInfo?.queryGasLimitErrorUseDefault||!t,[a,l,d,r?.gasLimitInfo?.queryGasLimitErrorUseDefault,r?.isGasLimitLoading,s,t])},wt=Wt;i();n();var Et=f(S());X();i();n();X();var Z=class{constructor(){this.isLoading=!1;this.setLoading=t=>{this.isLoading=t};this.orderDetail=null;this.setOrderDetail=t=>{this.orderDetail=t};this.fetchOrderDetail=async t=>{this.setLoading(!0);let[r,s]=await O(nt.get(et,{params:{orderId:t}}));if(r){this.setError(r),this.setLoading(!1);return}let a=s.data;this.setOrderDetail(a)};this.payload=null;this.setPayload=t=>{this.payload=t};this.sourceClaimPayload=null;this.setSourceClaimPayload=t=>{this.sourceClaimPayload=t};this.error=null;this.reset=()=>{this.setLoading(!1),this.setOrderDetail(null),this.setPayload(null),this.setSourceClaimPayload(null),this.clearError()};R(this,{},{autoBind:!0})}setError(t){this.error=t}clearError(){this.error=null}},_=new Z;var Ft=e=>{let{sendTransactionStore:t,walletContractStore:r,swapStore:s}=c(),{toChainId:a,orderId:l}=e||{};return(0,Et.useCallback)(async()=>{let{history:d}=b,{payload:g}=_;it.info(st.CLAIM_PAYLOAD,{payload:g,tags:{orderId:l}});let[p,u]=await O(t.sendTransaction(a,g[0],r.walletSendParams));if(p){s.onWalletFail(p,l,!0);return}let{result:w,nonce:E}=lt(a,u);await s.updateClaimOrder({mainOrderId:l,redeemTxHash:w,nonce:E}),d?.goBack()},[t,a,r.walletSendParams,s,l])},It=Ft;i();n();var M={footer:"_footer_18rul_1","button-style":"_button-style_18rul_8",buttonStyle:"_button-style_18rul_8"};var Ht=({onChangeHeight:e,trade:t})=>{let r=(0,T.useRef)(null),{walletContractStore:s}=c(),{computedCancelBtnProps:a}=s;(0,T.useEffect)(()=>{let g=u=>{e&&e(u.offsetHeight)},p=new MutationObserver(u=>{g(u[0]?.target)});return r.current&&(g(r.current),p.observe(r.current,{childList:!0})),()=>{p.disconnect()}},[e]);let l=wt(),d=It(t);return T.default.createElement("div",{className:(0,Lt.default)(M.footer)},T.default.createElement(y,{block:!0,circle:!1,className:M.buttonStyle,size:y.SIZE.lg,category:y.CATEGORY.outline,type:y.TYPE.primary,loading:a.loading,loadingText:a.btnText,disabled:a.disabled,onClick:a.onClick},a.btnText),T.default.createElement(y,{block:!0,circle:!1,className:M.buttonStyle,size:y.SIZE.lg,type:y.TYPE.highlight,category:y.CATEGORY.fill,disabled:l,onClick:()=>{d()}},h("swaptrade_common_btn_confirm")))},bt=L(Ht);i();n();var $=f(S());var Ut=({chainId:e,transactionPayload:t})=>{let{fromToStore:r}=c(),{isEvmChain:s}=r;return ut(e),s(e)?$.default.createElement(pt,{chainId:e,transactionPayload:t,isClaim:!0}):$.default.createElement(ft,{chainId:e,transactionPayload:t,isClaim:!0})},vt=Ut;var Yt=()=>{let[e,t]=(0,o.useState)(""),{components:{MultipleChangeSummary:r,TxTypeWithTools:s,SectionWrap:a,InteractiveAddress:l,ModuleWrap:d,ViewData:g}}=b,p=(0,B.useHistory)(),[u,w]=(0,o.useState)(80),{search:E}=(0,B.useLocation)(),{orderId:P,source:I}=(0,o.useMemo)(()=>at(E),[E]),{swapStore:D,accountStore:W,fromToStore:Pt,walletContractStore:Dt}=c(),{computedAccountId:kt}=W,{isEvmChain:xt}=Pt,{gasInfo:F}=Dt,{orderDetail:m,setPayload:k,payload:J,setLoading:H,setSourceClaimPayload:K,sourceClaimPayload:U}=_;(0,o.useEffect)(()=>{I&&(I===V.list||I===V.coin)&&e&&ct("bridge_claim_click","history_main",e)},[I,e]),(0,o.useEffect)(()=>{P&&_.fetchOrderDetail(P)},[P]),(0,o.useEffect)(()=>()=>{_.reset()},[]),(0,o.useEffect)(()=>{if(m){let G=W.getAddressByChainId(m.toChainId);t(G),D.fetchClaimCalldata(m,G).then(A=>{if(H(!1),!A){p.goBack();return}let{payload:Y,sourceClaimPayload:Ot}=A;k(Y),K(Ot)}).catch(()=>{H(!1)})}},[D,m,W,k,H,K,p]);let Q=(0,o.useCallback)(async(G,A)=>{let Y=await D.formatClaimPayload(G,A);k(Y)},[k,D]);(0,o.useEffect)(()=>{m&&U&&F&&Q(U,m)},[F.networkFee,m,U,k,D,F,Q]);let Gt=dt(ot.CLAIM),At=Tt({chainId:m?.toChainId,tokenContractAddress:m?.toTokenAddress,isNativeToken:m?.isNativeToken==="1",amount:m?.bridgeChildOrderDetailVo?.toAmountOut});return _.isLoading?o.default.createElement("div",{className:(0,j.default)(v.container,v.loading)},o.default.createElement(z,{size:z.SIZE.lg})):o.default.createElement("div",{className:v.container},o.default.createElement("div",{style:{height:`calc(100% - ${u}px)`},className:(0,j.default)(v.wrap)},o.default.createElement("div",{className:v.scroll,id:"wallet_scroll"},o.default.createElement(ht,null),o.default.createElement(s,{txTypeInfo:{baseInfo:Gt}},o.default.createElement(r,{title:h("swaptrade_orders_label_receive"),summaryList:At})),o.default.createElement(vt,{chainId:m?.toChainId,transactionPayload:J?.[0]}),o.default.createElement(a,null,o.default.createElement(l,{title:h("swaptrade_transfer_textarea_wallet_used"),address:e,walletId:kt})),o.default.createElement(a,{bordered:!1},xt(m?.toChainId)&&o.default.createElement(g,{copyable:{hideDesc:!0},data:J?.[0]?.data})))),o.default.createElement(bt,{onChangeHeight:w,trade:m}))},Se=L(Yt);export{Se as default};

window.inOKXExtension = true;
window.inMiniApp = false;
window.ASSETS_BUILD_TYPE = "publish";

//# sourceMappingURL=Claim-RVMR6NJU.js.map
