import{b as jt,d as Kt}from"./chunk-SRCBMK3B.js";import{b as Vt,c as Gt}from"./chunk-4EEXXMXA.js";import{a as Yt}from"./chunk-KN7FYSHN.js";import{a as ve}from"./chunk-AQOCVER4.js";import{a as Oe}from"./chunk-S7NLB5XS.js";import{a as se}from"./chunk-UUWJWUOY.js";import{b as gt,c as kt,d as Tt,e as Et,f as xt,g as Ct,l as St,m as At,n as Nt,o as It}from"./chunk-J4ZNYN2W.js";import{a as Ue,b as Ft}from"./chunk-X4AGSDQV.js";import{Aa as mt,F as lt,ia as ct,l as te}from"./chunk-KLLSVAFY.js";import{a as Mt,c as zt,d as Ht}from"./chunk-Y2TZQZGL.js";import{a as Dt}from"./chunk-4FBPDXIS.js";import{a as re}from"./chunk-ZV5BZTW2.js";import{a as Wt,b as Bt,c as Ut,d as Ot,e as vt}from"./chunk-3NWEQ7OH.js";import{h as nt}from"./chunk-UBFC7TLG.js";import{j as pt,k as dt,l as ft,m as ut}from"./chunk-XKL64FTO.js";import{a as Rt}from"./chunk-PTD7UCOR.js";import{a as ge}from"./chunk-V3IFYKWM.js";import{b as ke,c as Te}from"./chunk-Y2TPPS4H.js";import{h as z,i as H}from"./chunk-ITY22AD4.js";import{a as We}from"./chunk-B3JSNQIV.js";import{D as _t,G as Be,M as yt,Za as Pt,a as Y,na as wt,nb as ht,y as we}from"./chunk-YALUYHLV.js";import{q as O}from"./chunk-I3CPAVOC.js";import{o as ce}from"./chunk-5QMHGZLF.js";import{ec as Pe,ub as it,yb as ye}from"./chunk-HPWCPLRR.js";import{a as me}from"./chunk-ON6S2DB7.js";import{d as N,f as _e}from"./chunk-DEOJU4Z3.js";import{c as L,d as Lt,e as he,g as oe}from"./chunk-UVFOW4HH.js";import{g as bt}from"./chunk-LNOPECCQ.js";import{c as k}from"./chunk-43VURGIT.js";import{B as de,H as Me,ia as fe,ja as Fo,ka as ue,kd as at,qa as Xe,rd as zo,t as qe,u as Je,v as Qe,x as Le}from"./chunk-TM67VPZU.js";import{D as ee,H as le,e as ot,o as rt,q as X,r as st}from"./chunk-PUSMMCUD.js";import{R as ne,z as c}from"./chunk-UWJLNJLY.js";import{H as pe,N as Ze,l as Ye,o as $e,ra as be}from"./chunk-XDY6V34Y.js";import{K as et,W as tt,c as Ro,ea as g}from"./chunk-JT3LNHPY.js";import{b as K}from"./chunk-JWYCKY2V.js";import{f as _,o as r,q as s}from"./chunk-6KXF36WM.js";r();s();var C=_(K()),Ne=_(Pe()),Ve=_(me()),J=_(ce());ne();_e();r();s();var V=_(K()),Ee=_(ce());_e();Fo();Me();r();s();r();s();function Ho(){}var $t=Ho;var Zt=$t;r();s();var v=_(K());ne();r();s();var $={root:"_root_15akf_1",image:"_image_15akf_4",title:"_title_15akf_7",desc:"_desc_15akf_15",btns:"_btns_15akf_23","cancel-width":"_cancel-width_15akf_26",cancelWidth:"_cancel-width_15akf_26"};function De({type:t,step:o,onCancel:e,onRetry:a}){let m=bt({light:"./static/images/passkey-light-big.png",dark:"./static/images/passkey-dark-big.png"}),i={["create"]:{title:{text:"wallet_extension_biometrics_drawer_title_verification",keys:{num:1,total:2},color:"var(--okd-color-content-primary)"},desc:"wallet_extension_biometrics_drawer_desc_verification",cancel:"commonall_text_btn_cancel",onCancel:e},["verify"]:{title:{text:t==="create"?"wallet_extension_biometrics_drawer_title_verification":"wallet_extension_biometrics_drawer_title_unlock",keys:{num:2,total:2},color:"var(--okd-color-content-primary)"},desc:t==="create"?"wallet_extension_biometrics_drawer_desc_verification":"wallet_extension_biometrics_drawer_desc_unlock",cancel:"commonall_text_btn_cancel",onCancel:e},["error"]:{title:{text:"wallet_extension_biometrics_drawer_title_fail_setup",color:"var(--okd-color-semantic-negative)"},desc:"wallet_extension_biometrics_drawer_desc_fail_setup",confirm:"commonall_emptystate_text_try_again",onConfirm:a,cancel:"commonall_text_btn_cancel",onCancel:e},["init"]:null,["success"]:null}[o];return i?v.default.createElement(k.Container,{className:$.root},v.default.createElement(k.FlexBox,{className:$.image,align:k.ALIGN.center,justify:"center"},v.default.createElement(ot,{src:m,width:120,height:120})),v.default.createElement(O.Text,{strong:700,className:$.title,style:{color:i.title.color}},c(i.title.text,i.title.keys)),v.default.createElement(O.Text,{strong:400,className:$.desc},c(i.desc)),v.default.createElement(k.FlexBox,{className:$.btns,align:k.ALIGN.center,justify:"center"},v.default.createElement(g,{block:i.confirm,category:g.CATEGORY.fill,type:g.TYPE.gray,size:g.SIZE.lg,onClick:()=>{i.onCancel()},className:Dt({[$.cancelWidth]:!i.confirm})},c(i.cancel)),i.confirm?v.default.createElement(g,{block:!0,category:g.CATEGORY.fill,type:g.TYPE.highlight,size:g.SIZE.lg,onClick:()=>{i.onConfirm()}},c(i.confirm)):null)):null}function Z(){let[t]=Te(ke.credentialId),[o,e]=(0,V.useState)("init"),[a,m]=(0,V.useState)("init"),l=(0,V.useRef)(null),i=(0,V.useRef)(h=>h),P=async(h,d)=>{try{m("create"),e("create"),i.current=h,await Oe(500);let{password:E,credential:G,credentialId:M}=await Ut(d??"");e("verify");try{await Ot({credential:G,password:E})}catch(j){Zt(),e("error"),await h(null,j);return}l.current?.destroy(),e("success"),await h({password:E,credentialId:M})}catch(E){e("error"),await h(null,E)}},p=async h=>{try{m("verify"),e("verify"),i.current=h;let{password:d}=await vt(t);await N().verifyPassword(d),l.current?.destroy(),e("success"),await h(!!d)}catch{e("error"),await h(!1)}},S=()=>{e("init"),m("init"),l.current?.destroy()},A=()=>{a==="create"&&P(i.current),a==="verify"&&p(i.current)},F=async()=>{fe()!==de&&(l.current||(l.current=rt.action({mask:!1})),await Oe(100),l.current.update({visible:!0,mask:!0,onClose:()=>{S()},children:V.default.createElement(De,{step:o,type:a,onRetry:()=>{A()},onCancel:()=>{S()}})}))};return(0,Ee.useUpdateEffect)(()=>{if(o==="init"||o==="success"){l.current?.destroy();return}F()},[o]),(0,Ee.useUnmount)(()=>{l.current?.destroy()}),{create:P,verify:p}}Xe();Me();r();s();var T=_(K()),Ce=_(ce());ne();r();s();var xe={root:"_root_cl85f_1",passwordInput:"_passwordInput_cl85f_6"};var qt=({onBack:t,onComplete:o,title:e=void 0,desc:a=void 0,learnMoreProps:m={},showLearnMore:l=!0,disabled:i=!1,autoFocus:P=!1,customContent:p=T.default.createElement(T.default.Fragment,null),containerClassName:S=""})=>{let h=se().get("from")===w.HARDWARE,d=ee.useForm(),[E,G]=(0,T.useState)({}),[M,{setTrue:j,setFalse:ae}]=(0,Ce.useBoolean)(!1),R=!E.password||!E.confirm||E.password?.length<Ue||E.confirm?.length<Ue||E.password!==E.confirm,Q=(0,Ce.useMemoizedFn)(async()=>{let{password:u,confirm:f}=E;if(!(M||R)){if(u!==f){d.setErrors({confirm:c("wallet_settings_reset_passord_errortip_input_error")});return}mt(),j(),await o(f),ae()}},[R,E]),ie=(0,T.useCallback)(async u=>{(u?.key==="Enter"||u?.keyCode===13)&&await Q()},[]),n=Gt();return(0,T.useEffect)(()=>(document.addEventListener("keydown",ie),()=>{document.removeEventListener("keydown",ie)}),[]),T.default.createElement(Vt,{className:xe.root,containerClassName:S,title:e||c("wallet_signup_maintitle_set_password"),desc:a||c(h?"wallet_extension_signup_subtitle_set_password_hardware":"wallet_extension_subtitle_password_unlock"),showLearnMore:l,learnMoreProps:m,onBack:t},({formClass:u,formErrorClass:f,itemClass:W})=>T.default.createElement(ee,{form:d,size:X.SIZE.lg,validateTrigger:["onChange","onBlur"],className:u,errorClassName:f,onValuesChange:(b,B)=>{G(B)}},T.default.createElement(ee.Item,{name:"password",style:{marginBottom:0},className:W,label:c("wallet_set_password_subtitle_password")},T.default.createElement(X.Password,{autoFocus:P,autoComplete:"off",size:X.SIZE.xl,inputClassName:xe.passwordInput,placeholder:c("wallet_settings_reset_passord_placeholder_input_desc")})),T.default.createElement(ee.Item,{noStyle:!0,shouldUpdate:(b,B)=>b.password!==B.password},({getFieldValue:b})=>{let B=b("password");return T.default.createElement(Ft,{password:B})}),T.default.createElement(ee.Item,{name:"confirm",className:W,label:c("wallet_settings_reset_passord_subtitle_password_confirmation"),style:{flex:1,marginTop:"32px"}},T.default.createElement(X.Password,{autoComplete:"off",size:X.SIZE.xl,inputClassName:xe.passwordInput,placeholder:c("wallet_settings_reset_passord_placeholder_input_password_confirmation"),onChange:()=>{d.cleanErrors("confirm")}})),p,T.default.createElement(ge.FooterActions,{usePortal:!0,renderNative:!0,affixStyle:n,buttonGroup:[{loading:M,disabled:i||R,block:!0,type:g.TYPE.highlight,category:g.CATEGORY.fill,size:g.SIZE.lg,btnText:c("wallet_set_password_btn_confirm"),onClick:Q}]})))};r();s();r();s();var I=_(K());var Jt=_(Ro());ne();r();s();var D={content:"_content_1cywj_1",title:"_title_1cywj_4",desc:"_desc_1cywj_12",list:"_list_1cywj_19",item:"_item_1cywj_22","item-select":"_item-select_1cywj_39",itemSelect:"_item-select_1cywj_39","item-content":"_item-content_1cywj_42",itemContent:"_item-content_1cywj_42","item-title":"_item-title_1cywj_46",itemTitle:"_item-title_1cywj_46","item-desc":"_item-desc_1cywj_54",itemDesc:"_item-desc_1cywj_54",link:"_link_1cywj_61",anchor:"_anchor_1cywj_65",icon:"_icon_1cywj_66"};function Fe({list:t,active:o,history:e}){return I.default.createElement(I.default.Fragment,null,t.map(a=>I.default.createElement(k.FlexBox,{className:(0,Jt.default)(D.item,{[D.itemSelect]:o(a.type)}),direction:k.DIRECTION.horizontal,align:k.ALIGN.center,justify:"space-between",onClick:()=>{a.onClick()}},I.default.createElement(k.Box,{className:D.itemContent},I.default.createElement(O.Text,{className:D.itemTitle},c(a.title)),I.default.createElement(O.Text,{className:D.itemDesc},c(a.desc)),a.link?I.default.createElement(k.FlexBox,{className:D.link,direction:k.DIRECTION.horizontal,align:k.ALIGN.center},I.default.createElement(et,{alt:c(a.link.text),rel:"nofollow",onClick:m=>{m.stopPropagation(),m.preventDefault(),nt(),e.push(a.link.url)},className:D.anchor},c(a.link.text)),I.default.createElement(tt,{iconName:"okds-arrow-chevron-right-centered-md",className:D.icon})):null,a.bottomElement??null),o(a.type)?I.default.createElement(st.Circle,{checked:!0}):null)))}var Qt=Fe;r();s();var eo=_(K()),Re=_(Pe()),to=_(me());ne();r();s();var Xt={"recommend-label":"_recommend-label_1iacj_1",recommendLabel:"_recommend-label_1iacj_1"};function oo(){let t=(0,to.useHistory)(),o=(0,Re.useSelector)(ye),e=(0,Re.useSelector)(it);o&&!e&&t.replace(Y)}var ro=({handleClickPasskey:t,handleClickPassword:o,completedOnboarding:e,passwordType:a})=>[{type:2,title:"wallet_extension_biometrics_radio_title_authentication",desc:"wallet_extension_biometrics_radio_desc_authentication",onClick:t,bottomElement:eo.default.createElement("div",{className:Xt.recommendLabel},c("wallet_biometrics_tag_recommend"))},{type:1,title:"wallet_extension_biometrics_radio_title_password",desc:"wallet_extension_biometrics_radio_desc_password",onClick:o,link:e&&a===1?{url:we,text:"wallet_extension_biometrics_btn_change_password"}:null}],so=async({result:t,modifyPassword:o})=>{let e=!1;return e=await o(t?.password),e},ao=!1,io=async()=>await Wt(),no=t=>{};r();s();var q={root:"_root_mpzi1_1",content:"_content_mpzi1_4",title:"_title_mpzi1_7",desc:"_desc_mpzi1_15",list:"_list_mpzi1_22",item:"_item_mpzi1_25","item-select":"_item-select_mpzi1_32",itemSelect:"_item-select_mpzi1_32","item-title":"_item-title_mpzi1_35",itemTitle:"_item-title_mpzi1_35","item-desc":"_item-desc_mpzi1_43",itemDesc:"_item-desc_mpzi1_43",link:"_link_mpzi1_50",anchor:"_anchor_mpzi1_54",icon:"_icon_mpzi1_55",forgot:"_forgot_mpzi1_67"};r();s();r();s();function Vo(){let{verify:t}=Z();return async e=>{await t(a=>{a&&e()})}}var lo=Vo;var co=lo;r();s();var ho=_(K()),Se=_(Pe()),go=_(me());be();_e();r();s();be();_e();var He={[he.addAccount]({hardware:t,account:o,baseChain:e,walletId:a}){return We(),N().addHardwareWalletAccount(t,o,e,a)},[he.addChain]({account:t,baseChain:o,walletId:e}){return N().addChainForHardwareWallet(t,o,e)},others({hardware:t,account:o,baseChain:e}){return We(),N().importHardwareWalletAccount(t,o,e)}},Go={async[L.ledger](t){let{otherInfo:o}=t,{ledgerInfo:e}=o;t.hardwareWalletModel=e.productName||oe[L.ledger]},[L.trezor](t){t.hardwareWalletModel=oe[L.trezor]},[L.keystone](t){let{otherInfo:o}=t,{keystoneInfo:e}=o;t.hardwareWalletModel=e.device||oe[L.keystone]},[L.onekey](t){let{otherInfo:o}=t,{onekeyInfo:e}=o,a=e?.deviceType?`${Lt[L.onekey]} ${Ye(e?.deviceType)}`:"";t.hardwareWalletModel=a||oe[L.onekey]}},mo=({accounts:t,hardware:o,baseChain:e,walletId:a,type:m,...l})=>async()=>{let i;for(let P=0;P<t.length;P++){let p=$e(t[P]);p.otherInfo=l,await Go[o](p),p.hardwareWalletType=oe[o];let S=He[m];S||(i?.walletId?(m=he.addAccount,a=i.walletId,S=He[m]):S=He.others);let A=await S({hardware:o,account:p,baseChain:e,walletId:a});i??=A}return i};r();s();var po=_(me()),fo=_(ce());zo();var jo=()=>{let t=(0,po.useHistory)();return(0,fo.useMemoizedFn)((...o)=>{let e=o[0];t.push({pathname:wt,search:`?type=${at.INITIALIZE}`,...e!==void 0&&{state:{hasPassword:e}}})})},uo=jo;r();s();var yo=_(me()),wo=_(ce());be();r();s();var _o="NEW_USER_JUST_SET";function Ko(){let t=(0,yo.useHistory)(),{isSyncSupported:o,hasSyncEnabled:e,hasWalletDataOnCloud:a,isDataValidated:m}=Yt();return(0,wo.useMemoizedFn)(l=>o&&m&&Ze(e)&&!a&&[w.CREATE,w.SEED,w.KEY].includes(l)?(t.replace({pathname:ht,search:`?user=${_o}&type=${l}`}),l):null)}var Po=Ko;Xe();Me();var Ae=t=>{let o=(0,go.useHistory)(),e=(0,Se.useDispatch)(),a=Po(),m=uo(),{seedPhrase:l,privateKey:i,mpcInfo:P,unlockHardwareWallets:p,chooseNetworkList:S,isTonMnemonic:A}=(0,Se.useSelector)(n=>({seedPhrase:gt(n),isTonMnemonic:Ct(n),privateKey:kt(n),chooseNetworkList:xt(n),mpcInfo:Et(n),unlockHardwareWallets:Tt(n)})),{setValue:F}=Kt(),{value:h}=jt();(t===w.SEED&&!l||t===w.KEY&&!i||t===w.BULK&&!h||t===w.MPC&&(!P||pe(P))||t===w.HARDWARE&&(!p||pe(p)))&&o.push(Y);let d=n=>{if(a(t))return;let u=`${Be}/${t}`,{keyringName:f="",walletName:W=""}=n||{},b=`${f}-${W}`;o.push({pathname:u,state:{walletName:b,anim:"1",next:Y}})},E=async n=>{await e(pt(n)),await e(re()),a(t)||m(!0)},G=async n=>{let u=l?.trim().toLowerCase().match(/\w+/gu)?.join(" ")||"",f=await e(dt(n,{mnemonic:u,isTonMnemonic:A}));e(St()),await e(re()),d(f)},M=async n=>{let u=await e(ft(n,{baseChains:S,privateKey:i}));e(At()),await e(re()),d(u)},j=n=>{F(n),o.push(Pt)},ae=async(n,u)=>{pe(p)||(await N().setPassword(n,!0),await e(z(u?2:1)),await e(H(u)),await e(mo(p)),await e(re()),e(Nt()));let f=`${Be}/${w.HARDWARE}`;ue()===Qe&&globalThis.platform.openExtensionInPopup(`${f}?anim=1`)},R=async n=>{let{cipherText:u,privateKey:f,mpcId:W,userInfo:b}=P;if(u&&f&&W){let B=await e(ut(n,{cipherText:u,privateKey:f},{mpcId:W,userInfo:b},!0));e(It()),await e(re()),d(B)}},Q={[w.CREATE]:E,[w.SEED]:G,[w.KEY]:M,[w.BULK]:j,[w.HARDWARE]:ae,[w.MPC]:R};return(0,ho.useCallback)(async(n,u)=>{try{await Q[t](n,u)}catch(f){le.error(f.message?f.message:JSON.stringify(f))}},[t])};r();s();r();s();var ko=_(Pe());var Yo=()=>{let{create:t}=Z(),e=se().get("from")||w.CREATE,a=Ae(e),m=(0,ko.useDispatch)();return async(...l)=>{await t(async i=>{if(i){let{password:P,credentialId:p}=i;await a(P,p),await m(z(2)),await m(H(p)),te({button_name:"biometric",platform:"extension"})}},...l)}},To=Yo;var Eo=To;var w={SEED:"seed",KEY:"key",HARDWARE:"hardware",CREATE:"create",MPC:"mpc",BULK:"bulk"},$o=()=>{let t=(0,Ve.useHistory)(),o=ue(),e=o===qe||o===Le,a=o===Je,m=o===Le;return{openNotification:()=>{let{pathname:P,search:p}=t.location,S=p?"&":"?",A="openFromThisPage=1";globalThis.platform.openExtensionInPopup(`${P}${p}${S}${A}`,null,!m)},closeNotification:()=>{window.close()},needOpenNotification:e,isNotification:a}};function Zo(){let t=(0,Ve.useHistory)(),o=(0,Ne.useDispatch)(),e=co(),{needOpenNotification:a,isNotification:m,openNotification:l,closeNotification:i}=$o(),P=()=>{a?t.goBack():t.push(Y)},[p]=Te(ke.passwordType),[,S]=Mt(),[A,F]=(0,C.useState)(2),h=fe()===de?"telegram":"extension";(0,J.useMount)(async()=>{await Bt()||F(1)});let d=(0,Ne.useSelector)(ye);oo();let[E,G]=(0,C.useState)(!1);(0,J.useAsyncEffect)(async()=>{try{if(await io(d))return;let U=d?yt:_t;t.replace({pathname:U,search:t.location.search})}finally{G(!0)}},[]);let M=se(),j=M.get("from")||w.CREATE,ae=Ae(j),R=M.get("openFromThisPage")==="1",Q=x=>d?p===x:A===x,[ie,{toggle:n}]=(0,J.useToggle)(!1),[u,{toggle:f}]=(0,J.useToggle)(!1),W=ve(ct),b=ve(lt),{create:B,verify:xo}=Z(),Co=Eo(),So=async()=>{if(a){l();return}Co()},Ao=async()=>{f()},No=async x=>{await B(async U=>{if(U){let Ke=!1,Do=U?.credentialId;n(),Ke=await so({result:U,modifyPassword:N().modifyPassword}),Ke&&(le.success(c("wallet_edit_wallet_toast_renamed_success")),await o(z(2)),S(!0),await o(H(Do)),te({button_name:"biometric",platform:h}),m&&R&&i())}},ao?x:"")},Ge=async x=>{let U=null;x?(f(),U=await N().modifyPassword(x)):U=!0,U&&(le.success(c("wallet_edit_wallet_toast_renamed_success")),await o(z(1)),S(!0),await o(H(void 0)),te({button_name:"password",platform:h}),m&&R&&i())},Io=()=>{if(!d){F(2);return}if(d&&p===2){t.goBack();return}if(a){l();return}n()},bo=async()=>{if(!d){F(1);return}if(d&&p===1){t.goBack();return}if(a){l();return}await xo(x=>{x&&f()})},Lo=()=>{n()},Mo=async()=>{await e(f,Ge)},[Wo,Ie]=(0,C.useState)(!1),Bo=async()=>{try{Ie(!0),A===2?(await So(),W()):(await Ao(),b())}catch{Ie(!1)}finally{Ie(!1)}},je=async x=>{no(x),x?Lo():Mo()},Uo=()=>{t.push({pathname:we})},Oo=()=>ro({handleOpenVerify:je,handleSetPassword:Uo,handleClickPasskey:Io,handleClickPassword:bo,completedOnboarding:d,passwordType:p});if(!E)return null;if(ie)return C.default.createElement(Ht,{onBack:n,callback:No});if(u)return C.default.createElement(qt,{onBack:f,onComplete:async x=>{d?await Ge(x):(await ae(x),await o(z(1)),await o(H(void 0)),te({button_name:"password",platform:h}))}});let vo={list:Oo(),active:Q,passwordType:p,history:t,handleOpenVerify:je};return C.default.createElement(k.Box,{className:q.root},C.default.createElement(Rt,{bordered:!1,closeable:!1,onBack:P}),C.default.createElement(k.Container,{className:q.content},C.default.createElement(O.Text,{className:q.title},c("wallet_extension_biometrics_header_title_unlock")),C.default.createElement(O.Text,{className:q.desc},c("wallet_extension_biometrics_desc_unlock")),C.default.createElement(k.Box,{className:q.list},C.default.createElement(Qt,{...vo})),C.default.createElement(ge.FooterActions,null,d?C.default.createElement(zt,{className:q.forgot,strong:!0}):C.default.createElement(g,{block:!0,category:g.CATEGORY.fill,type:g.TYPE.highlight,size:g.SIZE.lg,loading:Wo,onClick:()=>{Bo()}},c("commonall_button_text_next")))))}export{qt as a,mo as b,uo as c,Po as d,Eo as e,w as f,Zo as g};

window.inOKXExtension = true;
window.inMiniApp = false;
window.ASSETS_BUILD_TYPE = "publish";

//# sourceMappingURL=chunk-K7CEH6LH.js.map
