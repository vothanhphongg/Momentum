import{a as S,b as V}from"./chunk-AW5NL3JM.js";import{a as v}from"./chunk-7HFBMBFB.js";import{Gb as N,Rb as M,c as H,e as U,f as W,g as O,j as E,k as j,vb as P,zb as F}from"./chunk-HPWCPLRR.js";import{k,l as G}from"./chunk-3DZ7WRLL.js";import{I as h,K as I,P as B,R as w,ad as K,ha as D,rd as X}from"./chunk-TM67VPZU.js";import{ka as A,ra as R}from"./chunk-XDY6V34Y.js";import{f as q,o as C,q as p}from"./chunk-6KXF36WM.js";C();p();function z(e){return Object.keys(e).sort().reduce((n,t)=>(n[t]=e[t]instanceof Object?z(e[t]):e[t],n),{})}function ge(e){let n=z(e);return JSON.stringify(n)}function me(e){if(!e||typeof e!="object")return null;let n={...e};for(let t in n)(n[t]===null||n[t]===void 0)&&delete n[t];return n}function J({coins:e,walletId:n,walletIdentityMap:t,createdMap:r}){let o=r[n]||[],c=new Set(o.map(({coinId:a})=>a));return e.reduce((a,i)=>{let{coinId:s,baseCoinId:m}=i;return(typeof s>"u"&&typeof m>"u"||(c.has(m)||c.has(s))&&S({coin:i,walletIdentity:t[n]}))&&a.push(i),a},[])}C();p();R();var f=q(H());C();p();R();D();C();p();var L=e=>({...e,currencyAmount:"0",currencyAmountUSD:"0",coinAmount:"0",coinAmountInt:"0"});function T(e,n,t){let r=null,o=n[e.coinId];e.coinAmount==="0"||o=="0"?r="0":typeof o<"u"&&(r=h(e.coinAmount,o)),e.currencyAmountUSD=r??e.currencyAmountUSD,e.currencyAmount=h(e.currencyAmountUSD,t?.usdToThisRate??"1")}function we(e,n,{sort:t=!0}={}){let r=[],o=[];e.forEach(a=>{let i={...a};if(i.childrenCoin){if(i.childrenCoin.filter(m=>n(m,i.default)).length===0){o.push(i);return}r.push(i)}else{if(!n(i,i.default)){o.push(i);return}r.push(i)}});let c=(a,i)=>w(i.currencyAmount,a.currencyAmount)?w(i.coinAmount,a.coinAmount)?B(a.rank,i.rank)?1:-1:B(i.coinAmount,a.coinAmount)?1:-1:B(i.currencyAmount,a.currencyAmount)?1:-1;return t?(r.sort(c),o.sort(c),{results:r,uselessResults:o}):{results:r,uselessResults:o}}var Z=[];function Me(e,n,t,{walletIdentityMap:r,createdMap:o,walletId:c}){if(!e[n])return Z;let a=e[n]??{},i=a.coins?[...a.coins]:[],s=i.reduce((u,d)=>(u.set(d.aggregation?d.symbol:d.coinId,d),u),new Map),m=J({coins:t,walletId:c,walletIdentityMap:r,createdMap:o}),l=new Map,g=[];return m.forEach(u=>{let d=L(u);if(u.aggregation){if(!l.get(u.symbol)){let x={...d,childrenCoin:[]};l.set(u.symbol,x),g.push(x)}l.get(u.symbol).childrenCoin.push(d)}else g.push(d)}),g.forEach(u=>{let d=s.get(u.aggregation?u.symbol:u.coinId);d?d.aggregation&&(d.childrenCoin=A(d.childrenCoin,u.childrenCoin,"coinId")):i.push(u)}),i}C();p();G();var _=k({name:"currencySlice",initialState:{coinToUSDRate:{}},reducers:{updateCoinToUSDRate(e,n){e.coinToUSDRate=n.payload}}}),$={},Q=e=>e.currencySlice.coinToUSDRate||$,{actions:ee,reducer:ne}=_,{updateCoinToUSDRate:ke}=ee,Ue=ne;X();D();var y=(e,n)=>n??P(e),te=(0,f.createSelector)(e=>e.keyring.keyringIdentities,y,(e,n)=>{let t;for(let r=0;r<e.length;r++){let o=e[r];if(o.walletIdentities.find(c=>c.walletId===n)){t=o.keyringIdentityType;break}}return t===K.PRIVATE_KEY}),re=(0,f.createSelector)(e=>{let{createdMap:n={}}=e.metamask;return n},y,te,M,(e,n,t,r)=>{if(!t)return new Set([]);let o=e[n]||[];return new Set(o.map(({coinId:a})=>a))}),oe=(0,f.createSelector)(re,M,(e,n)=>n.filter(t=>e.has(t.coinId))),ie=v(e=>({keyringIdentities:e.keyring.keyringIdentities,createdMap:e.metamask.createdMap}),y,(e,n)=>{let{keyringIdentities:t,createdMap:r}=e;return{walletIdentityMap:F({keyring:{keyringIdentities:t}}),createdMap:r,walletId:n}}),ae=(0,f.createSelector)(y,W,(e,n)=>n?.[e]??[]),Ye=(0,f.createSelector)(y,O,(e,n)=>n?.[e]??[]),qe=(0,f.createSelector)(ae,oe,(e,n)=>A(n,e,"coinId")),ce=(e,n,t,r,o)=>{let c=[];return e.forEach(a=>{let i=a.childrenCoin?.length||0,s={...t[a.coinId]??{},...a};if(s.childrenCoin){let m=s.childrenCoin.filter(g=>n.has(g.chainId)).map(g=>({...g,...t[g.coinId]??{}})),l=V({coins:m,walletIdentity:o[r]});if(l.length===0)return;l.length!==i&&Object.assign(s,l[0]),s.childrenCoin=l}else if(!S({coin:s,walletIdentity:o[r]})||!n.has(s.chainId))return;c.push(s)}),c};function se(e,n,t){e.forEach(r=>{r.childrenCoin?(r.childrenCoin.forEach(o=>{T(o,n,t)}),r.currencyAmountUSD=r.childrenCoin.reduce((o,c)=>c.currencyAmountUSD?I(o,c.currencyAmountUSD):o,"0"),r.currencyAmount=h(r.currencyAmountUSD,t?.usdToThisRate??"1"),r.coinAmount=r.childrenCoin.reduce((o,c)=>I(o,c.coinAmount),"0"),r.coinAmountInt=r.childrenCoin.reduce((o,c)=>I(o,c.coinAmountInt),"0")):T(r,n,t)})}var ue=(e,n,t,r,o,c,a)=>{let{coins:i,...s}=e,l=ce(i??[],n,t,r,o);return se(l,c,a),{...s,coins:l,loading:!i}},Y={},Ge=(0,f.createSelector)((e,n,t)=>t?{[t.balanceData.walletId]:t.balanceData}:e.metamask.balancesMap??e.balanceSlice.balanceMap,U,j,E,ie,N,Q,y,(e,n,t,r,o,c,a,i)=>{if(!t||!Object.keys(e).length||!n?.length||Object.values(e)?.[0]?.v!==2)return Y;let{walletIdentityMap:s}=o,m=new Set(n);return Object.entries(e).reduce((l,[g,u])=>(i&&g!==i||u?.v!==2||(l[g]=ue(u,m,r,g,s,a,c)),l),{})});export{ke as a,Ue as b,ge as c,me as d,J as e,L as f,we as g,Me as h,y as i,re as j,oe as k,ie as l,ae as m,Ye as n,qe as o,Ge as p};

window.inOKXExtension = true;
window.inMiniApp = false;
window.ASSETS_BUILD_TYPE = "publish";

//# sourceMappingURL=chunk-7SRLIN7D.js.map
