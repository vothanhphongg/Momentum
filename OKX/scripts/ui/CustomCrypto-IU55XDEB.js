import{a as Ze}from"./chunk-HHQEFPQ4.js";import"./chunk-N5DH5ULG.js";import{a as Ye}from"./chunk-ZE645RND.js";import{a as re}from"./chunk-6Y7SZIB7.js";import{a as oe}from"./chunk-UUWJWUOY.js";import{a as Re,b as je}from"./chunk-O3O4HNQA.js";import"./chunk-LR7KSTP2.js";import"./chunk-QCP7SXMX.js";import"./chunk-W23ABSXX.js";import"./chunk-R6X7EOIE.js";import"./chunk-4EFZXPDV.js";import"./chunk-4KODREVA.js";import"./chunk-6UWGBJGT.js";import"./chunk-76CRIMII.js";import"./chunk-YJQGXXOQ.js";import"./chunk-HTLOGWI7.js";import"./chunk-6SEP5B7P.js";import"./chunk-FHKOH5E6.js";import"./chunk-NTQ2YVDA.js";import"./chunk-KKG4PJ6O.js";import"./chunk-7SRLIN7D.js";import"./chunk-AW5NL3JM.js";import"./chunk-RI2WZ5PA.js";import"./chunk-YIAOHVF5.js";import{a as ze}from"./chunk-KBS3PMLQ.js";import"./chunk-7GKX3YKG.js";import"./chunk-7HFBMBFB.js";import"./chunk-TJCPJQIM.js";import"./chunk-ZTAZ2272.js";import"./chunk-IRMYAC6R.js";import"./chunk-Q76QXAWY.js";import"./chunk-THSNJ5WU.js";import"./chunk-PDC447BO.js";import"./chunk-JCM7SRK2.js";import{a as He}from"./chunk-PTD7UCOR.js";import"./chunk-ETJEH7T4.js";import{a as Ue}from"./chunk-V3IFYKWM.js";import{a as H}from"./chunk-EWTTD4DL.js";import"./chunk-Y2TPPS4H.js";import"./chunk-ITY22AD4.js";import"./chunk-E2JYOUYE.js";import"./chunk-B3JSNQIV.js";import{H as Me,a as Ae,k as Le,l as Be}from"./chunk-YALUYHLV.js";import{q as W}from"./chunk-I3CPAVOC.js";import"./chunk-ARWSGU73.js";import"./chunk-CZ2ZBAZV.js";import{o as Oe}from"./chunk-5QMHGZLF.js";import{H as D}from"./chunk-HPWCPLRR.js";import"./chunk-TSTPZ3JM.js";import"./chunk-D2LKUI4F.js";import{a as ue}from"./chunk-ON6S2DB7.js";import"./chunk-SZD6WTBQ.js";import"./chunk-ASR4HLU7.js";import"./chunk-ANIUN6US.js";import"./chunk-3DZ7WRLL.js";import"./chunk-DEOJU4Z3.js";import"./chunk-PLIIQKFY.js";import{l as Fe}from"./chunk-XV444F26.js";import"./chunk-N2BCRNDB.js";import"./chunk-RTFE54S3.js";import"./chunk-GCQ4H2BA.js";import"./chunk-UVFOW4HH.js";import"./chunk-LNOPECCQ.js";import"./chunk-CB7FOZNP.js";import{c as v}from"./chunk-43VURGIT.js";import{Nc as Pe,Qb as we,Sb as ve,Sc as Ct,ac as L,cc as Se,fc as Ne,gc as De,mb as te,rc as G}from"./chunk-TM67VPZU.js";import"./chunk-VW6OQNWT.js";import{H as ee,e as me,h as q,o as Ee,q as g,w as de}from"./chunk-PUSMMCUD.js";import{E as z,R as N,z as n}from"./chunk-UWJLNJLY.js";import"./chunk-VRY2ADKE.js";import"./chunk-5U7FO2PW.js";import"./chunk-PDUOSATP.js";import{H as xe,ra as ft}from"./chunk-XDY6V34Y.js";import"./chunk-YJFNO57I.js";import"./chunk-DZ6CTC22.js";import{$ as be,W as Te,c as gt,ea as T}from"./chunk-JT3LNHPY.js";import"./chunk-47UWF72W.js";import{b as w}from"./chunk-JWYCKY2V.js";import"./chunk-G2266BV2.js";import"./chunk-L4PAIYPH.js";import"./chunk-UT7LJPKF.js";import"./chunk-AFZ6A2B3.js";import"./chunk-VVPY7ZA7.js";import"./chunk-KUW5VATV.js";import"./chunk-BNAVWOJ2.js";import"./chunk-IG2Q5ALZ.js";import"./chunk-WOMUNWBT.js";import"./chunk-F6PXOVYL.js";import"./chunk-324EPGNQ.js";import"./chunk-5GFHI4AK.js";import"./chunk-QYVQBXDG.js";import"./chunk-7D4PUIEN.js";import"./chunk-IWVM7XL6.js";import"./chunk-7QO4TZYQ.js";import"./chunk-FF4LY6PE.js";import"./chunk-76KCDJDG.js";import"./chunk-YDUDQP2P.js";import"./chunk-PGPFV4JQ.js";import"./chunk-MIBHDVGP.js";import"./chunk-7VFUX7IX.js";import"./chunk-XLF4LAH2.js";import"./chunk-ONKZ57T6.js";import"./chunk-ZC7Q7LCH.js";import{f as u,o as r,q as i}from"./chunk-6KXF36WM.js";r();i();var s=u(w()),nt=u(ue());N();r();i();var B=u(w()),ie=u(ue()),qe=u(gt());N();var yt=(e,t)=>{let o=e==="protocol"?Be:Le;if(t){let a=new URLSearchParams(t).toString();return`${o}?${a}`}return o},It=({selectedInfo:e,category:t})=>{let o=(0,ie.useHistory)(),a=(0,ie.useLocation)(),l=new URLSearchParams(a.search);return B.default.createElement("div",{"data-testid":H.CUSTOM_COIN_PAGE.NETWORK_SELECTOR,className:"chain-select",onClick:()=>{let c={...Object.fromEntries(l.entries()),pageType:"customCrypto"};o.push(yt(t,c))}},B.default.createElement("div",{className:"chain-select-title"},t==="protocol"?n("extension_defi_info_title_protocol"):n("wallet_custom_crypto_subtitle_select_network")),B.default.createElement("div",{className:"chain-select-box","aria-label":t==="protocol"?"protocol-select-box":"chain-select-box",role:"button"},t==="protocol"?null:B.default.createElement("img",{className:"chain-select-icon",src:e?.imageUrl||e?.logo,alt:""}),B.default.createElement("div",{className:"chain-select-name"},e?.name),B.default.createElement(Te,{className:(0,qe.default)("okds-arrow-chevron-right-centered-md","chain-select-arrow")})))},ne=It;r();i();var _e=u(w());var ht=({currentAddress:e,addressInputTitle:t,errorText:o,placeHolderText:a,addressIsInvalid:l,updateCustomCoin:c})=>_e.default.createElement("div",{className:"contract-address-box"},_e.default.createElement(g.TextArea,{"data-testid":H.CUSTOM_COIN_PAGE.CONTRACT_ADDRESS_INPUT,autoResize:!0,value:e,title:t,size:g.SIZE.xl,error:l&&o,errorType:g.TIP_TYPE.always,placeholder:a,onChange:p=>{c(p.target.value)}})),Ge=ht;r();i();var y=u(w());N();r();i();var M={"risk-dialog-footer":"_risk-dialog-footer_1jyn7_1",riskDialogFooter:"_risk-dialog-footer_1jyn7_1","risk-dialog-content":"_risk-dialog-content_1jyn7_4",riskDialogContent:"_risk-dialog-content_1jyn7_4","risk-dialog-confirm-btn":"_risk-dialog-confirm-btn_1jyn7_7",riskDialogConfirmBtn:"_risk-dialog-confirm-btn_1jyn7_7","risk-dialog-title":"_risk-dialog-title_1jyn7_16",riskDialogTitle:"_risk-dialog-title_1jyn7_16","risk-dialog-desc":"_risk-dialog-desc_1jyn7_22",riskDialogDesc:"_risk-dialog-desc_1jyn7_22","risk-dialog-jump-link":"_risk-dialog-jump-link_1jyn7_25",riskDialogJumpLink:"_risk-dialog-jump-link_1jyn7_25"};var kt=({onCloseDialog:e,onNext:t,riskJumpUrl:o})=>{let a=ze(),l=(0,y.useCallback)(()=>{o&&setTimeout(()=>{globalThis.platform.openTab({url:`${a.origin}${o}`})},100)},[o]);return y.default.createElement(Ee,{visible:!0,title:!1,footer:y.default.createElement(v.FlexBox,{className:M.riskDialogFooter,direction:v.DIRECTION.vertical,align:v.ALIGN.center},y.default.createElement(T,{category:T.CATEGORY.outline,type:T.TYPE.primary,size:T.SIZE.lg,block:!0,onClick:e},z("commonall_text_btn_cancel")),y.default.createElement("span",{className:M.riskDialogConfirmBtn,onClick:t},z("wallet_extension_risk_alert_btn_continue_add"))),noMargin:!0,isFull:!0,hideCloseBtn:!0},y.default.createElement(v.FlexBox,{direction:v.DIRECTION.vertical,align:v.ALIGN.center,justify:"center",className:M.riskDialogContent},y.default.createElement(me,{width:100,height:100,src:"/static/images/risk-warning.png",layout:me.LAYOUT.contain}),y.default.createElement(W.Text,{strong:500,className:M.riskDialogTitle},z("wallet_extension_risk_alert_title_approve_eoa")),y.default.createElement(W.Text,{size:W.SIZE.sm,type:W.TYPE.secondary,strong:400,className:M.riskDialogDesc},z("wallet_extension_risk_alert_desc_approve_eoa",{detail:""})),o&&y.default.createElement(q,{type:q.TYPE.primary,underline:!0,weight:q.WEIGHT.muted,size:q.SIZE.md,onClick:l,className:M.riskDialogJumpLink},z("wallet_extension_risk_alert_icu_approve_eoa"))))},We=kt;r();i();Ct();G();var pe={[L]:{title:"wallet_extension_create_input_title_contract_token_symbol",error:"developer_mode_manage_errortip_request_failed",placeholder:"extension_token_input_addcustom_crypto"},[Pe]:{title:"extension_wallet_customcoin_text_currency_symbol",error:"extension_wallet_customcoin_errortip_crypto_notfound",placeholderName:"extension_defi_placeholder_enter_token_name",placeholderId:"extension_defi_placeholder_enter_token_id",placeholder:"extension_defi_placeholder_enter_token_id_name"},[ve]:{title:"extension_wallet_customcoin_text_currency_symbol",titleId:"wallet_extension_cat_desc_token_id",error:"extension_wallet_customcoin_errortip_crypto_notfound",placeholderName:"extension_defi_placeholder_enter_token_name",placeholderId:"extension_defi_placeholder_enter_token_id",placeholder:"extension_defi_placeholder_enter_token_id_name"},[Se]:{title:"extension_wallet_cardano_text_fingerprint",error:"developer_mode_manage_errortip_request_failed",placeholder:"extension_token_input_addcustom_crypto"},[Ne]:{title:"wallet_extension_import_title_jetton_master",error:"developer_mode_manage_errortip_request_failed",placeholder:"wallet_extension_import_input_jetton_master"},[De]:{title:"wallet_extension_selecttoken_input_label_asset_issuer",placeholder:"wallet_extension_selecttoken_input_placeholder_issuer_name",symbolTitle:"wallet_extension_selecttoken_input_label_asset_code",symbolPlaceholder:"wallet_extension_selecttoken_input_placeholder_asset_code",error:"developer_mode_manage_errortip_request_failed"},default:{title:"wallet_transaction_history_subtitle_contract_address",error:"developer_mode_manage_errortip_request_failed",placeholder:"extension_token_input_addcustom_crypto"}};r();i();var j=u(w());N();G();r();i();var R=u(w());N();var xt=({isFacet:e,onToggle:t})=>{let o=[{value:"ERC20",label:"ERC20"},{value:"Facet",label:"Facet"}],[a,l]=(0,R.useState)(e?"Facet":"ERC20"),c=(0,R.useCallback)((p={value:"ERC20"})=>{l(p.value),t(p.value==="Facet")},[]);return R.default.createElement("div",{className:"chain-select-isfacet"},R.default.createElement(de,{title:n("extension_defi_info_title_protocol"),value:a,options:o,onChange:c,size:de.SIZE.xl,searchable:!1,dropMode:!0}))},Ve=xt;var Tt=({selectedNetwork:e,account:t,accountIsInvalid:o,accountErrorMessage:a,setAccount:l,updateCustomCoin:c,accountRef:p,setProtocol:I,protocol:k,protocolList:f,isFacet:x,setIsFacet:C})=>{let U=oe(),d=Number(U.get("protocolId"));return(0,j.useEffect)(()=>{let m=null;if(!D(e)){I("");return}if(d&&f?.length&&(m=f.find(E=>E.protocolId===d)),!m&&f.length>0&&(m=f[0]),m){let E={...m,name:m.protocolName};I(E)}},[f,e]),{renderCustomForm:()=>e?.coinId===L?j.default.createElement("div",{className:"contract-address-box"},j.default.createElement(g.TextArea,{autoResize:!0,value:t,title:n("wallet_extension_create_input_title_contract_account_name"),size:g.SIZE.xl,error:o&&a,errorType:g.TIP_TYPE.always,placeholder:n("wallet_extension_create_input_title_contract_token_symbol"),onChange:m=>{l(m.target.value),p.current=m.target.value,c()}})):e?.coinId===we?j.default.createElement(Ve,{isFacet:x,onToggle:m=>{C(m),c()}}):D(e)&&k?j.default.createElement(ne,{selectedInfo:k,category:"protocol"}):null}},$e=Tt;r();i();var P=u(w()),Ke=u(Oe());ft();G();var bt=({selectedNetwork:e,currentAddress:t,isFacet:o,currentAddressRef:a,currentSymbolRef:l,accountRef:c,protocol:p})=>{let[I,k]=(0,P.useState)({}),[f,x]=(0,P.useState)(!1),[C,U]=(0,P.useState)(""),[d,b]=(0,P.useState)(!0),[m,E]=(0,P.useState)(""),[O,F]=(0,P.useState)(!1),[Ce,V]=(0,P.useState)(!1),Y=h=>`facet_${h}`,{run:$}=(0,Ke.useDebounceFn)(async({addr:h,accountName:K,protocolId:Q,symbol:J})=>{if(V(!1),!h)return;let X=re(e.coinId);if(X&&xe(J))return;let S;try{S=await Re({contractAddress:o?Y(h):h,chainInfo:e,account:K,isFacet:o,...D(e)?{protocolId:Q}:{},...X?{symbol:J}:{}})}catch(le){S={},le?.data?.originalError?.data?.code==="ERR_NETWORK"&&V(!0)}if(h===t){if(k(S),e.coinId===L&&!S?.accountValid){x(!0),U(S.msg),b(!0);return}else if(!m&&e?.coinId===L){F(!1),b(!0);return}x(!1),U(""),h&&S?.symbol?(F(!1),b(!1)):h?(F(!0),b(!0)):(F(!1),b(!0))}},{wait:500});return{customCoin:I,accountIsInvalid:f,accountErrorMessage:C,stateOnLock:d,account:m,addressIsInvalid:O,setAccount:E,updateCustomCoin:()=>{k({}),b(!0),$({addr:a.current,accountName:c.current,protocolId:p?.protocolId,symbol:l.current})},networkError:Ce}},Qe=bt;r();i();var Je=u(ue()),se=u(Oe());N();r();i();function Et(e,t){if(e.key&&t.key)return e.key===t.key;if(e.coinId&&t.coinId)return e.coinId===t.coinId;let o=e.address||e.contractAddress,a=t.address||t.contractAddress;return o&&a?o.toLowerCase()===a.toLowerCase()&&e.localType===t.localType:!1}function fe(e,t){for(let o=0;o<t.length;o++){let a=t[o];if(Et(a,e)||a.childrenCoin&&fe(e,a.childrenCoin))return!0}return!1}function ge(e,t){let o=(0,Je.useHistory)(),[a,{setTrue:l,setFalse:c}]=(0,se.useBoolean)(),p=Ye(),{run:I}=(0,se.useDebounceFn)(async()=>{if(l(),fe(e,p)){ee.error(n("wallet_manage_crypto_errortip_crypto_added")),c();return}try{await je({...e,protocolId:t}),ee.success(n("wallet_manage_crypto_toast_custom_crypto_success")),o.push(Ae)}catch(f){let x=f?.data?.originalError?.msg||n("wallet_extenshion_toast_add_failed");ee.error(x)}finally{c()}},{wait:100});return{isSubmitting:a,submitAction:I}}r();i();r();i();var et=u(w());N();G();r();i();var Xe={root:"_root_11n0d_1"};var wt=(e,t,o)=>re(t.coinId)?{show:!0,value:o,disabled:!1}:e?.localType===te?{show:!1,value:e?.symbol,disabled:!0}:{show:e?.symbol!==void 0,value:e?.symbol,disabled:!0},vt=({customCoin:e={},selectedNetwork:t,onChange:o,value:a,title:l,placeholder:c})=>{let p=x=>{o?.(x.target.value)},{show:I,value:k,disabled:f}=wt(e,t,a);return I&&et.default.createElement(g,{className:Xe.root,label:l||n("wallet_manage_crypto_subtitle_custom_crpto_symbol"),placeholder:c,disabled:f,value:k,size:g.SIZE.xl,onChange:p})},tt=vt;r();i();var rt=u(w());N();G();r();i();var ot={root:"_root_11n0d_1"};var St=({customCoin:e}={})=>e?.decimals===void 0||e?.localType===te?null:rt.default.createElement(g,{className:ot.root,label:n("wallet_manage_crypto_custom_coin_subtitle_decimals"),disabled:!0,value:e.decimals,size:g.SIZE.xl}),it=St;var Nt="Ethereum",Dt=()=>{let e=(0,nt.useHistory)(),t=s.default.useRef(""),o=s.default.useRef(""),a=s.default.useRef(""),l=s.default.useRef(""),[c,p]=(0,s.useState)(!1),[I,k]=(0,s.useState)(""),[f,x]=(0,s.useState)(""),[C,U]=(0,s.useState)(""),[d,b]=(0,s.useState)({imageUrl:"",name:"",coinId:-1}),[m,E]=(0,s.useState)(!1),{data:{supportNetworkList:O,protocolList:F}={}}=Ze(d.coinId),V=oe().get("network"),{title:Y,titleId:$,error:ae,placeholder:h,placeholderName:K,placeholderId:Q,symbolTitle:J,symbolPlaceholder:X}=pe[d?.coinId]||pe.default,S=(0,s.useMemo)(()=>D(d)&&C?.searchType?C.searchType===1?n(Y):n($):n(Y),[C.searchType,d,Y,$]),le=(0,s.useMemo)(()=>D(d)&&C?.searchType?C.searchType===1?n(K):n(Q):n(h),[h,Q,K,C.searchType,d?.coinId]),{customCoin:Z,accountIsInvalid:ye,accountErrorMessage:st,stateOnLock:at,account:lt,addressIsInvalid:Ie,setAccount:ct,updateCustomCoin:ce,networkError:he}=Qe({selectedNetwork:d,currentAddress:I,currentSymbol:f,isFacet:c,currentAddressRef:a,currentSymbolRef:l,accountRef:t,protocol:C}),mt=(0,s.useMemo)(()=>he?n("developer_mode_manage_errortip_network_error"):n(ae),[ae,he]),{renderCustomForm:dt}=$e({selectedNetwork:d,account:lt,accountIsInvalid:ye,accountErrorMessage:st,setAccount:ct,updateCustomCoin:ce,accountRef:t,protocolRef:o,setProtocol:U,protocol:C,protocolList:F,isFacet:c,setIsFacet:p}),{isSubmitting:ut,submitAction:ke}=ge(Z,C.protocolId);return(0,s.useEffect)(()=>{async function A(){if(O.length>0){let _t=V||Nt;b(O.filter(pt=>pt.name===_t)[0]||O[0])}}A()},[O]),s.default.createElement("div",{className:"custom-crypto-page main-container"},s.default.createElement(He,{title:n("wallet_manage_crypto_maintitle_custom_crypto"),onBack:()=>{e.push(Me)}}),s.default.createElement(v.Spin,{loading:!O?.length||!F?.length,size:be.SIZE.lg},s.default.createElement("div",{className:"custom-crypto--body"},s.default.createElement(ne,{selectedInfo:d}),dt(),s.default.createElement(Ge,{updateCustomCoin:A=>{a.current=A,k(A),ce()},currentAddress:I,addressInputTitle:S,errorText:mt,placeHolderText:le,addressIsInvalid:Ie}),s.default.createElement(tt,{title:n(J),placeholder:n(X),customCoin:Z,value:f,selectedNetwork:d,onChange:A=>{l.current=A,x(A),ce()}}),s.default.createElement(it,{customCoin:Z})),s.default.createElement(Ue.FooterActions,{usePortal:!0},s.default.createElement(T,{"data-testid":H.CUSTOM_COIN_PAGE.ADD_COIN_CONFIRM_BUTTON,onClick:()=>{Z.riskType===Fe.NORMAL?ke():E(!0)},size:T.SIZE.lg,type:T.TYPE.highlight,category:T.CATEGORY.fill,loading:ut,disabled:Ie||at||ye},n("wallet_set_password_btn_confirm")))),m&&s.default.createElement(We,{onCloseDialog:()=>{E(!1)},onNext:()=>{E(!1),ke()},riskJumpUrl:Z.riskJumpUrl}))},Zr=Dt;export{Zr as default};

window.inOKXExtension = true;
window.inMiniApp = false;
window.ASSETS_BUILD_TYPE = "publish";

//# sourceMappingURL=CustomCrypto-IU55XDEB.js.map
