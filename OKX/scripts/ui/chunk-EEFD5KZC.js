import{f as bt,h as Bo,i as Wo,k as Uo}from"./chunk-73ZHJYCP.js";import{a as ke}from"./chunk-3NSLXJYR.js";import{a as bo}from"./chunk-ENPNPH37.js";import{b as ko,e as No}from"./chunk-5QJIR6ZJ.js";import{a as nt,b as Oo,c as vo,d as Ne,e as Le,f as Zt,g as Lo,j as E,k as Mo,l as R,o as Vo}from"./chunk-YWECPG37.js";import{a as tt}from"./chunk-R5SMHBLJ.js";import{b as Qt}from"./chunk-34VLVCKN.js";import{a as So,c as go,d as Co,e as vt,k as Io}from"./chunk-J4ZKBKEJ.js";import{a as Do}from"./chunk-TFJRUJHH.js";import{a as Fo}from"./chunk-7NMUCCUG.js";import{a as lo,c as mo,e as To,f as Xt,i as x}from"./chunk-YF3DWJDS.js";import{b as co,g as S,h as p}from"./chunk-RH4ISAHA.js";import{a as Ao,d as De,h as Eo}from"./chunk-ECQND2NK.js";import{a as po}from"./chunk-W3L3YTJO.js";import{c as zt,d as ao}from"./chunk-M5NI6HPE.js";import{a as Z,b as be,e as uo,f as ho}from"./chunk-VM2NMLPX.js";import{a as yo,b as _o,c as wo,d as Ro,e as Po,f as Jt,g as xo}from"./chunk-YP7CHBKG.js";import{a as fo}from"./chunk-FNXLAYUB.js";import{a as b,c as ve,e as J,g as K,h as Ot,j as Yt,k as io,u as U,w as no}from"./chunk-PQK3LXXN.js";import{$c as Fe,B as Cr,Cb as Or,Fb as vr,H as Rt,Hb as br,Ib as Dr,Jb as kr,K as Pt,Ka as _e,Kb as xe,L as Ir,La as we,Lb as Nr,M as Ae,Ma as _r,Na as X,Oa as V,Pc as eo,S as at,Sc as ro,T as Ee,U as Ar,Ub as Lr,V as Er,Wb as Fr,X as yr,Xb as Mr,Yb as Br,Yc as oo,Zb as Wr,Zc as I,ab as Re,ac as Ur,bb as _,bc as Vr,cb as k,eb as wr,gc as Hr,ha as $t,hc as Gr,ia as xt,ic as qr,jc as Oe,ka as Y,kc as jr,la as mt,lc as $r,ma as Et,mc as Kr,nb as Q,nc as zr,ob as Pe,p as q,pa as it,pb as Rr,pc as Yr,qb as Pr,rc as Xr,s as gr,sa as ye,sc as Qr,uc as Jr,vb as C,wc as Zr,xb as xr,zc as to}from"./chunk-FTRHGHDS.js";import{b as so,c as Kt}from"./chunk-XT3EOPTE.js";import{A as Sr,B as A,a as ur,b as hr,c as wt,d as fr,f as Gt,g as qt,i as pr,j as N,k as st,l as It,m as At,n as jt,p as Tr}from"./chunk-A6Z53EN6.js";import{a as Os}from"./chunk-O6ZBO5JF.js";import{a as Ie}from"./chunk-ON6S2DB7.js";import{G as Ct,H as $,a as xs,o as mr}from"./chunk-PUSMMCUD.js";import{C as Ce,D as lr,G as D,R as ot,a as dr}from"./chunk-UWJLNJLY.js";import{C as ir,D as Vt,H as nr,K as cr,L as _t,f as ar,ga as Ht,j as T,la as Se,ma as ge,ra as j,w as Te}from"./chunk-XDY6V34Y.js";import{$ as W}from"./chunk-JT3LNHPY.js";import{b as F}from"./chunk-JWYCKY2V.js";import{f as w,h as o,o as n,q as c}from"./chunk-6KXF36WM.js";n();c();n();c();n();c();n();c();var Ho=w(F());ot();function Me({children:l,...t}){return Ho.default.createElement(lr,{fetchConfig:oo.fetchConfig,...t},l)}n();c();var lt=w(F()),Ut=w(Ie());n();c();n();c();var fe=w(F());n();c();n();c();n();c();j();n();c();var te=[_.BTC_MAINNET,_.TON_MAINNET];n();c();var Go=(l,t)=>{let e=l.split(".").map(Number),r=t.split(".").map(Number),s=Math.max(e.length,r.length);for(let a=0;a<s;a++){let i=e[a]||0,d=r[a]||0;if(i>d)return 1;if(i<d)return-1}return 0};var Dt=class{constructor(){o(this,"commonStore",null);o(this,"userForbiddenWithBridge",Ae);o(this,"setUserForbiddenBridge",t=>{this.userForbiddenWithBridge=t});o(this,"defaultWalletConfig",Pr);o(this,"walletConfig",this.defaultWalletConfig);o(this,"hasInitWalletInfo",!1);o(this,"chainId",nt);o(this,"setChainId",t=>{this.chainId=t});o(this,"fromChainId",nt);o(this,"setFromChainId",t=>{this.fromChainId=t});o(this,"addressType","");o(this,"setAddressType",t=>{this.addressType=t});o(this,"walletSupportMev",!1);o(this,"setWalletSupportMev",t=>{this.walletSupportMev=t});o(this,"checkOkxVersion",async()=>{let t="2.82.31",e=this.walletConfig.isOkxWallet;if(this.isConnectedWallet&&e&&window?.okxwallet?.getVersion){let r=await window.okxwallet.getVersion(),a=Go(r,t)>=0;this.setWalletSupportMev(a)}else this.setWalletSupportMev(!1)});o(this,"signWalletChainId",_.ETHEREUM_MAINNET)}getDeviceId(){}getChainId(){}get scanAppType(){throw new Error("scanAppType is not defined")}get walletType(){throw new Error("walletType is not defined")}get address(){return nt}get computedForbiddenBridge(){let{computedIsCrossChain:t}=T(this.rootStore,"fromToStore",{});return t?this.userForbiddenWithBridge:Ae}get computedAccountId(){let{walletConfig:t}=this;return t.walletId}setWalletConfig(t={}){this.walletConfig=t}getAddressByChainId(){}get isConnectedWallet(){return!!this.walletConfig.walletId}get computedNonsupportChain(){return!this.isConnectedWallet||!U(this.fromChainId)?!1:!this.address}get computedAccountWalletAddresses(){return Se(T(this,"walletConfig.address",[])).join(",")||this.address}get computedAccountWalletAddressesArray(){return Se(T(this,"walletConfig.address",[]))||[this.address]}get computedMultiAddresses(){let t=[],e=[];return te.forEach(r=>{let s=this.getAddressByChainId(r);s&&(t.push(r),e.push(s))}),{targetChainId:t.join(),targetWalletAddress:e.join()}}setSignWalletChainId(t){this.signWalletChainId=t}get computedSignWalletAddress(){let t=this.computedAccountWalletAddressesArray;return t?.length===1?t[0]:this.getAddressByChainId(this.signWalletChainId)}cleanWalletConfig(){this.walletConfig=this.defaultWalletConfig,this.hasInitWalletInfo=!1}};n();c();n();c();function ut(l=[],t=[]){let e={};l.forEach(s=>{e[s]=wt});let r={};return t.forEach(s=>{r[s]=fr}),{...e,...r}}var qo=ut(["walletConfig","chainId","hasInitWalletInfo","fromChainId","addressType"],["computedAccountId","isConnectedWallet","computedNonsupportChain","computedAccountWalletAddresses","computedAccountWalletAddressesArray","address","computedMultiAddresses"]);var Be=class extends Dt{constructor(e){super();o(this,"formatWalletType",()=>{let{walletInfo:e}=A,{isHARDWARE:r,isMNEMONIC:s,isMPC:a,isPRIVATE:i}=e?.walletType||{};return r?at.HARDWARE:s?at.MNEMONIC:a?at.MPC:i?at.PRIVATE_KEY:null});o(this,"formatWalletAccount",e=>{let r=Object.values(e.account);return{...e,OKXWalletType:this.formatWalletType(),address:r}});o(this,"keyringIdentityTypeEnum",{});o(this,"walletList",[]);o(this,"addressBookList",[]);o(this,"hasInitWalletInfo",!1);o(this,"getAddressByChainId",e=>{if(!U(e))return nt;let r=this.getWalletChainName(e);return this.walletConfig.account?.[r]||nt});this.rootStore=e,this.commonStore=e.commonStore,st(this,qo)}async getDeviceId(){let{devid:e}=await A.localStore.get("devid");return e}getCurrentChainAddress(e){let r=this.rootStore?.fromToStore.from.chainId;if(!U(r))return nt;let s=this.getWalletChainName(r);return e.account[s]}getWalletChainName(e){return A.getNetWorkName(e)}replaceAddressByType(e){if(this.addressType){let r={};return te.forEach(s=>{let a=this.getWalletChainName(s);if(e.account?.[a]){let d=e.accountsMap?.[a]?.[this.addressType]?.address;d&&(r[a]=d)}}),{...e,account:{...e.account,...r}}}return e}setWalletConfig(e){this.walletConfig=this.formatWalletAccount(this.replaceAddressByType(e)),this.hasInitWalletInfo=!0}webSwapHistoryDetailViewMore(){}setAddressBookList(e){this.addressBookList=e}setWalletList(e){this.walletList=e.map(r=>r.walletId===this.computedAccountId?this.replaceAddressByType(r):r)}setKeyringIdentityTypeEnum(e){this.keyringIdentityTypeEnum=e}get address(){return this.getAddressByChainId(this.fromChainId)}},jo=Be;n();c();n();c();j();ot();n();c();var di={FROM:"FROM",TO:"TO"},li={COMMON:"COMMON",COLLECTION:"COLLECTION"},et={COLLECT_LIST:"COLLECT_LIST",ALL_NETWORK:"ALL_NETWORK",CHAIN_LIST:"CHAIN_LIST",SEARCH:"SEARCH",ALL_TOKENS:"ALL_TOKENS",HISTORY_LIST:"HISTORY_LIST"},vs={[et.COLLECT_LIST]:{[C.SWAP]:Oe,[C.LIMIT_ORDER]:Oe,[C.BRIDGE]:jr},[et.ALL_NETWORK]:{[C.SWAP]:Gr,[C.LIMIT_ORDER]:Hr,[C.BRIDGE]:qr},[et.SEARCH]:{[C.SWAP]:Kr,[C.LIMIT_ORDER]:$r,[C.BRIDGE]:zr},[et.CHAIN_LIST]:{[C.SWAP]:Mr,[C.LIMIT_ORDER]:Wr,[C.BRIDGE]:Br},[et.ALL_TOKENS]:{[C.SWAP]:xe,[C.LIMIT_ORDER]:xe,[C.BRIDGE]:Nr},[et.HISTORY_LIST]:{[C.SWAP]:Or,[C.LIMIT_ORDER]:vr,[C.BRIDGE]:br}},We=(l,t)=>vs[l]?.[t]??"";var kt=class{constructor(t){o(this,"rootStore",null);o(this,"userUniqueId",co.initUniqueId());o(this,"chainListFreshCount",0);o(this,"chainList",[]);o(this,"setChainList",t=>{this.chainList=t,this.chainListFreshCount+=1});o(this,"transactionLoading",!1);o(this,"setTransactionLoading",t=>{this.transactionLoading=t});o(this,"nowCurrencyUnit",{});o(this,"tokenModalVisible",!1);o(this,"safemoonSlippage",0);o(this,"getChainListUrl",({isHistory:t,currentTab:e})=>{let r=We(et.CHAIN_LIST,this.currentTab||e);return t&&(r=We(et.CHAIN_LIST,e||this.currentTab)),r});o(this,"fetchChainList",async({businessLine:t=1,isLimit:e=!1,isHistory:r=!1,currentTab:s,chainIdConfig:a={}})=>{if(dr())return[];let i=this.getChainListUrl({isHistory:r,isLimit:e,currentTab:s}),d=await x.get(i,{params:{businessLine:e?xr.LIMIT_ORDER:t,...a}});return!r&&this.setChainList(d?.data),this.setCurrentTabChainList({[s||this.currentTab]:d?.data}),d?.data});o(this,"currentTabChainList",{});o(this,"setCurrentTabChainList",t=>{this.currentTabChainList={...this.currentTabChainList,...t}});o(this,"getTradeType",()=>this.rootStore?.fromToStore?.computedIsCrossChain?Pe.MULTI:Pe.SINGLE);o(this,"globalMessages",null);o(this,"setGlobalMessage",t=>{this.globalMessages=t});o(this,"cleanGlobalMessage",()=>{this.globalMessages=null});o(this,"socketStatus",!1);o(this,"balancePushSocketStatus",!1);o(this,"resetFromToByTabChange",!1);o(this,"setResetFromToByTabChange",t=>{this.resetFromToByTabChange=t});o(this,"portal",X.DEX);o(this,"setPortal",t=>{this.portal=t});o(this,"currencyConversion",t=>{let{usdToThisRate:e}=this.nowCurrencyUnit,r=b.BigNumber(t);return!e||r.isNaN()?"":r.multipliedBy(e)});o(this,"currencyReConversion",t=>{let{usdToThisRate:e}=this.nowCurrencyUnit,r=b.BigNumber(t);return!e||r.isNaN()?"":r.dividedBy(e).toString()});o(this,"isSensitiveChain",t=>this.computedSensitiveChainIds.some(e=>String(e)===String(t)));o(this,"getTokenAddress",t=>go(t,this.isSensitiveChain(t?.chainId)));o(this,"equalsChainId",(t,e)=>Co(t,e));o(this,"equalsToken",(t,e)=>{let r=this.isSensitiveChain(t?.chainId);return vt(t,e,r)});o(this,"fromFillToken",!1);o(this,"currentTab","");o(this,"setCurrentTab",(t,e)=>{this.currentTab!==t&&(this.setResetFromToByTabChange(!0),this.rootStore?.fromToStore?.clearFromTo()),this.currentTab=t,this.fromFillToken=!!e});o(this,"forceUpdateFromToByHash",0);o(this,"forceUpdateFromTo",()=>{this.forceUpdateFromToByHash+=1});o(this,"isFirstInit",!0);o(this,"visibleAddFunds",!1);o(this,"setAddFundsVisible",t=>{this.visibleAddFunds=t});o(this,"currencyConversionWithSymbol",(t,e={})=>{let r=this.currencyConversion(t).toString(),s=this.computedNowCurrencySymbol;return J(r,s,e)});o(this,"disclaimerVisible",!1);o(this,"setDisclaimerVisible",t=>{this.disclaimerVisible=t});o(this,"serviceState",{loaded:!1,isLimitRegion:!1});o(this,"setServiceState",t=>{this.serviceState={...this.serviceState,...t}});this.rootStore=t,Qt&&this.setPortal(X.LEDGER)}setChainType(){}get computedReserveGas(){let{chainList:t}=this,e=T(this.rootStore,"fromToStore.from.chainId");return t.find(s=>Number(s.chainId)===Number(e))?.reserveGas||""}getChainByID(t){return this.chainList.find(e=>(this.computedCurrentTabIsLimit||e.chainUsed)&&e.chainId===Number(t))}getUserUnit(){}get computedRealSlippageValue(){return T(this,"rootStore.slippageStore",{}).computedRealSlippageValue||0}setSocketStatus(t){this.socketStatus=t}setBalanceSocketStatus(t){this.balancePushSocketStatus=t}get computedIsWalletEnv(){return this.portal===X.OKX_WALLET_EXTENSION}get computedIsWalletDashBoard(){return this.portal===X.WALLET_DASHBOARD}get computedIsMarket(){return this.portal===X.MARKET}get computedNotThirdBiz(){return this.portal===X.OKX_WALLET_EXTENSION||this.portal===X.DEX||this.portal===X.MARKET}get computedNowCurrencySymbol(){return this.nowCurrencyUnit.symbol||""}get computedSensitiveChainIds(){return this.chainList.map(t=>Number(t.isSensitive)===Cr.YES?t.chainId:null).filter(Boolean)}get computedCurrentTabIsLimit(){return this.currentTab===C.LIMIT_ORDER}get computedIsUrlFillSwap(){return this.computedIsWalletDashBoard||this.computedIsWalletEnv}setIsFirstInit(t){this.isFirstInit=t}get computedIsLimitRegion(){return this.serviceState.loaded&&this.serviceState.isLimitRegion}get computedIsNotLimitRegion(){return this.serviceState.loaded&&!this.serviceState.isLimitRegion}};n();c();var $o=ut(["userUniqueId","chainList","transactionLoading","nowCurrencyUnit","tokenModalVisible","safemoonSlippage","globalMessages","socketStatus","balancePushSocketStatus","portal","currentTab","currentTabChainList","forceUpdateFromToByHash","isFirstInit","visibleAddFunds","disclaimerVisible","serviceState"],["computedReserveGas","computedNowCurrencySymbol","computedSensitiveChainIds","computedIsWalletEnv","computedCurrentTabIsLimit","computedIsLimitRegion"]);var Nt=class extends kt{constructor(e){super(e);o(this,"swapCollapse",!1);o(this,"setSwapCollapse",e=>{this.swapCollapse=e});o(this,"chainListLoadError",!1);o(this,"setChainListLoadError",e=>{this.chainListLoadError=e});st(this,{...$o,swapCollapse:wt,chainListLoadError:wt}),this.setPortal(_r)}getUserUnit(e){this.nowCurrencyUnit=e}};n();c();j();n();c();j();ot();n();c();n();c();var ks=w(F());n();c();var ee=w(F());n();c();var Ko=w(F()),Vi=(0,Ko.createContext)({initialProps:{},getInitialProps:()=>Promise.reject(Error("You may forget to use InitialPropsProvider"))});n();c();var tn=w(F());n();c();var Ue=class{constructor(t){o(this,"_context",null);o(this,"getInitialProps",(...t)=>this._context?this._context.getInitialProps(...t):Promise.reject(Error("You may forget to use InitialPropsProvider")));It(this),this._updateContext(t)}get initialProps(){return this._context?this._context.initialProps:{}}_updateContext(t){this._context=t}},zo=Ue;var Ve=null,Ds=null;function He(l){return Ve||(Ve=new zo(Ds)),l.prototype.initialPropsStore=Ve,l}n();c();n();c();n();c();n();c();n();c();n();c();n();c();j();j();var Xo=(l,t)=>l.filter(({networks:e})=>e.findIndex(s=>s.name===t)>-1),Qo=(l,t)=>l.filter(({account:e})=>e[t]),Jo=({recentAddrData:l,addressBookData:t,walletListData:e,chainName:r})=>{let s=[];if(l.length>0){let a=l.map(({specifiedAddress:i,...d})=>({specifiedAddress:i,...d}));s.push({group:I("swaptrade_extension_wallet_address_recent_address"),list:a})}if(t.length>0){let a=t.map(i=>({...i,specifiedAddress:i.address}));s.push({group:I("swaptrade_extension_wallet_address_connected_wallets"),list:a})}if(e.length){let a=e.map(d=>({specifiedAddress:d.account[r],group:d.keyringName,name:d.walletName,walletId:d.walletId}));Object.entries(ir(a,"group")).forEach(([d,m])=>{s.push({group:d,list:m})})}return s},Yo=l=>String(T(l,"isLeveraged"))==="1",Zo=(l,t)=>{let e=[null,null];return Yo(l)&&(e[0]=l),Yo(t)&&(e[1]=t),e};var{BigNumber:M}=b,Ge=class{constructor(t){o(this,"defaultToken",{amount:"",prevAmount:"",balance:"",logoURI:"",coinId:"",decimals:"",usdPrice:"",tokenName:"",baseCoinId:"",tokenSymbol:"",tokenLogoUrl:"",isNativeToken:0,tokenContractAddress:"",isSafeMoonToken:"",isHoneypot:"",buyTaxes:"0",sellTaxes:"0",reverseReceiveAmount:"",chainId:""});o(this,"from",{...this.defaultToken});o(this,"to",{...this.defaultToken});o(this,"fromBalanceState",q.BALANCE_NOT_SHOW);o(this,"toBalanceState",q.BALANCE_NOT_SHOW);o(this,"fromBalanceRequestError",!1);o(this,"toBalanceRequestError",!1);o(this,"isBalanceLoading",!1);o(this,"visibleAddFunds",!1);o(this,"setFrom",t=>{this.from=t});o(this,"setTo",t=>{this.to=t});o(this,"maxDialogType",Pt.enough);o(this,"setMaxDialogType",t=>{this.maxDialogType=t});o(this,"checkMaxDialogTypeIsEnough",t=>Pt.enough===t);o(this,"typedValue","");o(this,"fromMax",!1);o(this,"independentField",k.FROM);o(this,"singleTypedValue","");o(this,"singleFromMax",!1);o(this,"advanceSetTypedValue",(t="",e=!1,r="")=>{(r||this.commonStore.currentTab)===C.SWAP?(this.singleTypedValue=t,this.singleFromMax=e):this.setTypeInput(t,e)});o(this,"needCrossChainDoubleConfirm",!1);o(this,"setNeedCrossChainDoubleConfirm",t=>{this.needCrossChainDoubleConfirm=t});o(this,"updateBtcFromBalance",async()=>this.computedIsFromBtcCoin?(await this.getTokenBalanceByAccount(k.FROM,N(this.from)),!this.fromBalanceRequestError):!this.fromBalanceRequestError);o(this,"onClickMax",async()=>{Eo({button_name:"max"});let{isNativeToken:t}=this.from;this.setField(k.FROM);let e="",r="";if(t===1){let[s,a]=await Promise.all([this.rootStore.quoteStore.fetchGasTokenFee(),this.updateBtcFromBalance()]);if(!a)return;let{balance:i,availableBalance:d}=this.from,m=(this.computedIsFromBtcCoin?d:i)||"0";if(s===-1)return;r=M(m).minus(s);let h=r.isNegative();this.setMaxDialogType(h?Pt.insufficient:Pt.enough),h&&this.setShowAddFund(!0),this.showMaxDialog(),this.setShowMaxIcon(!0),e=h?"":r.toString()}else e=this.from.balance;this.advanceSetTypedValue(e,!0)});o(this,"setTypeInput",(t,e)=>{this.typedValue=t,this.fromMax=!!e});o(this,"setField",t=>{this.independentField=t});o(this,"quoteUpdateFromTo",t=>{let{receiveAmount:e="",fromTokenPrice:r="",toTokenPrice:s="",payAmount:a="",inputToTokenPrice:i=""}=t||{};!this.computedIsExactIn&&e?(this.from.amount=a,this.to.amount=this.computedTypedValue,this.to.prevAmount=this.computedTypedValue,this.from.currentTime=new Date().getTime(),this.to.usdPrice=i):this.computedIsExactIn&&(this.from.amount=this.computedTypedValue,this.to.amount=e,this.from.prevAmount=this.computedTypedValue,this.to.currentTime=new Date().getTime(),this.to.usdPrice=s),this.to.reverseReceiveAmount=e,this.from.usdPrice=r});o(this,"checkAndGetTokenInfo",async({chainId:t,tokenContractAddress:e})=>{let[r,s]=await this.getTokenInfoAndBalance(t,e);return r?null:s.data});o(this,"getDexMultiDefaultTokenInfo",t=>{let{chainList:e}=this.commonStore,r=N(e).find(s=>Number(s.chainId)===Number(t??Re))||{};return{fromDexMultiTokenInfoVO:{...r.dexDefaultFromToTokenShowVO?.fromDexMultiTokenInfoVO,reserveGas:r.reserveGas},toDexMultiTokenInfoVO:r.dexDefaultFromToTokenShowVO?.toDexMultiTokenInfoVO||{}}});o(this,"addressReplaceSymbol",t=>{let{fromDexMultiTokenInfoVO:e}=this.getDexMultiDefaultTokenInfo(t.chainId),{tokenSymbol:r,isNativeToken:s}=e;return s&&this.commonStore.getTokenAddress(t)===this.commonStore.getTokenAddress(e)?r:t?.tokenContractAddress});o(this,"symbolReplaceAddress",t=>this.tokenReplaceMainToken(t).tokenContractAddress);o(this,"validTokens",{});o(this,"fetchTokenInfo",async t=>{if(t.tokenContractAddress){let e=await this.checkAndGetTokenInfo(t);if(e?.tokenContractAddress){let s={...e,balance:e.amountNum,amount:t.amount||""},a=`${e.chainId}_${this.commonStore.getTokenAddress(e)}`;return this.validTokens[a]=!0,s}let r=`${t.chainId}_${this.commonStore.getTokenAddress(t)}`;return this.validTokens[r]=t.tokenContractAddress==wr,null}return null});o(this,"checkQueryToken",async(t,e=!0)=>{if(!U(t.chainId))return null;let r=t;if(Oo(this.commonStore.chainList,Number(t.chainId))){let{from:a}=this.getInitializedValue(t.chainId);if(this.commonStore.getTokenAddress(t)===this.commonStore.getTokenAddress(a)&&e){let d=`${a?.chainId}_${this.commonStore.getTokenAddress(a)}`;return this.validTokens[d]=!0,a}let i=await this.fetchTokenInfo({chainId:Number(t.chainId),tokenContractAddress:t.tokenContractAddress});e?r=i||a:r=i}else r=null;return r});o(this,"updateFrom",t=>{(!this.commonStore.equalsToken(t,this.from)||this.from.balance!==t.balance)&&(this.setShowMaxIcon(!1),this.setShowAddFund(!1)),this.from={...N(this.from),...t}});o(this,"updateFromAmount",t=>{this.from.amount=t,t||(this.from.usdPrice="0"),this.from.prevAmount||(this.from.prevAmount=t)});o(this,"updateFromUsdPriceFromWs",(t={})=>{!vt(t,this.from)||(this.from.wsPriceData=t,this.from.usdPrice=ke({realTimeTokenPrice:t.price,amount:this.from.amount,nonRealTimeTokenValue:this.from.usdPrice}))});o(this,"updateToUsdPriceFromWs",(t={})=>{!vt(t,this.to)||(this.to.wsPriceData=t,this.to.usdPrice=ke({realTimeTokenPrice:t.price,amount:this.to.amount,nonRealTimeTokenValue:this.to.usdPrice}))});o(this,"updateTo",t=>{this.to={...N(this.to),...t}});o(this,"hideMaxDialog",!!Z.get(_e));o(this,"hideMaxDialogLessGas",!!Z.get(we));o(this,"setStorageShowMaxDialog",t=>{if(t){let e=this.checkMaxDialogTypeIsEnough(this.maxDialogType);Z.set(e?_e:we,"1"),e?this.hideMaxDialog=!0:this.hideMaxDialogLessGas=!0}this.visibleMaxDialog=!1});o(this,"visibleMaxDialog",!1);o(this,"showMaxDialog",()=>{let t=this.checkMaxDialogTypeIsEnough(this.maxDialogType);t&&this.hideMaxDialog||!t&&this.hideMaxDialogLessGas||(this.visibleMaxDialog=!0)});o(this,"showMaxIcon",!1);o(this,"setShowMaxIcon",t=>{this.showMaxIcon=t});o(this,"showAddFund",!1);o(this,"setShowAddFund",t=>{this.showAddFund=t});o(this,"setFromBalanceRequestError",t=>{this.fromBalanceRequestError=t});o(this,"setToBalanceRequestError",t=>{this.toBalanceRequestError=t});o(this,"resetBalanceState",()=>{this.setShowMaxIcon(!1),this.setShowAddFund(!1),[this.fromBalanceRequestError,this.toBalanceRequestError]=[this.toBalanceRequestError,this.fromBalanceRequestError]});o(this,"onSwitchFromTo",async()=>{if(!this.isBalanceLoading){this.rootStore.quoteStore.quoteScope=null;let[t,e]=[N(this.from),N(this.to)];this.resetBalanceState();let r={amount:this.computedTypedValue??"",prevAmount:this.computedTypedValue??"",usdPrice:""},s={amount:"",prevAmount:"",usdPrice:""};this.setNeedCrossChainDoubleConfirm(!0),this.setField(k.FROM),this.computedIsSingleChain?(this.setCacheTokenInfo({chainId:e.chainId,tokenContractAddress:e.tokenContractAddress,amountNum:e.balance},"switchFromTo"),this.setFrom({...e,...r})):(this.rootStore.quoteStore.setQuoteNumber(this.computedTypedValue?0:2),this.setCacheTokenInfo({chainId:e.chainId,tokenContractAddress:e.tokenContractAddress,amountNum:e.balance},"switchFromTo"),this.setFrom({...e,amount:e.amount||"",prevAmount:e.amount||"",usdPrice:""})),this.setTo({...t,...s}),this.advanceSetTypedValue(e.amount),this.rootStore.receiveAddressStore.clearReceiveAddressValue()}});o(this,"getChainInfo",t=>{let{chainList:e}=this.commonStore;return e.find(s=>Number(s.chainId)===Number(t))||{}});o(this,"getInitializedValue",(t=Re)=>{let e=this.getChainInfo(t),{fromDexMultiTokenInfoVO:r,toDexMultiTokenInfoVO:s}=e?.dexDefaultFromToTokenShowVO||{fromDexMultiTokenInfoVO:{},toDexMultiTokenInfoVO:{}},a={...N(r),balance:"",reserveGas:e?.reserveGas},i={...N(s),balance:""};return{from:a,to:i}});o(this,"resetFromTo",async t=>{let{chainList:e,currentTab:r}=this.commonStore,s=r===C.BRIDGE;if(Number(t)!==Number(this.from.chainId)){let a=N(e).find(f=>Number(f.chainId)===Number(t)),{fromDexMultiTokenInfoVO:i,toDexMultiTokenInfoVO:d,toCrossDexMultiTokenInfoVO:m}=a?.dexDefaultFromToTokenShowVO||{fromDexMultiTokenInfoVO:{},toDexMultiTokenInfoVO:{}};this.from={...N(i),balance:"",reserveGas:a?.reserveGas};let h=s&&m||d;this.to={...N(h),balance:""}}});o(this,"clearFromTo",()=>{this.from={},this.to={}});o(this,"updateBalanceIfNativeToken",(t,e)=>{e.isNativeToken?this.getTokenBalanceByAccount(t,e,!1).catch(ar):(this.setFromBalanceRequestError(!1),this.setBalance(t,e.amountNum))});o(this,"getSwapTokenBalance",(t=!1)=>{this.getTokenBalanceByAccount(k.FROM,N(this.from),t).catch(()=>{}),this.getTokenBalanceByAccount(k.TO,N(this.to),t).catch(()=>{})});o(this,"getTokenInfoAndBalance",async(t,e)=>{let r=this.accountStore.getAddressByChainId(t),s={chainId:t,tokenAddress:e,userUniqueId:this.commonStore.userUniqueId,accountId:this.accountStore.computedAccountId,userWalletAddress:r,businessType:this.commonStore.computedCurrentTabIsLimit?ye.LIMIT_ORDER:ye.SWAP_ORDER};return D(x.get(Ur,{params:s}))});o(this,"needBalanceLoading",!0);o(this,"setNeedBalanceLoading",t=>{this.needBalanceLoading=t});o(this,"getTokenBalanceByAccount",async(t,e,r=!1)=>{let s=t===k.FROM,{chainId:a,tokenContractAddress:i}=e;if(U(a)&&i&&this.accountStore.computedAccountId){this.needBalanceLoading&&(this.isBalanceLoading=!0);let d=await this.getTokenInfoAndBalance(a,i);if(this.isBalanceLoading=!1,this.setNeedBalanceLoading(!0),!this.commonStore.equalsToken(e,s?this.from:this.to))return;if(d[0]){if(r){this.fromBalanceRequestError=!1,this.toBalanceRequestError=!1;return}s?(this.fromBalanceRequestError=!0,this.fromBalanceState=q.BALANCE_REQUEST_FAILED):(this.toBalanceRequestError=!0,this.toBalanceState=q.BALANCE_REQUEST_FAILED),this.setBalance(t,"0","0","0");return}s?this.fromBalanceRequestError=!1:this.toBalanceRequestError=!1;let{amountNum:m,availableAmountNum:h,currencyAmount:f}=d[1]?.data||{};s&&this.setCacheTokenInfo({chainId:a,tokenContractAddress:i,amountNum:m},"api"),this.setBalance(t,m,h,f)}});o(this,"cacheTokenInfo",{});o(this,"setCacheTokenInfo",(t,e)=>{this.cacheTokenInfo=t,p.info(S.GET_BALANCE,{...t,tokenContractAddress:ao(t.tokenContractAddress),type:e})});o(this,"setBalance",(t,e="",r="",s="")=>{let a=t===k.TO,i={balance:e,availableBalance:r,currencyAmount:s};a?this.updateTo({...this.to,...i}):this.updateFrom({...this.from,...i})});o(this,"setBalanceState",t=>{let{amount:e,address:r,from:s,to:a}=t;Boolean(r)&&Boolean(s.tokenContractAddress)?this.fromBalanceRequestError===!0?this.fromBalanceState=q.BALANCE_REQUEST_FAILED:M(s.balance||"0").lt(e||"0")?this.fromBalanceState=q.BALANCE_INSUFFICIENT:this.fromBalanceState=q.COMMON:this.fromBalanceState=q.BALANCE_NOT_SHOW,!(Boolean(r)&&Boolean(a.tokenContractAddress))||!this.computedIsToAddressEqualsCurrentToAddress&&this.computedDiffCrossChain?this.toBalanceState=q.BALANCE_NOT_SHOW:this.toBalanceRequestError===!0?this.toBalanceState=q.BALANCE_REQUEST_FAILED:this.toBalanceState=q.COMMON});o(this,"equalsTokenAndAccount",(t,e)=>this.commonStore.equalsToken(t,e)&&this.accountStore.getAddressByChainId(t.chainId)===e.address);o(this,"updateFromBalancePush",t=>{let{coinAmountOriginalDec:e,availableAmountNum:r,currencyAmount:s}=t;this.equalsTokenAndAccount(this.from,t)?(this.setCacheTokenInfo({chainId:t.chainId,tokenContractAddress:t.tokenContractAddress,amountNum:e},"ws"),this.setBalance(k.FROM,e,r,s)):this.equalsTokenAndAccount(this.to,t)&&this.setBalance(k.TO,e,r,s)});o(this,"tokenReplaceMainToken",t=>{let e=t,{fromDexMultiTokenInfoVO:r}=this.getDexMultiDefaultTokenInfo(t?.chainId),{tokenSymbol:s,chainId:a}=r;return U(t?.chainId)&&t?.tokenContractAddress&&(this.commonStore.getTokenAddress(t)===(this.commonStore.isSensitiveChain(a)?s:Ht(s))||this.commonStore.getTokenAddress(t)===this.commonStore.getTokenAddress(r))&&(e={...r,amount:t.amount}),e});o(this,"onClickAddFunds",()=>{let{tokenSymbol:t,chainName:e}=this.from,{address:r}=this.accountStore,s={currency:t,network:e,address:r};this.getDeposit(s)});o(this,"calOrderUpdateFromTo",t=>{let{fromTokenUsd:e,toTokenUsd:r,fromAmount:s,toAmount:a}=t||{};_t(s)||(this.from.amount=s),_t(e)||(this.from.usdPrice=e),_t(a)||(this.to.amount=a),_t(r)||(this.to.usdPrice=r)});o(this,"isEvmChain",t=>U(t)?this.commonStore.getChainByID(t)?.chainType!==gr.NO_EVM_CHAIN:!0);o(this,"isTronChain",t=>t===_.TRON_MAINNET);o(this,"getFormatFromToToken",async({from:t,to:e},r)=>{let[s,a]=await Promise.all([this.checkQueryToken(t,r),this.checkQueryToken(e,r)]),i=s,d=a,m=h=>`${h?.chainId}-${h?.tokenContractAddress}`;if(s){let h=this.getInitializedValue(s?.chainId),f=Te(ge([s,a,h.from,h.to],m));i=f[0],d=f[1]}else if(a){let h=this.getInitializedValue(a.chainId),f=Te(ge([a,h.from,h.to],m));i=f[1],d=f[0]}return{token1:i,token2:d}});o(this,"orderContinueStatus",Y.DEFAULT);o(this,"setOrderContinueStatus",t=>{this.orderContinueStatus=t});o(this,"fillSwapFromTo",async({apiRequestParams:t,locationParams:e})=>{let{closeModal:r}=this.rootStore.recentTransactionStore;!await this.beforeCheckAndGetTokenInfo(t,e)||(r(),this.setSwapAndLimitTypeValue(e.inputAmount))});o(this,"beforeCheckAndGetTokenInfo",async(t,e)=>{let{orderCheckContinue:r}=this.rootStore.oneMoreOrderStore;if(this.setOrderContinueStatus(Y.LOADING),t&&!await r(t))return this.setOrderContinueStatus(Y.ERROR),!1;let{token1:s,token2:a}=await this.getFormatFromToToken(e,!1);return!s||!a?($.error({title:I("swaptrade_history_toast_setup_error"),duration:mt}),this.setOrderContinueStatus(Y.ERROR),!1):(this.setOrderContinueStatus(Y.READY),this.updateFromAndToInfo(s,a),!0)});o(this,"beforeCheckUrl",async t=>{this.setOrderContinueStatus(Y.LOADING);let{orderCheckContinue:e}=this.rootStore.oneMoreOrderStore;return await e(t)?(this.setOrderContinueStatus(Y.READY),!0):(this.setOrderContinueStatus(Y.ERROR),!1)});o(this,"updateFromAndToInfo",(t,e)=>{this.updateFrom(t),this.updateTo(e)});this.rootStore=t,this.accountStore=t.accountStore,this.commonStore=t.commonStore,qt(()=>this.initialPropsStore.initialProps.fromTo,(e={})=>{let{from:r={},to:s={}}=e;this.setFrom(r),this.setTo(s)})}static async getInitialProps(t){let e=new URLSearchParams(t.route.search),{from:{chainId:r,tokenContractAddress:s},to:{chainId:a,tokenContractAddress:i}}=Io(e);if(!vo({fromChainId:r,toChainId:a,fromTokenAddress:s,toTokenAddress:i}))return{from:{},to:{}};let d=Zr,m={chainId:r,fromTokenAddress:s,toTokenAddress:i};t.route.path.includes(uo)&&(d=Vr,m={chainId:r,toChainId:a,fromTokenAddress:s,toTokenAddress:i}),t.route.path.includes(ho)&&(d=to,m={fromChainId:r,toChainId:a,fromTokenAddress:s,toTokenAddress:i});let[g,y]=await D(x.get(d,{params:m}));return g?{from:{},to:{}}:{from:T(y,"data.fromTokenInfo")||T(y,"data.fromToken"),to:T(y,"data.toTokenInfo")||T(y,"data.toToken")}}get computedTypedValue(){return this.commonStore.currentTab===C.SWAP?this.singleTypedValue:this.typedValue}get computedFromMax(){return this.commonStore.currentTab===C.SWAP?this.singleFromMax:this.fromMax}get computedNeedCrossChainDoubleConfirm(){return this.computedIsSingleChain?!1:!this.needCrossChainDoubleConfirm}get dependentField(){return this.independentField===k.FROM?k.TO:k.FROM}get computedIsExactIn(){return this.independentField===k.FROM}get computedIsSingleChain(){return U(this.from.chainId)&&U(this.to.chainId)&&Number(this.from.chainId)===Number(this.to?.chainId)}get computedSwapAmount(){return{[this.independentField]:this.computedFromMax?Ot(this.computedTypedValue,{noNeedThousandth:!0}):this.computedTypedValue,[this.dependentField]:this.computedCalAmount[this.dependentField]}}get computedCalAmount(){return{[k.FROM]:Ot(this.from?.amount,{noNeedThousandth:!0})??"",[k.TO]:Ot(this.to?.amount,{noNeedThousandth:!0})??""}}get computedIfQuote(){return!!(this.computedTypedValueIsValid&&this.from&&this.to)}get computedTypedValueIsValid(){return!M(this.computedTypedValue).isZero()&&!M(this.computedTypedValue).isNaN()}get computedFromAmountIsValid(){let{amount:t}=this.from;return Yt(t)}get computedFromLocalCostByUsd(){let{usdPrice:t}=this.from;if(!this.computedFromAmountIsValid)return"";let{nowCurrencyUnit:e}=this.commonStore,{symbol:r,usdToThisRate:s}=e,a=M(t);if(r&&t&&s&&!a.isNaN()){let d=a.multipliedBy(s).toString();return J(d,r,{needBillionMillionUnit:!1})}return""}get computedToLocalCostByUsd(){let{usdPrice:t}=this.to,{nowCurrencyUnit:e}=this.commonStore,{symbol:r,usdToThisRate:s}=e,a=M(t);if(r&&t&&s&&this.to.amount&&!a.isNaN()&&Yt(this.from.amount)){let d=a.multipliedBy(s).toString();return J(d,r,{needBillionMillionUnit:!1})}return""}get computedRate(){let{from:t,to:e,computedIsExactIn:r}=this,{quoteStore:s,gasDropStore:a}=this.rootStore,i=T(s,"quote.bestRoute.gasDropFromAmount",""),d=i&&a?.gasDropConfig?.gasDrop?M(t?.amount).minus(i):M(t?.amount),m=e?.reverseReceiveAmount&&r||!r&&t?.amount;return d&&m?K(M(e?.reverseReceiveAmount).div(d).toString(10),{needBillionMillionUnit:!1}):""}get computedToFromRate(){let{from:t,to:e,computedIsExactIn:r}=this,{quoteStore:s,gasDropStore:a}=this.rootStore,i=T(s,"quote.bestRoute.gasDropFromAmount",""),d=i&&a?.gasDropConfig?.gasDrop?M(t?.amount).minus(i):M(t?.amount),m=e?.reverseReceiveAmount&&r||!r&&t?.amount;return d&&m?K(M(d).div(e?.reverseReceiveAmount).toString(10),{needBillionMillionUnit:!1}):""}get computedIsToAddressEqualsCurrentToAddress(){let t=this.accountStore.getAddressByChainId(this.to.chainId);return t&&this.rootStore.receiveAddressStore.computedReceiveAddr===t}get computedValueDifference(){let{quoteStore:t}=this.rootStore,e=T(t,"quote.bestRoute.quoteDiffValThreshold"),r=T(t,"quote.bestRoute.quoteDiffPercentThreshold");return bo({pay:this.from.usdPrice,receive:this.to.usdPrice,quoteDiffValThreshold:e,quoteDiffPercentThreshold:r})}get computedIsCrossChain(){return U(this.from.chainId)&&U(this.to.chainId)&&Number(this.from.chainId)!==Number(this.to?.chainId)}get computedIsBridge(){let{from:t,to:e}=this;return this.computedIsCrossChain&&t.tokenSymbol===e.tokenSymbol}getDeposit(){}get computedDiffCrossChain(){let t=!!this.accountStore.address,e=this.commonStore.getChainByID(this.from.chainId),r=this.commonStore.getChainByID(this.to.chainId),s=String(this.from.isHoneypot),a=String(this.to.isHoneypot),{computedNonsupportChain:i}=this.accountStore,d=e?.crossChainType||"",m=r?.crossChainType||"";return t&&!i&&s!=="1"&&a!=="1"&&d&&m&&d!==m}get computedMaxTipsText(){let{from:t,maxDialogType:e}=this,{cacheNativeGasFee:r}=this.rootStore.quoteStore;if(!t.isNativeToken||!r||!t.tokenSymbol)return I("wallet_swap_toast_reserve_mainnet_token");let s={value:K(r),tokenSymbol:t.tokenSymbol};if(this.checkMaxDialogTypeIsEnough(e)){if(this.computedIsFromBtcCoin&&b.gt(this.computedUnavailableBalance,0)){let a=K(this.computedUnavailableBalance);return I("swaptrade_dialog_pay_card_reserved_from_wallet",{symbol:s.tokenSymbol,value:s.value,unablevalue:a})}return I("swaptrade_dialog_desc_reserved_netfee",s)}return I("swaptrade_dialog_desc_please_reserve",s)}get computedShowAddFund(){let{accountStore:t,swapBtnStore:e}=this.rootStore,{from:r}=this;return!t.computedNonsupportChain&&(this.independentField===k.FROM&&M(this.computedTypedValue||0).gt(M(r.balance||0))||e.computedTooBalance)||this.showAddFund&&!this.checkMaxDialogTypeIsEnough(this.maxDialogType)}get computedIsEvmChain(){return this.isEvmChain(this.from.chainId)}get computedDefaultAutoSlippageInfo(){let t=this.commonStore.getChainByID(this.from.chainId);return{autoSlippage:t?.toleranceSlippage?.selectItem,autoTotalSlippage:t?.crossToleranceSlippage?.selectItem}}get computedIsSolanaChain(){return Jt(this.from.chainId)}get computedIsAptosChain(){return xo(this.from.chainId)}get computedIsTronChain(){return _o(this.from.chainId)}get computedIsSuiChain(){return wo(this.from.chainId)}get computedIsStacksChain(){return Ro(this.from.chainId)}get computedIsStarknetChain(){return Po(this.from.chainId)}get computedHasToSwap(){let t=T(this.rootStore.quoteStore,"quote.bestRoute.toSwapFeeUsd");return this.computedIsCrossChain&&t>0}setSwapAndLimitTypeValue(t){let{computedCurrentTabIsLimit:e}=this.commonStore,{clearSellAndReceive:r}=this.rootStore?.limitOrderControlStore||{};e?r?.():Yt(t)?(this.setField(k.FROM),this.advanceSetTypedValue(t)):this.advanceSetTypedValue("")}get computedLeverageTokenPair(){return Zo(this.from,this.to)}get computedFormToTokenIsLeverageToken(){let[t,e]=this.computedLeverageTokenPair;return!!t||!!e}get computedIsFromBtcChain(){return yo(this.from.chainId)}get computedIsFromBtcCoin(){return this.computedIsFromBtcChain&&this.from.isNativeToken}get computedUnavailableBalance(){return M(this.from.balance).minus(this.from.availableBalance).toString()}get computedIsFacetToken(){let{from:t,to:e}=this;return Number(t.tokenType)===Ee.FACET||Number(e.tokenType)===Ee.FACET}get computedNonsupportFacetToken(){let{address:t,walletConfig:{OKXWalletType:e,walletType:r}}=this.accountStore;if(!t)return!1;let s=[at.MNEMONIC,at.PRIVATE_KEY].includes(e),a=r===$t.METAMASK;return this.computedIsFacetToken&&!(s||a)}},ts=He(Ge);n();c();var es=Symbol(),rs=Object.prototype,Ms=(l,t,e)=>{if(pr(l))throw new Error("Target must not be observable");let r=l[es];if(r){let s={};for(let a in l)r[a]&&(s[a]=r[a]);r=s}else{r={};let s=l;for(;s&&s!==rs;)Reflect.ownKeys(s).forEach(i=>{i===ur||i==="constructor"||(r[i]=t&&i in t?t[i]:!0)}),s=Object.getPrototypeOf(s);let a=Object.getPrototypeOf(l);a&&a!==rs&&Object.defineProperty(a,es,{value:r})}return st(l,r,e)},oe=Ms;var Lt=class extends ts{constructor(e){super(e);o(this,"getDeposit",()=>()=>{});o(this,"addFundsParams",{});o(this,"closeAddFunds",()=>{this.visibleAddFunds=!1});o(this,"onClickAddFunds",()=>{let{tokenSymbol:e,chainName:r,tokenLogoUrl:s,chainId:a,isNativeToken:i,tokenContractAddress:d}=this.from;this.visibleAddFunds=!0;let m={currency:e,network:r,iconUrl:s,chainId:a,isNativeToken:i,tokenContractAddress:i?"":d,receiveOnly:!0};this.baseAddFunds(m)});o(this,"baseAddFunds",e=>{this.visibleAddFunds=!0,this.addFundsParams={...e}});o(this,"tokenReplaceMainToken",(e,r)=>{let s=e,a=!So(e),{fromDexMultiTokenInfoVO:i}=this.getDexMultiDefaultTokenInfo(a?r:e.chainId),{tokenSymbol:d,chainId:m}=i;return!a&&(this.commonStore.getTokenAddress(e)===(this.commonStore.isSensitiveChain(m)?d:Ht(d))||this.commonStore.getTokenAddress(e)===this.commonStore.getTokenAddress(i))&&(s={...i,amount:e.amount}),s});oe(this),qt(()=>{let{computedDiffCrossChain:r,to:s}=this;return{computedDiffCrossChain:r,toChainId:s?.chainId}},({computedDiffCrossChain:r,toChainId:s})=>{this.cacheToChainId!==s&&this.rootStore.receiveAddressStore.saveReceiveAddressValue({}),this.rootStore.receiveAddressStore.setCacheToChainId(r&&s?s:-1)},{equals:hr.shallow})}};n();c();n();c();ot();var qe=class{constructor(t){o(this,"receiveAddrStatus",Rt.NORMAL);o(this,"receiveAddrObj",{});o(this,"saveReceiveAddressValue",t=>{this.receiveAddrObj=this.filterReceiveWalletInfo(t),t?.specifiedAddress||this.initCheckAddrStatus()});o(this,"clearReceiveAddressValue",()=>{this.receiveAddrObj={},this.initCheckAddrStatus(),this.walletAddrInWeb3=[],this.getLinkedWalletAddrInWeb3().catch(()=>{})});o(this,"checkReceiveAddressLoading",!1);o(this,"filterReceiveAddress",(t,e,r=!0)=>{let s=e?.specifiedAddress||this.receiveAddrObj?.specifiedAddress||"";return s?t.filter(({specifiedAddress:a})=>r?a.includes(s):a===s):t});o(this,"filterReceiveWalletInfo",t=>{if(!t.specifiedAddress||t.walletId)return t;let e=this.filterReceiveAddress(this.initWalletAddrListFromChain,t,!1);return e.length?e[0]:t});o(this,"initCheckAddrStatus",()=>{this.checkReceiveAddressLoading=!1,this.receiveAddrStatus=Rt.NORMAL});o(this,"checkReceiveAddr",async t=>{if(t||this.receiveAddrObj.specifiedAddress){this.checkReceiveAddressLoading=!0;let{to:e}=this.rootStore.fromToStore,r=Symbol("requestId");this.currentRequestId=r;let[s,a]=await D(x.get(ro,{params:{address:t||this.receiveAddrObj.specifiedAddress,chainId:e?.chainId}}));if(this.checkReceiveAddressLoading=!1,s){p.stuff(s),this.receiveAddrStatus=Rt.ILLEGALITY;return}this.currentRequestId===r&&Gt(()=>{this.receiveAddrStatus=a.data.status})}else this.initCheckAddrStatus()});o(this,"getSpecifiedChainWalletList",async t=>{let e=await this.getSpecifiedChainWalletListByWeb3(t),r={};return e?.forEach(s=>{let{specifiedAddress:a,walletType:i,createTime:d}=s,m=i===$t.OKEXCHAIN;r[a]&&r[a]?.has&&m?r[a].walletInfo.createTime<d&&(r[a].walletInfo=s):(!r[a]?.has||m)&&(r[a]={walletInfo:s,has:m})}),Object.keys(r).map(s=>r[s].walletInfo)});o(this,"walletAddrInWeb3",[]);o(this,"getLinkedWalletAddrInWeb3",async()=>{let{computedDiffCrossChain:t,to:e}=this.rootStore.fromToStore,{computedAccountId:r}=this.rootStore.accountStore;if(!t)return;let[s,a]=await D(this.getSpecifiedChainWalletList({chainId:e.chainId,walletIds:[r]}));s||Gt(()=>{this.walletAddrInWeb3=a})});o(this,"initWalletAddrListFromChain",[]);o(this,"initWalletAddrListInStorage",[]);o(this,"filterWalletAddrListFromChain",[]);o(this,"filterWalletAddrListInStorage",[]);o(this,"getWalletList",async()=>{let{to:t}=this.rootStore.fromToStore,e=await this.getSpecifiedChainWalletList({chainId:t.chainId});Gt(()=>{this.initWalletAddrListFromChain=e,this.filterWalletAddrListFromChain=e;let r=Z.get(xt);if(r){let s=r[t.chainId]||[];this.initWalletAddrListInStorage=s,this.filterWalletAddrListInStorage=s}})});o(this,"getFilteredAddrList",t=>{this.filterWalletAddrListFromChain=this.filterReceiveAddress(this.initWalletAddrListFromChain,t),this.filterWalletAddrListInStorage=this.filterReceiveAddress(this.initWalletAddrListInStorage,t)});o(this,"saveWalletAddressToStorage",t=>{this.receiveAddrObj?.specifiedAddress&&Z.set(xt,{[t.chainId]:[this.receiveAddrObj]})});o(this,"formatInputValue",t=>{let{specifiedAddress:e,deriveName:r,label:s}=t;if(e.length<=9)return e;let a=zt(t.specifiedAddress);return r&&(a=`(${a})`,s?a=`${r} - ${s} ${a}`:a=`${r} ${a}`),a});this.rootStore=t}get computedSwapHighLight(){return this.receiveAddrStatus===Rt.NORMAL&&!!this.receiveAddrObj?.specifiedAddress}get computedFormatReceiveAddr(){return this.receiveAddrObj?.specifiedAddress?this.formatInputValue(this.receiveAddrObj):""}get computedReceiveAddr(){return this.receiveAddrObj?.specifiedAddress||""}async getSpecifiedChainWalletListByWeb3(){return[]}get computedWalletAddrInWeb3(){return this.walletAddrInWeb3.length?this.walletAddrInWeb3[0]:null}get isFromFilterAddress(){let t=this.filterReceiveAddress(this.initWalletAddrListFromChain,this.receiveAddrObj?.specifiedAddress,!1),e=this.filterReceiveAddress(this.initWalletAddrListInStorage,this.receiveAddrObj?.specifiedAddress,!1);return!!(t.length+e.length)&&!!this.receiveAddrObj?.specifiedAddress}},os=qe;var je=class extends os{constructor(e){super(e);o(this,"formatInputValueEx",(e,r)=>{let{keyringName:s,walletName:a}=e;if(r.length<=9)return r;let i=zt(r);return s&&(i=`(${i})`,a?i=`${s} - ${a} ${i}`:i=`${s} ${i}`),i});o(this,"cacheToChainId",-1);o(this,"setCacheToChainId",e=>{this.cacheToChainId=e});o(this,"addressListEx",[]);o(this,"getWalletListEx",()=>{let{accountStore:e,fromToStore:r}=this.rootStore,s=A.getNetWorkName(r.to.chainId),{walletList:a,addressBookList:i,keyringIdentityTypeEnum:d}=e,h=(Z.get(xt)||{})[r.to.chainId]||[],f=Xo(i,s),g=Qo(a,s);this.addressListEx=Jo({recentAddrData:h,addressBookData:f,walletListData:g,chainName:s,keyringIdentityTypeEnum:d})});oe(this)}get computedFormatReceiveAddrEx(){let{accountStore:e,fromToStore:r}=this.rootStore,{walletConfig:s}=e;if(this.receiveAddrObj.specifiedAddress)return this.formatInputValueEx(this.receiveAddrObj,this.receiveAddrObj.specifiedAddress);let a=A.getNetWorkName(r.to.chainId),i=s?.account[a];return i?(this.receiveAddrObj={...s,specifiedAddress:i},this.formatInputValueEx(s,i)):""}},ss=je;n();c();ot();n();c();var $e=class{constructor(t){o(this,"updateTxHash",t=>(p.info(S.UPDATE_HASH,{...t,tags:{orderId:t.orderId,status:t?.status||1}}),x.post(Fr,t).catch(e=>{p.info(S.UPDATE_HASH_ERROR,{...t,error:e,tags:{orderId:t.orderId}})})));o(this,"cancelOrder",t=>(p.info(S.CANCEL_ORDER,{tags:{orderId:t}}),x.get(Qr,{params:{id:t}})));o(this,"cancelLimitOrder",()=>{});this.rootStore=t}},as=$e;var Ke=class extends as{constructor(){super(...arguments);o(this,"sendTransaction",async(...e)=>A.global?.signAndSubmitTransaction(...e));o(this,"sendTransactionEnhance",async(...e)=>this.sendTransaction(...e));o(this,"signTransaction",async(e,r)=>{let[s,a]=await D(A.global.signTypedDataV4(r,e));return[s,a]})}async signSolanaTransactionWithMeme(e,r){let{calldataParams:s}=e;return await Promise.all(r.map(i=>A.global.signSolanaCommonTransaction({fromAddress:s.userWalletAddress,instanceType:i.payload.version,serializedMessage:i.inputData,needToReplaceRecentBlockhash:!1})))}},is=Ke;n();c();n();c();j();ot();n();c();var se=()=>{if(V()){let e={home:po()?it.TGAPP:it.PLUGIN,coinDetail:it.WALLET,bot:it.COMMAND,coin_info_dialog:it.COIN_INFO_DIALOG},r=be.get("pageSource");return{orderSource:e[r]}}let t=Xt()?.source;if(t===it.MARKET){let e=be.get(lo);t=mo[e]||it.MARKET}return{orderSource:t}};n();c();n();c();n();c();var O=class{constructor({orderData:t,extParams:e},r){o(this,"walletNoNeedExtParams",!1);o(this,"differentiatedEnvironment",t=>V()&&t.length>1&&!this.walletNoNeedExtParams&&!t[0].params?[{...t[0],extParams:t[1]}]:t);this.orderData=t,this.calldataType=t.calldataType,this.extParams=e||{},this.swapStore=r}get isTransferType(){return this.calldataType===Ir.TRANSFER}};var ht=class extends O{constructor(){super(...arguments);o(this,"formatContractPayload",()=>{let{orderData:e}=this;return{...JSON.parse(e?.callData?.data)}});o(this,"formatTransferPayload",()=>{});o(this,"getSendTransactionParams",async()=>{let e=this.formatContractPayload();return this.differentiatedEnvironment([{...e,extParams:this.extParams}])});o(this,"preExecution",async()=>({payload:this.formatContractPayload()}))}};o(ht,"chainId",_.APTOS_MAINNET);n();c();var ft=class extends O{constructor(e,r,s){super(e,r);o(this,"makeSendBtcCallParams",async e=>{let{preDataForSendBtc:r}=this.swapStore.rootStore.walletContractStore;if(!r)throw Error("preDataForSendBtc is not ready");let{satBytes:s,coinAmount:a,dustSize:i,fetchUtxoList:d,serviceCharge:m}=r,h=await d();return{...e,utxoList:h,satBytes:s,dustSize:i,coinAmount:a,serviceCharge:m}});o(this,"formatContractPayload",()=>{});o(this,"formatTransferPayload",async()=>{let{orderData:e}=this;return this.swapStore.transferBtcPayload(e.callData)});o(this,"extendExtParams",e=>({...e,extParams:this.extParams}));o(this,"getSendTransactionParams",async()=>{if(!this.token.isNativeToken)throw new Error("btc token is not native token");let e;if(this.isTransferType){let r=await this.formatTransferPayload();e=this.extendExtParams(r),V()&&(e=await this.makeSendBtcCallParams(e))}else throw Error("Not support contract call");return this.differentiatedEnvironment([e])});o(this,"preExecution",async()=>{if(!this.token.isNativeToken)throw new Error("btc token is not native token");let e;if(this.isTransferType)e=await this.formatTransferPayload();else throw Error("Not support contract call");return{payload:e}});this.token=s}};o(ft,"chainId",_.BTC_MAINNET);n();c();var ae=class extends O{constructor(){super(...arguments);o(this,"valueToHex",e=>b.BigNumber(e).toString(16));o(this,"formatContractPayload",()=>{let{orderData:e}=this,{priorityFee:r,maxFeePerGas:s,maxPriorityFeePerGas:a,gasPrice:i,gas:d,...m}=e?.callData||{};return m});o(this,"formatTransferPayload",()=>{let{orderData:e}=this;return e.callData});o(this,"getSendTransactionParams",async()=>{let{payload:e}=await this.preExecution();return Qt&&e.value&&(e.value=this.valueToHex(e.value)),this.differentiatedEnvironment([e])});o(this,"preExecution",async()=>{let e;this.isTransferType?e=this.formatTransferPayload():e=this.formatContractPayload();let{extendEvmParams:r,extendsGas:s}=this.swapStore;return e.extParams=this.extParams,s&&(e=s(e)),e=r(e),{payload:e}})}};o(ae,"chainId",_.ETHEREUM_MAINNET);var ie=ae;n();c();n();c();j();var Ft=class{constructor(){o(this,"importSolana",async()=>{let t=await import("./index.browser.esm-NT7GKAL5.js"),{default:e}=await import("./bs58-RNG2JGFL.js");return{SolanaWeb3:t,bs58:e}});o(this,"deserialize",async t=>{let e={TRANSACTION:"transaction",VERSIONED_TRANSACTION:"versionedTransaction"},r,s,{SolanaWeb3:a,bs58:i}=await this.importSolana();try{r=a.Transaction.from(i.decode(t)),s=e.TRANSACTION}catch{r=a.VersionedTransaction.deserialize(i.decode(t)),s=e.VERSIONED_TRANSACTION}return{transaction:r,version:s}});o(this,"rentReserve",t=>{if(!t)return"0";let{BigNumber:e}=b,r=e("365.25").div(2).multipliedBy(2);return e("19.055441478439427").multipliedBy(t).multipliedBy(r).div(10**9).toFixed(9)});o(this,"txData",async t=>{let e;Vt(t)?e=JSON.parse(t):e=t;let{data:r,accountLength:s,bizType:a,bizId:i,from:d,to:m}=e,{transaction:h,version:f}=await this.deserialize(r),g=this.rentReserve(s);return{payload:{bizType:a,bizId:i,transaction:h,version:f},inputData:r,from:d,to:m,rent:g}})}};o(Ft,"chainId",_.SOLANA_MAINNET);var pt=class extends O{constructor(...e){super(...e);o(this,"formatContractPayload",async()=>{let{orderData:e}=this;return this.txData(e.unsignedTx)});o(this,"formatTransferPayload",async()=>{let{orderData:e}=this,{unsignedTx:r}=e;return this.txData(r)});o(this,"getSendTransactionParams",async()=>{let{payload:e}=await this.preExecution();return this.differentiatedEnvironment([e,this.extParams])});o(this,"preExecution",async()=>{let e;return this.isTransferType?e=await this.formatTransferPayload():e=await this.formatContractPayload(),e});o(this,"getTxData",()=>{let{jitoData:e,jitoEnable:r=!1,unsignedTx:s}=this.orderData||{};try{if(r){let{jitoUnsignedTx:a}=e;return JSON.parse(a).array}return[JSON.parse(s)]}catch(a){throw new Error(a)}});o(this,"jitoTransaction",async()=>{let e=this.getTxData();try{return Promise.all(e.map(this.txData))}catch(r){throw new Error(r)}});let r=new Ft;Object.assign(this,{...r})}};o(pt,"chainId",_.SOLANA_MAINNET);n();c();var Tt=class extends O{constructor(){super(...arguments);o(this,"formatContractPayload",()=>{let{orderData:e}=this,{data:r,from:s}=e.callData,a=JSON.parse(r);return{...a,functionArgs:a.functionArgsEncode,txType:"contract_call",stxAddress:s}});o(this,"formatTransferPayload",()=>{});o(this,"getSendTransactionParams",async()=>this.differentiatedEnvironment([this.formatContractPayload(),this.extParams]));o(this,"preExecution",async()=>({payload:this.formatContractPayload()}))}};o(Tt,"chainId",_.STACKS_MAINNET);n();c();var St=class extends O{constructor(){super(...arguments);o(this,"walletNoNeedExtParams",!0);o(this,"formatContractPayload",()=>{let{orderData:e}=this,r=JSON.parse(e.unsignedTx),{executionRequest:s}=JSON.parse(r.data);return s.calls});o(this,"formatTransferPayload",()=>{});o(this,"getSendTransactionParams",async()=>this.differentiatedEnvironment([this.formatContractPayload()]));o(this,"preExecution",()=>({payload:this.formatContractPayload()}))}};o(St,"chainId",_.STARKNET_MAINNET);n();c();var ne=class extends O{constructor(){super(...arguments);o(this,"formatContractPayload",()=>{let{orderData:e}=this,{txBytes:r}=JSON.parse(e.unsignedTx);return{transactionBlock:r}});o(this,"getSendTransactionParams",async()=>this.differentiatedEnvironment([this.formatContractPayload(),this.extParams]));o(this,"preExecution",async()=>({payload:this.formatContractPayload()}))}};o(ne,"chainId",_.SUI_MAINNET);var ze=ne;n();c();var ce=class extends O{constructor(){super(...arguments);o(this,"walletNoNeedExtParams",!1);o(this,"formatContractPayload",()=>{let{orderData:e}=this,{params:r}=JSON.parse(e.unsignedTx);return r});o(this,"formatTransferPayload",()=>{let{orderData:e}=this,{params:r}=JSON.parse(e.unsignedTx);return r});o(this,"getSendTransactionParams",async()=>{let e=this.isTransferType?this.formatTransferPayload():this.formatContractPayload();return this.differentiatedEnvironment([e,this.extParams])});o(this,"preExecution",async()=>({payload:this.isTransferType?this.formatTransferPayload():this.formatContractPayload()}))}};o(ce,"chainId",_.TON_MAINNET);var Ye=ce;n();c();var gt=class extends O{constructor(){super(...arguments);o(this,"formatContractPayload",()=>{let{orderData:e}=this;return JSON.parse(e.unsignedTx)});o(this,"formatTransferPayload",()=>{});o(this,"getSendTransactionParams",async()=>{let e=this.formatContractPayload();return this.differentiatedEnvironment([{...e,extParams:this.extParams}])});o(this,"preExecution",async()=>({payload:this.formatContractPayload()}))}};o(gt,"chainId",_.TRON_MAINNET);var Bs={[ft.chainId]:ft,[ie.chainId]:ie,[pt.chainId]:pt,[ht.chainId]:ht,[ze.chainId]:ze,[gt.chainId]:gt,[Tt.chainId]:Tt,[St.chainId]:St,[Ye.chainId]:Ye},Ws=l=>Bs[l]||ie,Us=(l,t,e)=>{let{chainId:r}=l,s=Ws(r);return new s(t,e,l)},de=Us;n();c();var Vs=l=>{let t=0;return l.forEach(e=>{t=b.add(t,e.rent,{returnString:!0})}),t},Hs=l=>{let t=l[0];return{fromAdr:t.from,toAdr:t.to,inputData:t.inputData}},Gs=async({walletId:l,swapParams:t,signedTransactions:e,txArray:r,enableJito:s,isMemeMode:a=!1})=>{let i=r.length>1,d=[],m=[],{default:h}=await import("./bs58-RNG2JGFL.js");e.map(v=>{if(a&&V()||To()){let{serializedTransaction:Rs,signature:Ps}=v;return{txHash:Ps,signedTx:Rs}}let ys=v?.signature||v?.signatures[0],_s=h.encode(ys),ws=h.encode(v.serialize());return{txHash:_s,signedTx:ws}}).forEach(v=>{d.push(v.signedTx),m.push(v.txHash)});let g="";i?g=JSON.stringify(d):g=d[0];let y=m[0],P=i?{mev:"Jito",jitoHash:m[1]}:{},G=Hs(r),L=Vs(r),rt={...t,enableJito:s,...se()};return s&&(rt.mevInfo="jito"),{updateMultiOrderInfo:{transactionHash:y,walletTxData:{extJson:JSON.stringify({...P,rent:L,txSource:3,feeType:4,multiTag:0,isMainTx:!1,coinAmount:0,serviceCharge:0,signedTx:i?JSON.parse(g):g}),isMainTx:!1,serviceCharge:0,txHash:y,walletId:l,txSource:3,coinAmount:0,walletType:2,signedTx:g,...G}},dexMultiMetaSaveOrderParam:rt}},ns=async({signedTransactions:l,swapParams:t,walletId:e,txArray:r,enableJito:s})=>{let a=await Gs({walletId:e,signedTransactions:l,swapParams:t,txArray:r,enableJito:s});return x.post(eo,a)};n();c();j();var qs=/\s/,Xe=l=>!(!Vt(l)||qs.test(l)||l.length<10);n();c();function Qe(l){return[Q.USER_DENIED,Q.WC2Denied,Q.USER_DENIED_WC_RAINBOW,Q.WC_QR_DENIED].includes(l?.code)}var Mt=class{constructor(t){o(this,"defaultGasFee","--");o(this,"isWalletConfirm",!1);o(this,"setWalletConfirm",t=>{this.isWalletConfirm=t});o(this,"isConfirmLoading",!1);o(this,"txInfo",{});o(this,"resetTxInfo",()=>{this.txInfo={}});o(this,"showRecentTransactionModal",t=>{this.confirmSwapVisible=!1,this.rootStore.recentTransactionStore.showModal(t)});o(this,"saveOrderParamsExtendSlippageAndGasPrice",t=>{let e={...t},{computedQuote:r,fromToStore:s}=this,{computedIsSingleChain:a,computedDefaultAutoSlippageInfo:i}=s,{autoSlippageInfo:d}=r.bestRoute||{},m=ko({isSingleChain:a,autoSlippageInfo:i}),h={autoSlippageInfo:d||{}},f=T(this,"rootStore.slippageStore");return f&&(m=f.computedRealSlippageValue,h=f.getOrderSlippageInfo()),Object.assign(e,{slippage:String(m),...No({slippageInfo:h,isSingleChain:a})})});o(this,"saveOrderSingleChainParams",t=>{let{computedQuote:e}=this,{originDexRouterList:r,dexRouterList:s,serviceFeeInfo:a,quoteData:i}=e.bestRoute||{};return{...t,dexRouterList:s,originDexRouterList:r,serviceFeeInfo:a,quoteData:i}});o(this,"saveOrderCrossChainParams",t=>{let{computedQuote:e,fromToStore:r}=this,{receiveAddressStore:s}=this.rootStore,{to:a,computedDiffCrossChain:i}=r,{receiveAddrObj:d}=s,{fromDexRouterList:m,bridge:h,toDexRouterToList:f,originFromDexRouterList:g}=e.bestRoute||{};return{...t,toChainId:a.chainId,crossChainDexRouter:{fromDexRouterList:m,toDexRouterToList:f,bridge:h,originFromDexRouterList:g},...i?{receiveWalletAddress:d?.specifiedAddress}:{}}});o(this,"saveOrderParams",()=>{let{fromToStore:t}=this,{computedIsSingleChain:e}=t,r=this.baseSaveOrderParams();return e?this.saveOrderSingleChainParams(r):this.saveOrderCrossChainParams(r)});o(this,"calldataSign",null);o(this,"setCalldataSign",t=>{this.calldataSign=t});o(this,"extendSignParams",async t=>{let e={...t},r=T(this.quoteStore,"quote.bestRoute.permit2Data");if(r&&!this.calldataSign){let[s,a]=await this.checkPermit2();if(s)return null;this.setCalldataSign(a),e={...e,unsignedTx:r?.unsignedTx,signature:a}}else r&&this.calldataSign&&(e={...e,unsignedTx:r?.unsignedTx,signature:this.calldataSign});return e});o(this,"checkPermit2",async()=>{let t=T(this.quoteStore,"quote.bestRoute.permit2Data"),e=T(this.quoteStore,"quote.bestRoute.fromToken.chainId"),{signTransaction:r}=this.rootStore.sendTransactionStore,s=t?.unsignedTx,[a,i]=await r(s,e);return a&&(p.error(S.SIGN_PERMIT2_DATA,{error:a,unsignedTx:s}),Qe(a)||Ct.error({title:I("swaptrade_trading_mode_alert_order_fail")})),[a,i]});o(this,"resetFromToAmount",()=>{this.fromToStore.updateFrom({amount:"",currentTime:"",prevAmount:"",usdPrice:""}),this.fromToStore.updateTo({amount:"",prevAmount:"",usdPrice:"",currentTime:""}),this.fromToStore.advanceSetTypedValue("")});o(this,"transferBtcPayload",t=>{let e={...t},{from:r}=this.fromToStore;return e.value=io(e.value,r.decimals),e});o(this,"getExtParams",t=>{let{computedIsSingleChain:e,to:r,from:s,computedDiffCrossChain:a}=this.fromToStore,{receiveAddrObj:i}=this.rootStore.receiveAddressStore,d=a?i?.specifiedAddress:r.tokenContractAddress;return{txSource:3,orderId:t,toTokenAddress:d,crossChain:e?0:1,chainId:s.chainId,tokenAddress:s.tokenContractAddress,amount:s.amount,toChainId:r.chainId}});o(this,"autoShowDialog",!0);o(this,"setAutoShowDialog",t=>{this.autoShowDialog=t});o(this,"confirmSwapVisible",!1);o(this,"setConfirmSwapVisible",t=>{this.confirmSwapVisible=t});o(this,"isSwapSolana",t=>!!(Jt(t)&&this.rootStore.solanaPriorityFeeStore?.jitoData));o(this,"extendSolanaCalldata",t=>{let{feeType:e,customFee:r,computedPriorityFeeList:s}=this.rootStore.solanaPriorityFeeStore||{},a=s.find(d=>d.type===e),i=r||a.fee;return{...t,tradeMode:2,priorityFee:i,customPriorityFee:!!r}});o(this,"solanaSwapParams",null);o(this,"setSolanaSwapParams",t=>{this.solanaSwapParams=t});o(this,"getSolanaCalldata",t=>(this.setSolanaSwapParams(t),D(x.post(Yr,t))));o(this,"solanaTransaction",async(t,e)=>{let{from:r}=this.fromToStore,{computedAccountId:s}=this.accountStore,i=await de(r,{orderData:t,extParams:{}},this).jitoTransaction(),d=i.map(f=>f.payload.transaction),[m,h]=await D(this.rootStore.sendTransactionStore.signAllTransactions(d));if(m){this.onWalletFail(m,t?.orderId),this.isConfirmLoading=!1,p.removeKeep();return}await this.sendSolanaTransaction({signedTransactions:h,txArray:i,swapParams:e,walletId:s,enableJito:t.jitoEnable})});o(this,"sendSolanaTransaction",async({signedTransactions:t,txArray:e,swapParams:r,walletId:s,enableJito:a})=>{let[i,d]=await D(ns({signedTransactions:t,txArray:e,swapParams:r,walletId:s,enableJito:a}));if(this.isConfirmLoading=!1,p.removeKeep(),!i){let m=T(d,"data.broadcastResult.data.orderId");this.afterTransaction(m)}});o(this,"walletConfirming",!1);o(this,"formatClaimPayload",(t,e)=>{let{orderId:r,toChainId:s}=e;return de({chainId:s},{orderData:t,extParams:{txType:86,txSource:3,orderId:r,toTokenAddress:e.toTokenAddress,chainId:e.chainId||e.fromChainId,tokenAddress:e.fromTokenAddress,amount:e.fromAmount,toChainId:s}},this).getSendTransactionParams()});o(this,"fetchClaimCalldata",async(t,e)=>{let{orderId:r}=t,[s,a]=await D(x.post(Dr,{mainOrderId:r,payerWalletAddress:e}));if(s)return p.error(S.FETCH_CLAIM_CALDATA_ERROR,{error:s,tags:{orderId:r}}),Ct.error({title:s?.error_message||I("swaptrade_home_toast_initiation_error")}),null;let i=T(a,"data",{});return{payload:await this.formatClaimPayload(a?.data||{},t),sourceClaimPayload:i}});o(this,"updateClaimOrder",t=>{p.info(S.UPDATE_CLAIM_ORDER,{params:t,tags:{orderId:t.mainOrderId}}),x.post(kr,t)});this.rootStore=t,this.commonStore=t.commonStore,this.accountStore=t.accountStore,this.fromToStore=t.fromToStore,this.tokenModalStore=t.tokenModalStore,this.quoteStore=t.quoteStore,this.gasDropStore=t.gasDropStore}get computedEstimateGasFee(){let t=this.defaultGasFee,e=this.commonStore.nowCurrencyUnit,r=T(this.computedQuote.bestRoute,"quoteNetWorkFeeOfMoney");if(this.isSwapSolana(this.fromToStore.from.chainId)&&this.quoteStore.enableQuoteAggregates){let a=T(this.rootStore.solanaPriorityFeeStore,"computedPriorityFeeOfUsd",0);r=b.add(a,r,{returnString:!0})}let s=b.BigNumber(r).multipliedBy(T(e,"usdToThisRate"));return!nr(e)&&!s.isNaN()&&(t=J(s.toJSON(),e?.symbol)),t}get computedCrossChainFromFee(){let t=T(this.computedQuote.bestRoute,"fromSwapFeeUsd");if(!t||cr(Number(t)))return"--";let{computedNowCurrencySymbol:e,currencyConversion:r}=this.commonStore,s=r(t).toString();return`${J(s,e)}`}updateTxHash(t){this.rootStore.sendTransactionStore.updateTxHash(t)}cancelOrder(t){t&&this.rootStore.sendTransactionStore.cancelOrder(t)}baseSaveOrderParams(){let{accountStore:t,computedQuote:e,fromToStore:r,quoteStore:s,gasDropStore:a}=this,{from:i,to:d}=r,{estimateGasFee:m,minimumReceived:h,gasDropAmount:f,defiPlatformId:g,traceData:y}=e.bestRoute||{},{computedIsMevOpen:P}=this.rootStore.mevStore,G={chainId:i.chainId,fromAmount:b.BigNumber(s?.computedQuoteAmount).toString(10),fromTokenAddress:i.tokenContractAddress,fromTokenDecimal:String(i.decimals),toAmount:d.reverseReceiveAmount,toTokenAddress:d.tokenContractAddress,toTokenDecimal:String(d.decimals),userWalletAddress:t.address,estimateGasFee:m,pmm:"1",gasDropType:a?.computedGasDropSelected?1:0,gasDropAmount:f,minimumReceived:h,openMev:P,toChainId:d.chainId,traceData:y};g&&(G.defiPlatformId=g);let L=this.rootStore.outerStore.extendFeeConfig(G);return this.saveOrderParamsExtendSlippageAndGasPrice(L)}saveOrderUrl(){return Lr}onSaveOrder(t){let e={...t,...se()};return p.info(S.SAVE_ORDER_PARAMS,{data:e}),x.post(this.saveOrderUrl(),e)}saveOrderErr(t){let{error_code:e,error_message:r=""}=t,s=t?.data?.code||e||"";return p.error(S.SAVE_ORDER_ERROR,{error:t,tags:{errorCode:e||s,error_msg:`${S.SAVE_ORDER_ERROR}_${s}`}}),e==="10014"?Ct.error({title:I("swaptrade_toast_trade_not_available")}):Ct.error({title:r||I("swaptrade_toast_save_order_fail")})}saveOrderError(t){this.saveOrderErr(t),this.isConfirmLoading=!1,p.removeKeep()}async onSwap(t){this.isConfirmLoading=!0,p.keepLive(),this.setCalldataSign(null);let e=this.saveOrderParams(),r=await this.extendSignParams(e);if(!r){this.isConfirmLoading=!1;return}if(this.isSwapSolana(r.chainId)){await this.onSolanaSwap(r);return}let[s,a]=await D(this.onSaveOrder(r));if(s){this.saveOrderError(s);return}p.info(S.SAVE_ORDER,{data:a?.data,tags:{orderId:a?.data.orderId}}),De({...bt(),order_id:a?.data.orderId,wallet_type:this.accountStore.walletConfig?.walletType});let[i]=await D(this.onChainTransaction({...a?.data,swapParams:r},t));i&&this.onWalletFail(i,a?.data?.orderId),this.isConfirmLoading=!1,p.removeKeep()}walletErrorMessage(t){let e=null;try{e=JSON.parse(t?.message)}catch{e={}}return e}walletErrToast(t,e){let r,s=this.walletErrorMessage(t);if(p.error(S.SEND_ERROR,{error:t,tags:{orderId:e}}),s?.code===Q.SLIPPAGE_LOW)r=I("swaptrade_home_toast_slippage_too_low");else if(s?.code===Q.SEND_TX_ERROR_CODE)r=s?.message;else if(s?.code===Q.NOT_TIPS)return null;return Ct.error({title:r||I("swaptrade_home_toast_broadcast_failed")})}onWalletFail(t,e,r=!1){Qe(t)?r||this.cancelOrder(e):t?.code!==Rr.RECEIPT_ERROR&&(Le.emit(Ne.FAIL,{data:{orderId:e},status:-2,message:Ce("transaction fail")}),this.walletErrToast(t,e)),p.error(S.ON_WALLET_FAIL,{error:t,tags:{orderId:e}})}extendEvmParams(t){return t}isOkxWallet(){}async getTransactionPayload({orderData:t,orderId:e}){let{from:r}=this.fromToStore;return de(r,{orderData:t,extParams:this.getExtParams(e)},this).getSendTransactionParams()}sendTransactionEnhance(...t){return this.rootStore.sendTransactionStore.sendTransaction(...t)}getTransaction(){}logChainId(){return!0}async doubleCheckChainId(){return!0}async onChainTransaction(t,e){let{callData:r,orderId:s,swapParams:a}=t,i=await this.getTransactionPayload({orderData:t,orderId:s}),{computedIsEvmChain:d,from:m}=this.fromToStore;if(p.info(S.PAYLOAD,{payload:i,tags:{orderId:s}}),e)try{await e(...i)}catch(f){return p.error(S.BEFORE_SEND_TRANSACTION_ERROR,{error:f}),!1}return this.logChainId({message:S.CHECK_CHAIN_ID_BEFORE_SEND_TRANSACTION,fromChainId:m.chainId,saveOrderChainId:a.chainId,orderId:s}),await this.doubleCheckChainId({saveOrderChainId:a.chainId,orderId:s})?this.sendTransactionEnhance(...i).then(({result:f,nonce:g})=>{if(!Xe(f))throw new Error(`hash format is invalid: ${f}`);return this.txInfo={...r,txHash:f},b.BigNumber(g).isNaN()?(this.updateTxHash({orderId:s,transactionHash:f}),d&&this.getTransaction(f,this.fromToStore.from.chainId).then(y=>{p.info(S.UPDATE_NONCE,{nonce:y.nonce,tags:{orderId:s}}),this.updateTxHash({orderId:s,transactionHash:f,nonce:y.nonce})}).catch(y=>{p.error(S.UPDATE_NONCE_FAIL,{error:y})})):this.updateTxHash({orderId:s,transactionHash:f,nonce:g}),this.afterTransaction(s),this.logChainId({message:S.CHECK_CHAIN_ID_AFTER_SEND_TRANSACTION,fromChainId:m.chainId,saveOrderChainId:a.chainId,orderId:s}),!0}):!1}afterTransaction(t){this.setWalletConfirm(!0),this.autoShowDialog&&this.showRecentTransactionModal(t),Le.emit(Ne.TXHASH,{status:0,data:N(this.txInfo),message:Ce("Transaction hash has been generated")})}get computedQuote(){return this.quoteStore.quote}checkRepeatOrderDetail(t){t&&this.rootStore.recentTransactionStore.showModal(t)}async onSolanaSwap(t){let e=this.extendSolanaCalldata(t),[r,s]=await this.getSolanaCalldata(e);if(r){this.saveOrderError(r);return}p.info(S.SAVE_ORDER,{data:s?.data,tags:{orderId:s?.data.orderId}}),De({...bt(),order_id:s?.data.orderId,wallet_type:this.accountStore.walletConfig?.walletType}),await this.solanaTransaction(s.data,e)}async onClaim(t){let{getAddressByChainId:e}=this.rootStore.accountStore,r=e(t.toChainId),s=await this.fetchClaimCalldata(t,r);if(!s||!s.payload)return!1;let{payload:a}=s;return await this.doubleCheckChainId({saveOrderChainId:t.toChainId,orderId:t.orderId})?(this.walletConfirming=!0,p.info(S.CLAIM_PAYLOAD,{payload:a,tags:{orderId:t.orderId}}),this.sendTransactionEnhance(...a).then(({result:d,nonce:m})=>{if(this.walletConfirming=!1,!Xe(d))throw new Error(`hash format is invalid: ${d}`);b.BigNumber(m).isNaN()?this.updateClaimOrder({mainOrderId:t.orderId,redeemTxHash:d}):this.updateClaimOrder({mainOrderId:t.orderId,redeemTxHash:d,nonce:m})}).catch(d=>{this.walletConfirming=!1,this.onWalletFail(d,t.orderId,!0)})):!1}};n();c();var cs=ut(["isWalletConfirm","isConfirmLoading","txInfo","confirmSwapVisible","walletConfirming"],["computedEstimateGasFee","computedCrossChainFromFee","computedQuote"]);var Bt=class extends Mt{constructor(e){super(e);o(this,"sendTransactionEnhance",e=>{let{from:r}=this.rootStore?.fromToStore,{walletSendParams:s}=this.rootStore.walletContractStore;return this.rootStore.sendTransactionStore.sendTransaction(r.chainId,e,s).then(a=>Do(r.chainId,a))});o(this,"showRecentTransactionModal",e=>{this.isConfirmLoading=!1,this.confirmSwapVisible=!1,p.stuff(`orderId: ${e}`),A.history.go(-1);let{advanceSetTypedValue:r}=this.rootStore?.fromToStore;r?.("")});o(this,"baseSaveOrderParams",()=>{let e=super.baseSaveOrderParams(),{walletMevControl:r}=this.rootStore.mevStore;return{...e,openMev:e.openMev||r}});o(this,"extendsGas",e=>{let r={...e},{gasInfo:s}=this.rootStore.walletContractStore,{gasLimitInfo:a,isGasLimitLoading:i,gasType:d,...m}=s;return r.extParams.gasType=d,{...r,gasInfo:m}});o(this,"extendEvmParams",e=>{let r=super.extendEvmParams(e),{activityId:s}=this.rootStore.walletContractStore,a=this.rootStore.quoteStore.quote?.bestRoute?.isEnableMev;s&&(r.extParams.activityId=s);let{computedIsMevOpen:i,mevInfo:d,walletMevControl:m}=this.rootStore.mevStore;return r.extParams.isMev=i||m,r.extParams.mevInfo=d,!i&&Number(a)===yr.ON&&(r.extParams.isShowBlockSwapMevTooltip=!0),r});o(this,"onWalletFail",(e,r)=>{this.isConfirmLoading=!1,!e?.message?.includes(A.global?.HARDWALLETERROR)&&super.onWalletFail(e,r)});o(this,"checkRepeatOrderDetail",e=>{e&&A.history.push(`${jt}/${e}`)});o(this,"checkUtxoBeforePublish",async e=>{let{utxoList:r}=e,{preDataForSendBtc:s}=this.rootStore.walletContractStore,{checkUtxoBeforePublish:a}=s;await a(r)});o(this,"onSwap",async()=>{this.isConfirmLoading=!0;let e=await A.checkMpcAccountIfNecessary();if(this.isConfirmLoading=!1,!e)return;let{computedIsOfflineType:r}=this.rootStore.quoteStore,{computedIsFromBtcCoin:s}=this.rootStore?.fromToStore;r?await this.rootStore.intentSwapStore?.onIntentSwap():await super.onSwap(s?this.checkUtxoBeforePublish:null)});o(this,"getSaveOrderMonitorData",()=>({...bt(),...this.rootStore.walletContractStore.computedMonitorGasType}));o(this,"onClaim",e=>{A.history.push(`${Sr}?orderId=${e.orderId}&source=orderDetail`)});st(this,cs)}isOkxWallet(){return!0}getTransaction(){}walletErrorMessage(e){return e}};n();c();ot();var Je=class{constructor(t){o(this,"sendTransactionParams",{});o(this,"waitingHandleOrderList",[]);o(this,"needIntercept",!1);o(this,"updateHistoryOrderList",t=>{let e=V(),r=[],s=[],a=this.rootStore.recentTransactionStore;a.pendingOrders.forEach(i=>{let d=i;i.orderId===t&&(d={...i,status:E.PendingRedeeming}),r.push(d)}),!e&&a.history?.list?.forEach(i=>{let d=i;i.orderId===t&&(d={...i,status:E.PendingRedeeming}),s.push(d)}),a.setPendingOrders(r),!e&&a.setHistory({...a.history,list:s})});o(this,"sendTransactionEnhance",async({callData:t,chainId:e,redeemOrderIdPre:r,redeemOrderId:s,bizType:a},i=()=>{})=>{let d=V(),m=`${r}:${s}`;if(!d&&this.setWaitingHandleList(m),this.needIntercept)return;let h;if(V()){let f=this.rootStore.swapStore.extendsGas(t);h=this.sendTransactionStore.sendTransactionEnhance(e,f,this.rootStore?.walletContractStore?.walletSendParams)}else{if(!await this.rootStore.commonStore.connectAndSwitchNetwork(e))return;h=this.sendTransactionStore.sendTransactionEnhance(t)}h.then(({result:f,hash:g,nonce:y})=>{!d&&this.setWaitingHandleList(m,!0),this.sendTransactionStore.updateTxHash({orderId:s,transactionHash:d?g:f,bizType:a,nonce:y}),fo(i),this.updateHistoryOrderList(r),d||this.sendTransactionStore.getTransaction(f,e).then(P=>{p.info(S.UPDATE_NONCE,{nonce:P.nonce,tags:{orderId:s}}),this.sendTransactionStore.updateTxHash({orderId:s,transactionHash:f,nonce:P.nonce,bizType:a})}).catch(P=>{p.error(S.UPDATE_NONCE_FAIL,{error:P,transactionHash:f,tags:{orderId:s}})})}).catch(f=>{!d&&this.setWaitingHandleList(m,!0),p.error(S.REDEEM_ORDER_ERROR,{error:f,tags:{orderId:s}})})});o(this,"walletSendRedeem",()=>{this.sendTransactionEnhance(this.sendTransactionParams,()=>{A.history?.goBack()})});o(this,"facetOrderDetail",{});this.rootStore=t,this.sendTransactionStore=t.sendTransactionStore,It(this,{},{autoBind:!0})}setSendTransactionParams(t){this.sendTransactionParams=t}async launchFacetSwap(t){let e=V(),{data:r}=this.rootStore.recentTransactionStore.detail,s=t?t.orderId:r?.orderId,a=t?t.chainId:r?.fromChainId,i=t?t.toTokenAddress:r?.toTokenAddress,d=t?t.fromTokenAddress:r?.fromTokenAddress,m={orderId:s,chainId:a,userWalletAddress:this.rootStore.accountStore.getAddressByChainId(a)};if(e&&t?.goOrderDetail){A.history?.push(`${jt}/${s}`);return}let[h,f]=await D(x.post(Xr,m));if(h){p.error(S.REDEEM_ORDER_CALL_DATA_ERROR,{error:h,tags:{orderId:s}}),Number(h?.code)===100002&&this.rootStore.recentTransactionStore.removePendingOrder(s),$.error({title:h?.msg||I("swaptrade_top_notif_data_failed")});return}let{redeemSignatureVo:g,redeemDetailInfo:y,redeemOrderId:P,bizType:G}=f?.data||{},{unsignedTx:L,...rt}=g||{},v={...rt,extParams:{toTokenAddress:i,crossChain:0,tokenAddress:d,amount:y.fromTokenAmount,toChainId:a,...m}},yt={callData:v,chainId:a,redeemOrderIdPre:s,redeemOrderId:P,bizType:G};if(this.setSendTransactionParams(yt),p.info(S.REDEEM_ORDER,{callData:v,tags:{orderId:P}}),e){this.setFacetOrderDetail({...y}),this.rootStore.walletContractStore.setTransactionPayload(v),A.history?.push({pathname:Tr,search:`needUpdate=${Ar.off}&type=${Er.REDEEM}`});return}await this.sendTransactionEnhance(yt)}setWaitingHandleList(t,e=!1){this.waitingHandleOrderList.find(s=>s===t)?e?(this.waitingHandleOrderList=this.waitingHandleOrderList.filter(s=>s!==t),this.needIntercept=!1):($.warn({title:I("swaptrade_history_notification_desc_wallet_confirm")}),this.needIntercept=!0):(this.waitingHandleOrderList=[...this.waitingHandleOrderList,t],this.needIntercept=!1)}getFacetExploreUrl(t){let{data:e}=this.rootStore.recentTransactionStore.detail,r=[e?.fromChildOrderDetailVo?.exploreUrl,e?.relativeTransaction?.exploreUrl];return this.computedIsFacetTradeType&&r?.[t]||""}get computedIsFacetTradeType(){let{data:{specialOrderType:t}}=this.rootStore.recentTransactionStore.detail;return t===Lo.FromIsEthChainFacetCoin}get computedShowFacetTip(){return this.rootStore.recentTransactionStore.detail.data.status===E.PendingCanRedeem}setFacetOrderDetail(t){this.facetOrderDetail=t}get computedFacetOrderToFromRate(){let{price:t}=this.facetOrderDetail;return t&&!ve(t)&&t!=="-1"?K(t):""}get computedFacetOrderFromToRate(){let{price:t}=this.facetOrderDetail;return t&&!ve(t)&&t!=="-1"?K(b.BigNumber("1").div(t).toString(10),{needBillionMillionUnit:!1}):""}get computedFacetOrderTokens(){let{fromToken:t,toToken:e,fromTokenAmount:r,toTokenAmount:s}=this.facetOrderDetail;return{fromToken:{...t,amount:r},toToken:{...e,amount:s}}}get computedFacetOrderMinimumReceived(){return this.facetOrderDetail.minimumReceived}get computedFacetTipParams(){let t=this.rootStore.recentTransactionStore.detail?.data;return{amount:K(t?.fromChildOrderDetailVo?.toAmountOut,{needBillionMillionUnit:!1}),token:t?.fromChildOrderDetailVo?.toTokenSymbol}}},ds=Je;n();c();j();ot();var Ze=class{constructor(t){o(this,"orderCheckContinue",async t=>{let[e,r]=await D(x.get(Jr,{params:t}));if(e)return $.error({title:I("swaptrade_history_toast_setup_error"),duration:mt}),!1;let s=T(r,"data"),a=String(s?.checkCode);return a===Et.SUCCESS?!0:(a===Et.SINGLE_ERROR||a===Et.LIMIT_SINGLE_ERROR?$.error({title:I("swaptrade_history_toast_chain_unsupported",{chain:s?.fromChainName}),duration:mt}):a===Et.CROSS_ERRORL||a===Et.LIMIT_CROSS_ERRORL?$.error({title:I("swaptrade_history_toast_both_unsupported",{fromChain:s?.fromChainName,toChain:s?.toChainName}),duration:mt}):$.error({title:I("swaptrade_history_toast_setup_error"),duration:mt}),!1)});this.rootStore=t,It(this,{},{autoBind:!0})}},ls=Ze;var le=class{constructor(){this.receiveAddressStore=new ss(this),this.commonStore=new Nt(this),this.accountStore=new jo(this),this.fromToStore=new Lt(this),this.swapStore=new Bt(this),this.facetStore=new ds(this),this.recentTransactionStore=new Mo(this),this.oneMoreOrderStore=new ls(this),this.sendTransactionStore=new is(this)}};n();c();var ct=w(F()),gs=w(Ie());n();c();var ue=w(F());n();c();var me=w(Os());async function js(l,t){let{devid:e}=await l.get("devid");return(r,s)=>{me.setDeviceId(e);let a=me.newInstance({site:"okex",product:r});return a.setApiEndpoint(`${t}/amplitude`),a.setCommonParams(Xt()),s(a),a}}async function tr(l,t){(await js(l,t))("web3_trade",Ao)}var $s=()=>{let[l,t]=(0,ue.useState)(!1);return(0,ue.useEffect)(()=>{let{getApiHostname:e}=A.global;tr(A.localStore,e()).then(()=>t(!0)).catch(()=>{})},[]),{initialized:l}},ms=$s;n();c();var H=w(F());n();c();var B=w(F()),z=w(Fe());n();c();var er=w(F()),us=w(Fe());var Ks=({expireTime:l,absoluteContent:t})=>er.default.createElement("div",{className:(0,us.default)(R.expireTime,t&&R.absoluteExpireTime)},er.default.createElement("div",{className:R.expireTimeContent},no(l*1e3)||"--")),he=Ks;var zs=l=>{let e=R.loader,r=s=>({icon:B.default.createElement(W.Circle,{size:W.SIZE.md,type:W.TYPE.neutral,loaderClassName:e,className:R.loaderWrap}),descClassName:(0,z.default)(R.pendDescKey),descKey:s});switch(l){case E.Pending:return r("swaptrade_order_status_pending");case E.Succeed:return{icon:B.default.createElement(tt,{className:(0,z.default)("okds-success-circle",R.successIcon),size:24}),descKey:"swaptrade_order_status_succeed"};case E.PendingWithdrawn:return{icon:B.default.createElement(tt,{className:(0,z.default)("okx-defi-marketplace-clock"),size:24}),descKey:I("swaptrade_history_cell_tag_processing")};case E.PendingCanRedeem:return{icon:B.default.createElement(tt,{className:(0,z.default)("okds-success-circle",R.pendingFacet),size:24}),descKey:I("swaptrade_history_cell_tag_pending_withdrawal")};case E.PendingRedeeming:return r("swaptrade_history_cell_tag_withdrawing");case E.Failed:return{icon:B.default.createElement(tt,{className:(0,z.default)("okds-fail-circle",R.failIcon),size:24}),descKey:"swaptrade_orders_text_details_order_failed",descClassName:R.failDesc};case E.Canceling:return{icon:B.default.createElement(W.Circle,{size:W.SIZE.md,type:W.TYPE.neutral,loaderClassName:e,className:R.loaderWrap}),descKey:"swaptrade_placeorder_title_canceling"};case E.Canceled:return{icon:B.default.createElement(tt,{className:(0,z.default)("okds-fail-circle",R.cancelIcon),size:24}),descKey:"swaptrade_placeorder_title_transaction_canceled"};case E.ReadyToClaim:case E.ClaimFailed:return{icon:B.default.createElement(tt,{size:24,className:(0,z.default)("okx-defi-dex-ready-to-claim")}),descKey:"swaptrade_bridge_cell_tag_ready_to_claim"};case E.Claiming:return{icon:B.default.createElement(W.Circle,{size:W.SIZE.md,type:W.TYPE.neutral,loaderClassName:e,className:R.loaderWrap}),descKey:"swaptrade_bridge_header_claiming"};default:return{}}};function Ys({order:l,className:t="",computedPendingTimingStatus:e,expireTime:r,showExpireTime:s}){let{status:a}=l,i=[E.Waiting,E.SpeedingUp].includes(a)?E.Pending:a,d=zs(i);return B.default.createElement("div",{className:R.headerStatusWrap},B.default.createElement("div",{className:(0,z.default)(R.status,t)},B.default.createElement("span",{className:R.headerStatusIcon},d?.icon),B.default.createElement("div",{className:(0,z.default)("font-700 font-18 content-primary",R.desc,d?.descClassName)},I(d?.descKey)||d?.descKey)),s&&i===E.Pending&&e===Zt.ESTIMATE&&B.default.createElement(he,{expireTime:r}))}var hs=Ys;n();c();var rr=w(F()),fs=w(Fe());var Xs=({isLimit:l,order:t,computedPendingTimingStatus:e,expireTime:r,onBack:s=()=>{},showBackButton:a})=>{let{status:i}=t||{},d=[E.Waiting,E.SpeedingUp].includes(i)?E.Pending:i;return{renderTopLeft:()=>a||l?rr.default.createElement(tt,{className:(0,fs.default)("okx-defi-dex-arrow-left",R.backIcon),size:24,onClick:s}):d===E.Pending&&e===Zt.ESTIMATE?rr.default.createElement(he,{expireTime:r,absoluteContent:!0}):null,closeIconClassName:R.closeIcon,topClassName:l?"":R.topWrapper}},ps=Xs;n();c();var Ts=w(F());var Wt=class extends Ts.PureComponent{constructor(t){super(t),this.state={hasError:!1,error:void 0,errorInfo:{}}}static getDerivedStateFromError(){return{hasError:!0}}componentDidCatch(t,e){this.setState({error:t,errorInfo:e}),this.props.isMainEntry?p.error("fatal rendering error",{error:t,errorInfo:e,level:"fatal"}):p.error(S.ERROR_BOUNDARY,{error:t,errorInfo:e}),this.props.onError&&this.props.onError(t,e)}onRetry(){this.setState({hasError:!1})}render(){let{error:t,errorInfo:e,hasError:r}=this.state;return r?this.props.fallbackComponent({error:t,errorInfo:e,onRetry:()=>this.onRetry()}):this.props.children}};n();c();var Ss={"loader-wrap":"_loader-wrap_7hvh8_1",loaderWrap:"_loader-wrap_7hvh8_1"};var Qs=({orderId:l,onClose:t,visible:e})=>{let{recentTransactionStore:r,swapStore:s}=Kt(),{showModal:a}=r,{onClaim:i}=s;(0,H.useEffect)(()=>{e&&a(l,{tab:C.SWAP})},[l,a,e]);let{computedOrderInfo:d,expireTime:m,computedPendingTimingStatus:h}=r||{},f=(0,H.useMemo)(()=>d?H.default.createElement(hs,{order:d,expireTime:m,computedPendingTimingStatus:h,showExpireTime:!1}):null,[d,m,h]),g=ps({isLimit:!1,order:d,computedPendingTimingStatus:h,expireTime:m,showBackButton:!1}),y=(0,H.useMemo)(()=>{let{status:L,toSymbol:rt}=d||{},v={onConfirm:()=>{Fo({fromChainId:d.chainId,toChainId:d.toChainId,bridgeRouter:d?.bridgeName}),i(d),t?.()},confirmText:I("swaptrade_bridge_btn_claim_token",{token:rt})};return[E.ReadyToClaim,E.ClaimFailed].includes(L)?{confirmBtnProps:{block:!0},...v}:L===E.Claiming?{confirmBtnProps:{block:!0,loading:!0,loadingText:v.confirmText},...v}:{}},[d,i,t]),P=(0,H.useRef)(null),G=()=>P.current;return H.default.createElement(mr.Action,{noContentPadding:!0,visible:e,onClose:t,title:f,...g,...y,scrollBoxRef:L=>{P.current=L}},H.default.createElement(Wt,{fallbackComponent:H.default.createElement(W.Circle,{size:W.SIZE.md,type:W.TYPE.neutral,className:Ss.loaderWrap})},H.default.createElement(Vo,{orderId:l,onClose:t,getScrollContainer:G})))},or=At(Qs);var Js=({orderId:l,onClose:t,visible:e,showToast:r,currency:s,currentWallet:a,walletInfo:i,onBack:d=()=>{},t:m,dispatch:h})=>{let f=(0,gs.useHistory)();(0,ct.useEffect)(()=>{A.setRuntimeContext({history:f,toLocale:m,dispatch:h,walletInfo:i,onBack:d})},[m,f,h,i,d]);let{commonStore:g,accountStore:y,recentTransactionStore:P}=Kt();(0,ct.useEffect)(()=>{g.setCurrentTab(C.SWAP),g.getUserUnit(s)},[]);let G=P?.detail?.data?.fromChainId;(0,ct.useEffect)(()=>{a&&y.setWalletConfig(a),G&&y.setFromChainId(G)},[G,y,a]);let{computedAccountWalletAddresses:L}=y;(0,ct.useEffect)(()=>{let v;return L&&(v=Wo(L)),()=>{L&&v?.()}},[L]),(0,ct.useEffect)(()=>{let v=Bo({isPri:!0,needLogin:!0,subscribeParams:{channel:Uo.DEX_PUSH_ENGINE},onListenData:yt=>{P.onSocket(yt,r)},onListenError:()=>{P.onSocketError()}});return()=>{v()}},[L,P,r]);let{initialized:rt}=ms();return rt?ct.default.createElement(or,{orderId:l,visible:e,onClose:t}):null},Cs=At(Js);var Is=new le,Zs=so(Is),ta=({orderId:l,onClose:t,visible:e,showToast:r=!1,localeData:s,currency:a,currentWallet:i,walletInfo:d,onBack:m,t:h,dispatch:f,walletGlobalData:g,...y})=>(A.mergeGlobalData(g),fe.default.createElement(Zs.Provider,{value:Is},fe.default.createElement(Me,{localeData:s,isDev:!0,noRemoteData:!0,customRender:P=>P},fe.default.createElement(Cs,{orderId:l,onClose:t,visible:e,showToast:r,currency:a,currentWallet:i,walletInfo:d,onBack:m,t:h,dispatch:f,...y})))),pe=ta;n();c();var dt=w(F()),sr=w(Ie()),As=w(xs());var ea=({orderId:l,onClose:t,...e})=>{let r=document.createElement("div");document.body.appendChild(r);let s=(0,As.createRoot)(r),a=()=>{s.unmount(),r.remove(),t&&t()},i=({currentId:m})=>{let[h,f]=(0,dt.useState)(!0);return dt.default.createElement(pe,{visible:h,orderId:m,onClose:()=>{f(!1),setTimeout(()=>{a()},100)},...e})};return s.render(dt.default.createElement(sr.HashRouter,null,dt.default.createElement(i,{currentId:l}))),{close:a,updateOrderId:m=>{s.render(dt.default.createElement(sr.HashRouter,null,dt.default.createElement(i,{currentId:m})))}}},Es=ea;var ra=lt.default.lazy(()=>import("./Advanced-KSCGIYGP.js")),oa=lt.default.lazy(()=>import("./MemeMode-YBWXWIMN.js")),sa=({...l})=>lt.default.createElement(Ut.Switch,null,lt.default.createElement(Ut.Route,{path:"/dex-swap/meme",render:()=>lt.default.createElement(oa,{...l})}),lt.default.createElement(Ut.Route,{path:"/dex-swap",render:()=>lt.default.createElement(ra,{...l})}));var dp=At(sa);export{Me as a,ut as b,jo as c,di as d,li as e,et as f,We as g,Nt as h,He as i,oe as j,Lt as k,ss as l,is as m,Ft as n,de as o,Vs as p,Gs as q,Qe as r,Bt as s,ds as t,ls as u,ms as v,Wt as w,or as x,Es as y,dp as z};

window.inOKXExtension = true;
window.inMiniApp = false;
window.ASSETS_BUILD_TYPE = "publish";

//# sourceMappingURL=chunk-EEFD5KZC.js.map
