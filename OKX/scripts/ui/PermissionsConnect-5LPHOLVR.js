import{b as Ut}from"./chunk-PANWMONP.js";import{c as qe}from"./chunk-N2SRRBHC.js";import{a as De,b as Le}from"./chunk-XVXZXT5F.js";import{a as Pe}from"./chunk-CBKILZK2.js";import{a as Me}from"./chunk-2W6CXXNZ.js";import"./chunk-BARA7AIG.js";import{a as Ne}from"./chunk-3YGJNBCZ.js";import{a as at}from"./chunk-U7LFLL6J.js";import{a as k,d as P}from"./chunk-HOU3VS5H.js";import{a as it}from"./chunk-IP7VSGCS.js";import{a as xe,b as kt}from"./chunk-XYDICNP3.js";import{l as M}from"./chunk-2LCPVMSO.js";import"./chunk-Q57GWOMY.js";import"./chunk-3XTUMVWB.js";import"./chunk-MGYCOFIC.js";import"./chunk-6THUPAMO.js";import"./chunk-FK5ARFJK.js";import"./chunk-6Y7SZIB7.js";import"./chunk-VVYJA72I.js";import"./chunk-OWWFH26C.js";import"./chunk-MNZIO3NP.js";import"./chunk-HEFTA5OH.js";import"./chunk-S7NLB5XS.js";import"./chunk-UUWJWUOY.js";import{a as Oe,b as be}from"./chunk-IIBMWABX.js";import{a as We,c as Et,d as ve}from"./chunk-BXTE3YT2.js";import"./chunk-2DF43JKM.js";import"./chunk-JAGKSBYF.js";import{e as Ie}from"./chunk-CR2CPF4X.js";import"./chunk-HKZGONPS.js";import{a as Ee}from"./chunk-IIAVVYHZ.js";import"./chunk-TSTKPLAO.js";import"./chunk-52XLG23J.js";import"./chunk-EEFD5KZC.js";import"./chunk-73ZHJYCP.js";import"./chunk-3NSLXJYR.js";import"./chunk-ENPNPH37.js";import"./chunk-5QJIR6ZJ.js";import"./chunk-H6SNSZIS.js";import"./chunk-YWECPG37.js";import"./chunk-AXJECT36.js";import"./chunk-5BIOTNBS.js";import"./chunk-R5SMHBLJ.js";import"./chunk-IY4RYRL6.js";import"./chunk-4OAEJJK5.js";import"./chunk-34VLVCKN.js";import"./chunk-J4ZKBKEJ.js";import"./chunk-TFJRUJHH.js";import"./chunk-7NMUCCUG.js";import"./chunk-YF3DWJDS.js";import"./chunk-RH4ISAHA.js";import"./chunk-ECQND2NK.js";import"./chunk-W3L3YTJO.js";import"./chunk-M5NI6HPE.js";import"./chunk-YQHUKBMA.js";import"./chunk-VM2NMLPX.js";import"./chunk-YP7CHBKG.js";import"./chunk-FNXLAYUB.js";import"./chunk-PQK3LXXN.js";import"./chunk-FTRHGHDS.js";import"./chunk-XT3EOPTE.js";import"./chunk-A6Z53EN6.js";import"./chunk-LL63GZNI.js";import"./chunk-M7CL2K7X.js";import"./chunk-W2CTJYFJ.js";import"./chunk-XUKVTAH5.js";import"./chunk-5OJTPISL.js";import"./chunk-7UPVX2FL.js";import"./chunk-BSFXZ46S.js";import"./chunk-ZMCTBWUY.js";import"./chunk-UMGTYP2Z.js";import"./chunk-5F6JALEN.js";import{b as Bt}from"./chunk-LR7KSTP2.js";import{a as Te,b as Ce}from"./chunk-QCP7SXMX.js";import{c as ge}from"./chunk-W23ABSXX.js";import"./chunk-BVDJNUOM.js";import"./chunk-7B5UI77E.js";import"./chunk-R6X7EOIE.js";import{e as S,g as yt}from"./chunk-MKEYCSLA.js";import"./chunk-4EFZXPDV.js";import"./chunk-4KODREVA.js";import"./chunk-6UWGBJGT.js";import"./chunk-G4AVWXHJ.js";import"./chunk-76CRIMII.js";import"./chunk-F7VSWGDW.js";import{L as me,b as ce}from"./chunk-KLLSVAFY.js";import"./chunk-MBHGLWZJ.js";import"./chunk-QZO7W5WD.js";import"./chunk-AKE54ZCC.js";import"./chunk-EHZWM44P.js";import"./chunk-K6STDTUY.js";import"./chunk-A57OTXBP.js";import"./chunk-YJQGXXOQ.js";import"./chunk-HTLOGWI7.js";import"./chunk-6SEP5B7P.js";import"./chunk-FHKOH5E6.js";import"./chunk-NTQ2YVDA.js";import"./chunk-KKG4PJ6O.js";import"./chunk-7SRLIN7D.js";import"./chunk-AW5NL3JM.js";import"./chunk-RI2WZ5PA.js";import{i as he}from"./chunk-YIAOHVF5.js";import"./chunk-KBS3PMLQ.js";import"./chunk-7GKX3YKG.js";import"./chunk-7HFBMBFB.js";import"./chunk-TJCPJQIM.js";import"./chunk-ZTAZ2272.js";import{e as ye,g as St,i as Ae}from"./chunk-IRMYAC6R.js";import"./chunk-Q76QXAWY.js";import"./chunk-THSNJ5WU.js";import"./chunk-65AJJVJY.js";import"./chunk-PDC447BO.js";import"./chunk-JI6FOZGR.js";import"./chunk-JCM7SRK2.js";import{h as le}from"./chunk-XKL64FTO.js";import{a as Se}from"./chunk-PTD7UCOR.js";import"./chunk-Q4YTGP2G.js";import"./chunk-ETJEH7T4.js";import{a as we}from"./chunk-V3IFYKWM.js";import"./chunk-EWTTD4DL.js";import"./chunk-Y2TPPS4H.js";import"./chunk-ITY22AD4.js";import"./chunk-E2JYOUYE.js";import"./chunk-B3JSNQIV.js";import{a as Rt,b as fe,gb as de,h as b,j as B}from"./chunk-YALUYHLV.js";import"./chunk-I3CPAVOC.js";import"./chunk-ARWSGU73.js";import"./chunk-CZ2ZBAZV.js";import{o as wt}from"./chunk-5QMHGZLF.js";import{Nb as ae,Ua as se,ec as x,vb as j,xb as ie}from"./chunk-HPWCPLRR.js";import"./chunk-O6ZBO5JF.js";import"./chunk-TSTPZ3JM.js";import"./chunk-D2LKUI4F.js";import{a as At}from"./chunk-ON6S2DB7.js";import{j as R,n as pe,p as ht}from"./chunk-SZD6WTBQ.js";import"./chunk-ASR4HLU7.js";import"./chunk-ANIUN6US.js";import{s as Ct,u as qo}from"./chunk-3DZ7WRLL.js";import{d as rt,f as zt}from"./chunk-DEOJU4Z3.js";import"./chunk-PLIIQKFY.js";import"./chunk-6BXYJZHH.js";import"./chunk-CCEMKRO6.js";import"./chunk-2HSCH6R3.js";import"./chunk-CWNIM6RS.js";import"./chunk-NNAD25BL.js";import{f as ue}from"./chunk-XV444F26.js";import{E as ne}from"./chunk-N2BCRNDB.js";import"./chunk-RTFE54S3.js";import"./chunk-GCQ4H2BA.js";import"./chunk-JGEHAFTO.js";import"./chunk-UVFOW4HH.js";import{g as _e}from"./chunk-LNOPECCQ.js";import"./chunk-CB7FOZNP.js";import{c as st}from"./chunk-43VURGIT.js";import{$c as ee,Fa as Xt,H as Wo,Ib as q,Na as Lo,R as _t,Ua as Jt,ad as oe,ec as Tt,gb as Zt,ha as Vt,ib as Qt,jb as te,ka as gt,qa as vo,rc as nt,rd as re,u as dt}from"./chunk-TM67VPZU.js";import"./chunk-VW6OQNWT.js";import{H as Kt,d as jt,f as Ht}from"./chunk-PUSMMCUD.js";import{R as L,z as _}from"./chunk-UWJLNJLY.js";import"./chunk-VRY2ADKE.js";import"./chunk-VWEB6W6G.js";import"./chunk-5U7FO2PW.js";import"./chunk-PDUOSATP.js";import{L as ft,f as ut,ra as Lt}from"./chunk-XDY6V34Y.js";import"./chunk-YJFNO57I.js";import"./chunk-DZ6CTC22.js";import{$ as qt,c as Do}from"./chunk-JT3LNHPY.js";import"./chunk-47UWF72W.js";import{b as w}from"./chunk-JWYCKY2V.js";import"./chunk-G2266BV2.js";import"./chunk-L4PAIYPH.js";import"./chunk-UT7LJPKF.js";import"./chunk-AFZ6A2B3.js";import"./chunk-VVPY7ZA7.js";import"./chunk-KUW5VATV.js";import"./chunk-BNAVWOJ2.js";import"./chunk-IG2Q5ALZ.js";import"./chunk-WOMUNWBT.js";import"./chunk-QNGB57GN.js";import"./chunk-NM2PDVBD.js";import"./chunk-7U3DN5ZD.js";import"./chunk-F6PXOVYL.js";import"./chunk-324EPGNQ.js";import"./chunk-5GFHI4AK.js";import"./chunk-QYVQBXDG.js";import"./chunk-7D4PUIEN.js";import"./chunk-IWVM7XL6.js";import"./chunk-7QO4TZYQ.js";import"./chunk-FF4LY6PE.js";import"./chunk-76KCDJDG.js";import"./chunk-YDUDQP2P.js";import"./chunk-PGPFV4JQ.js";import"./chunk-MIBHDVGP.js";import"./chunk-7VFUX7IX.js";import"./chunk-XLF4LAH2.js";import"./chunk-ONKZ57T6.js";import"./chunk-ZC7Q7LCH.js";import{f as p,o as e,q as o}from"./chunk-6KXF36WM.js";e();o();var v=p(w()),tt=p(x()),D=p(At()),Mo=p(wt());ht();vo();Wo();e();o();var Re=p(w()),Be=(0,Re.lazy)(()=>import("./Comp-KL4WAO5K.js"));e();o();var W=p(w());te();e();o();var ze=p(w());e();o();var N=p(w()),Ge=p(x()),$e=p(At());L();re();e();o();var E=p(w()),ke=p(At());Lt();L();te();e();o();var It={root:"_root_oli0p_1",multiAccount:"_multiAccount_oli0p_4",count:"_count_oli0p_9"};var Bo="account-selector",ko=t=>{let r=(0,ke.useHistory)(),{permissionsRequestId:n,request:s,dappSelectAccount:a,walletInfo:i={},connectable:c=!0,hiddenAddress:m=!1,disableSelectAccount:f=!1}=t,{method:d,provider:g,status:T}=Et({dappUrl:s?.metadata?.origin}),l=()=>{r.push({pathname:`${b}/${n}${B}`})},h=(0,E.useMemo)(()=>m?"":s?.providerType===Jt?_("wallet_extension_cosmos_text_cosmos_network"):i.address,[m,s?.providerType,i.address]),C=We({provider:g,method:d}),A=()=>a.length<=1?C?E.default.createElement(k,{bordered:!1},E.default.createElement(kt,{onClick:f?void 0:ut,hiddenAddress:m,copyable:!1,title:_("wallet_dapp_conncetion_requesr_subtitle_current_account"),walletId:i.walletId,address:_("wallet_extension_expand_all_networks"),show7702Tag:!0})):E.default.createElement(k,{bordered:!1},E.default.createElement(kt,{onClick:f?void 0:ut,copyable:!1,title:_("wallet_dapp_conncetion_requesr_subtitle_current_account"),walletId:i.walletId,address:h,hiddenAddress:m,connectable:c,show7702Tag:!0})):E.default.createElement(k,{bordered:!1},E.default.createElement(xe,{title:_("wallet_dapp_conncetion_requesr_subtitle_current_account")},E.default.createElement(st.Box,{className:It.multiAccount},E.default.createElement(st.Box,{className:It.count},_("wallet_extension_mid_text_accounts",{num:a.length})),E.default.createElement(Ut,{className:`${Bo}__info-arrow`,side:Ut.SIDE.RIGHT}))));return E.default.createElement("div",{className:It.root,onClick:f?ut:l},T!=="PENDING"&&A())},Ue=ko;function Uo({targetDomainMetadata:t,permissionsRequestId:r,request:n,walletInfo:s,connectable:a,tipMessage:i,buttonGroup:c,hiddenAddress:m,disableSelectAccount:f,RequestedNetworks:d,children:g,title:T}){let l=(0,$e.useHistory)(),h=(0,Ge.useSelector)(S),C=ye();return N.default.createElement(st.Container,null,N.default.createElement(Se,{backable:!1,closeable:!1,title:T??_("wallet_dapp_conncetion_maintitle_conncet_account")}),N.default.createElement(k,null,N.default.createElement(Me,{...t})),N.default.createElement(Ue,{targetDomainMetadata:t,permissionsRequestId:r,request:n,dappSelectAccount:h,walletInfo:s,disableSelectAccount:f,hiddenAddress:m,connectable:a}),d&&N.default.createElement(d,{request:n}),g,N.default.createElement(we,{placeholder:!0,offsetBottom:0,borderTop:!0},N.default.createElement(P,{...i}),N.default.createElement(M,{buttonGroup:c})),s?.keyringIdentityType===oe.MPC&&N.default.createElement(De,{keyringId:s.keyringId,customConfig:C?.length===1?{confirmText:_("wallet_extension_btn_general_gotit")}:{},actionMap:{["RECOVER"]:()=>{l.push(`${de}?action=${Ee.RECOVER}&walletId=${s.walletId}`)},["SWITCH_WALLET"]:async()=>C?.length===1?(await c[0]?.onClick(),l.push(fe)):l.push({pathname:`${b}/${r}${B}`})}}))}var H=Uo;e();o();var Fe=p(x());function Go(t){let r=St(),s=(0,Fe.useSelector)(S)[0]||r,{walletInfo:a,connectable:i,chainName:c,status:m}=ve({dappUrl:t,walletId:s}),f=Le(s);return{targetWalletId:s,walletInfo:a,connectable:i,chainName:c,mpcConnectable:f,status:m}}var K=Go;e();o();var z=p(x()),Ye=p(At()),Gt=p(wt());L();ht();function $t({disabled:t,request:r,targetDomainMetadata:n,cancelPermissionsRequest:s,approvePermissionsRequest:a,connectSource:i,connectChains:c}){let m=(0,z.useDispatch)(),f=n?.origin,d=at(),g=(0,z.useSelector)(S),T=Et({dappUrl:f});return async()=>{if(t)return;d({trade:"connect_wallet",all_confirmation:"confirm"});let h={...r,permissions:{...r.permissions}};if(Object.keys(h.permissions).length>0){if(await a(h,g),g.length===1&&await m(le(g[0],!0)),me({dapp_url:f}),T?.dappUrl&&T?.provider){let C={dappurl:T.dappUrl,connect_method:i||T.provider,dappname:n?.name,full_url:n?.url};c&&(C.chain=c),ce(C)}}else await s(h.metadata.id);await R(m)}}var $o=({props:t,isMpcError:r,connectable:n,confirmBtnText:s,onConfirm:a,onCancel:i,connectSource:c,connectChains:m,disabledConfirmBtn:f=!1})=>{let d=(0,z.useDispatch)(),g=(0,Ye.useHistory)(),T=(0,z.useSelector)(S),{permissionsRequestId:l,targetDomainMetadata:h,cancelPermissionsRequest:C,approvePermissionsRequest:A,request:U}=t,G=at(),I=(0,Gt.useMemoizedFn)(async()=>{G({trade:"connect_wallet",all_confirmation:"cancel"}),i?await i(l):await C(l),await R(d)}),{loading:et,onClick:ot}=it(I),Y={actionType:M.ACTION_TYPE.CANCEL,onClick:ot,loading:et},$=$t({request:U,targetDomainMetadata:h,approvePermissionsRequest:A,cancelPermissionsRequest:C,connectSource:c,connectChains:m}),V=(0,Gt.useMemoizedFn)(async()=>{n?a?await a():await $():g.push({pathname:`${b}/${l}${B}`})}),{loading:vt,onClick:lt}=it(V),Dt={actionType:M.ACTION_TYPE.CONFIRM,disabled:f||n&&(T.length===0||r),btnText:n?s||_("wallet_extension_connect_btn_connect"):_("wallet_extension_connect_btn_switch_wallet"),onClick:lt,loading:vt};return[Y,Dt]},X=$o;e();o();var Ve=p(w());var xt=p(x());function Fo(t,r){let n=(0,xt.useDispatch)(),s=(0,xt.useSelector)(S),{connectable:a,mpcConnectable:i}=t;(0,Ve.useEffect)(()=>{if(!s.length&&a&&i&&r){let c=Array.isArray(r)?r:[r];n(yt.setSelectAccounts(c))}},[s,a,i,r])}var J=Fo;e();o();var je=p(w());L();function Yo({isMpcError:t,connectable:r,chainName:n}){return(0,je.useMemo)(()=>t?{type:P.TIP_TYPE.COMMON_ERROR,message:_("extension_wallet_error_toast_not_supported")}:r?{type:P.TIP_TYPE.NORMAL,message:_("wallet_dapp_conncetion_notify_conncet_permission")}:{type:P.TIP_TYPE.COMMON_WARN,message:_("wallet_extension_connect_alert_text_doesnt_support_network",{network:n})},[t,r,n])}var Nt=Yo;e();o();var Ke=p(w()),Ft=p(x());re();e();o();var Mt=p(w());var He=(t,r)=>{let[n,s]=(0,Mt.useState)(!1);return(0,Mt.useEffect)(()=>{(async()=>{if(t&&r){let{data:a}=await Ie({dappUrl:t});s(a.result)}})()},[t,r]),n};function Vo(t){let r=(0,Ft.useSelector)(S),n=(0,Ft.useSelector)(ie),s=(0,Ke.useMemo)(()=>r.some(i=>n.find(c=>c.walletId===i)?.initialType===ee.MPC_KEYRING),[r,n]),a=He(t?.host,s);return s&&!a}var Z=Vo;function jo(t){let{targetDomainMetadata:r,permissionsRequestId:n,request:s}=t,a=St(),i=K(r?.origin),{walletInfo:c,connectable:m,chainName:f,status:d}=i,g=Z(r),T=Nt({isMpcError:g,connectable:m,chainName:f}),l=X({props:t,isMpcError:g,connectable:m});return J(i,a),d==="PENDING"?null:ze.default.createElement(H,{targetDomainMetadata:r,permissionsRequestId:n,request:s,walletInfo:c,connectable:m,tipMessage:T,buttonGroup:l})}var Xe=jo;e();o();var to=p(w()),eo=p(x());nt();e();o();Lt();nt();Vt();var Ho=({props:t,isMpcError:r,connectable:n,walletInfo:s={},nearAmount:a})=>{let{walletId:i,address:c}=s,m=X({props:t,isMpcError:r,connectable:n});return!ft(a)&&_t(a,0)&&(m[1]={actionType:M.ACTION_TYPE.FILL_UP,coinId:Tt,walletId:i,address:c,receiveOnly:!0}),m},Je=Ho;e();o();var Ze=p(w());Lt();L();Vt();function Ko({nearAmount:t,isMpcError:r,connectable:n,chainName:s}){return(0,Ze.useMemo)(()=>!ft(t)&&_t(t,0)?{type:jt.TYPE.warn,message:_("wallet_extension_conncetion_alert_add_more")}:r?{type:P.TIP_TYPE.COMMON_ERROR,message:_("extension_wallet_error_toast_not_supported")}:n?{type:P.TIP_TYPE.NORMAL,message:_("wallet_extension_conncetion_alert_check_balance")}:{type:P.TIP_TYPE.COMMON_WARN,message:_("wallet_extension_connect_alert_text_doesnt_support_network",{network:s})},[t,r,n,s])}var Qe=Ko;var zo=t=>{let{targetDomainMetadata:r,permissionsRequestId:n,request:s}=t,a=(0,eo.useSelector)(j),i=K(r?.origin),{walletInfo:c,connectable:m,chainName:f,targetWalletId:d}=i,g=Z(r),T=Ne(Tt,d)?.coinAmountInt,l=Qe({targetWalletId:d,isMpcError:g,connectable:m,chainName:f,nearAmount:T}),h=Je({props:t,isMpcError:g,connectable:m,walletInfo:c,nearAmount:T});return J(i,a),to.default.createElement(H,{targetDomainMetadata:r,permissionsRequestId:n,request:s,walletInfo:c,connectable:m,tipMessage:l,buttonGroup:h})},oo=zo;e();o();e();o();var Xo=()=>null,ro=Xo;var no=ro;e();o();var pt=p(w());L();e();o();var ct=p(w()),io=p(Do());e();o();var so={item:"_item_11fx7_1"};function Jo({className:t,message:r}){return ct.default.createElement(ct.default.Fragment,null,ct.default.createElement(k,{bordered:!1,className:(0,io.default)(so.item,t)},ct.default.createElement(Pe,{message:r})))}var ao=Jo;e();o();var _o=p(w());L();zt();nt();qo();e();o();var co=p(x()),mo=p(wt());ht();function Zo({disabledSubmit:t,confirmBtnLoading:r,permissionsRequestId:n,cancelPermissionsRequest:s,request:a,targetDomainMetadata:i,approvePermissionsRequest:c}){let m=(0,co.useDispatch)(),f=at(),d=(0,mo.useMemoizedFn)(async()=>{f({trade:"connect_wallet",all_confirmation:"cancel"}),await s(n),await R(m)}),{loading:g,onClick:T}=it(d),l={loading:g,actionType:M.ACTION_TYPE.CANCEL,onClick:T},h=$t({request:a,targetDomainMetadata:i,approvePermissionsRequest:c,cancelPermissionsRequest:s}),C={loading:r,disabled:t,actionType:M.ACTION_TYPE.CONFIRM,onClick:h};return[l,C]}var po=Zo;e();o();var Pt=p(w()),lo=p(wt());nt();Lo();function Qo(t,r){let n=(0,Pt.useRef)(r?.origin),a=(t?.providersExts?.[q]??t?.exts)?.message?.manifestUrl,[i,c]=(0,Pt.useState)(!0);return(0,lo.useMount)(()=>{(async()=>{if(a)try{let f=await Xt(a);if(f?.status===200){let d=f.data;typeof d?.url=="string"&&(n.current=d.url)}}finally{c(!1)}else c(!1)})()}),{loading:i,domain:n.current}}var uo=Qo;e();o();var bt=p(w()),Ot=p(x());function tr(t){let r=(0,Ot.useSelector)(j),n=(0,Ot.useSelector)(S),s=(0,Ot.useSelector)(c=>he(c,t?.origin)),[a,i]=(0,bt.useState)(null);return(0,bt.useEffect)(()=>{(async()=>{r&&n.includes(r)?i(r):s&&n.includes(s)?i(s):i(n[0])})()},[r,n,s]),a}var fo=tr;var er=({request:t,targetDomainMetadata:r,permissionsRequestId:n,approvePermissionsRequest:s,cancelPermissionsRequest:a,isSilentConnected:i})=>{let c=fo(r),{loading:m,domain:f}=uo(t,r),d=Ae(c,q),l=((t?.providersExts?.[q]??t?.exts)?.message?.items||[]).filter(({name:A})=>A===se.TON_PROOF),h=l.length===1?`${l[0].payload||""}`:l.map(({payload:A})=>({value:A}));(0,_o.useEffect)(()=>{Ct("Sign Ton Proof UI",{tonAddress:d})},[d]);let C=po({disabledSubmit:m,permissionsRequestId:n,request:t,targetDomainMetadata:r,approvePermissionsRequest:async(A,U,G)=>{try{let I=Math.round(Date.now()/1e3),et=new URL(f).host,ot=await Promise.all(l.map(async({payload:Y})=>{let $;try{Ct("Call Sign Ton Proof",{tonAddress:d}),$=await rt().signTonProof({proof:{timestamp:I,domain:et,payload:Y}},d,c)}catch(V){throw Ct("Error Sign Ton Proof",{tonAddress:d,isReject:V?.message===ne}),V}return{payload:Y,signature:$}}));A.resultParams={domain:f,timestamp:I,signatures:ot}}catch{return Kt.error({title:_("wallet_extension_ton_error_signature_support")}),null}return s(A,U,G,!i)},cancelPermissionsRequest:a});return{tonProofs:l,message:h,buttonGroup:C}},go=er;e();o();var mt=p(w()),To=p(x());zt();nt();function or({targetDomainMetadata:t,dappMetadata:r,alwaysNeedProof:n}){let s=(0,To.useSelector)(j),[a,i]=(0,mt.useState)(null),[c,m]=(0,mt.useState)(!0);return(0,mt.useEffect)(()=>{(async()=>{if(!n){m(!1);return}try{(await rt().getPermittedWallets(t?.origin,q,!1)).length>0&&i(await rt().getPermittedWallets(t?.origin,q,!0))}finally{m(!1)}})()},[n]),J(r,c?null:a||s),{loading:c,isSilentConnected:!!a}}var Co=or;e();o();var ho={loading:"_loading_po7pc_1"};function rr(t){let{alwaysNeedProof:r,targetDomainMetadata:n,permissionsRequestId:s,request:a}=t,i=K(n?.origin),{walletInfo:c,connectable:m,chainName:f}=i,d=Z(n),g=Nt({isMpcError:d,connectable:m,chainName:f}),T={props:t,isMpcError:d,connectable:m,connectSource:a?.exts?.connectSource},l=X(T),{loading:h,isSilentConnected:C}=Co({targetDomainMetadata:n,dappMetadata:i,alwaysNeedProof:r}),{tonProofs:A,message:U,buttonGroup:G}=go({...t,isSilentConnected:C}),I=A?.length>0;return h?pt.default.createElement("div",{className:ho.loading},pt.default.createElement(qt.Circle,{size:qt.SIZE.lg})):pt.default.createElement(H,{targetDomainMetadata:{...n,host:n.origin||n.host},permissionsRequestId:s,request:a,walletInfo:c,connectable:m,tipMessage:g,buttonGroup:I?G:l,title:I?_("wallet_extension_header_connect_sign"):void 0},pt.default.createElement(ao,{message:U}))}var wo=rr;e();o();e();o();var nr=()=>null,yo=nr;var Ao=yo;e();o();var Q=p(w());L();e();o();var Wt={root:"_root_h6iyb_1",animation:"_animation_h6iyb_14",text:"_text_h6iyb_17"};var sr=({onComplete:t})=>{let[r,n]=(0,Q.useState)(!1),s=_e({dark:"/static/images/dapp/success-dark.json",light:"/static/images/dapp/success-light.json"});return Q.default.createElement("div",{className:Wt.root},Q.default.createElement(Ht,{className:Wt.animation,path:s,loop:!1,onDataReady:()=>{n(!0)},onComplete:t}),r?Q.default.createElement("span",{className:Wt.text},_("wallet_home_foot_dapp_connceted")):null)},So=sr;var Eo=({chooseAccountProps:t,showAni:r})=>{let n=t?.request?.providerTypes,s=t?.request?.providersExts,a=t?.request?.exts?.alwaysNeedProof,i=t?.request?.providerType,c=!!n,m=t?.request?.exts?.isShowWalletConnect;return W.default.createElement(W.default.Fragment,null,(()=>{switch(!0){case m:return W.default.createElement(Ao,{providerTypes:n,providersExts:s,...t});case c:return W.default.createElement(no,{providerTypes:n,providersExts:s,...t});case(i===Zt&&a):return W.default.createElement(oo,{...t});case i===Qt:return W.default.createElement(wo,{alwaysNeedProof:a,...t});default:return W.default.createElement(Xe,{...t})}})(),r&&W.default.createElement(So,{onComplete:()=>{t?.onComplete()}}))};e();o();e();o();var Io=p(x());ht();function xo(){let t=(0,Io.useDispatch)();return()=>t(pe())}var No=xo;e();o();var ir=({environmentType:t,history:r})=>{t!==dt&&r.push(Rt)},ec=()=>{let t=(0,tt.useDispatch)(),r=(0,D.useHistory)(),s=(0,D.useRouteMatch)().params.id,i=(0,tt.useSelector)(ge).find(y=>y.metadata.id===s),c=i?.providerTypes,[m,f]=(0,v.useState)(!1),d=(0,tt.useSelector)(Ce),g=(0,tt.useSelector)(ae),{metadata:T={}}=i||{},{origin:l,url:h}=T,C=null;if(l)if(g[l])C={...g[l],origin:l,url:h},C.icon??=ue;else{let y=new URL(l);C={host:y.host,name:y.hostname,origin:l,url:h}}let A=`${b}/${s}`,U=`${b}/${s}${B}`,G=async(y,O,F)=>{await t(Oe(y,O,F))},I=async(y,O,F)=>{await t(be(y,O,F)),await t(Bt())},et=()=>t(qe()),ot=No(),Y=()=>t(yt.setSelectAccounts([])),$=()=>{s&&d===Te.connect&&I(s,l)},V=()=>{gt()===dt&&window.addEventListener("beforeunload",$)},vt=()=>{gt()===dt&&window.removeEventListener("beforeunload",$)},lt=()=>{vt();let y=gt();return ir({environmentType:y,history:r}),null},Dt=async(y,O)=>{y&&(await I(y,l,O),await R(t),lt())},Yt=()=>{f(!1),lt(),t(Bt())};(0,Mo.useMount)(()=>{if(ot(),et(),!i){r.push(Rt);return}V(),Y()});let Po=c;return v.default.createElement("div",{className:"page-container permissions-connect"},v.default.createElement(D.Switch,null,v.default.createElement(D.Route,{path:U,exact:!0,render:()=>v.default.createElement(Be,{request:i||{},multi:!Po})}),v.default.createElement(D.Route,{path:A,exact:!0,render:()=>v.default.createElement(Eo,{chooseAccountProps:{request:i||{},cancelPermissionsRequest:(O,F)=>Dt(O,F),permissionsRequestId:s,targetDomainMetadata:C,onComplete:Yt,approvePermissionsRequest:async(O,F,Oo,bo=!0)=>{await G(O,F,Oo),await R(t),bo?f(!0):Yt()}},showAni:m})})))};export{ec as default};

window.inOKXExtension = true;
window.inMiniApp = false;
window.ASSETS_BUILD_TYPE = "publish";

//# sourceMappingURL=PermissionsConnect-5LPHOLVR.js.map
